"use strict";(self.webpackChunkcoco_next=self.webpackChunkcoco_next||[]).push([[7495],{3668:(e,t,n)=>{e.exports=n(52342)()},5587:(e,t,n)=>{n.r(t),n.d(t,{a:()=>i,default:()=>o});const r=n(60803);function i(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=r.a(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,c=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(c)throw o}}}}const o=i},6152:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformToOp=void 0;var r=n(31635),i=n(75083),o=n(89989),a=(0,r.__importStar)(n(31132)),c=n(53307),s=n(99186),l=n(46538),u=n(64749),p=function(){function e(e,t){var n=this;this.generate_op_callback=t,this.current_event_group="",this.cached_events=[],this.plugins=new Set,this.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.warn.apply(console,(0,r.__spreadArray)(["Warn when transform to op ","["+e+"]: "],t,!1))},this.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,(0,r.__spreadArray)(["Error when transform to op ","["+e+"]: "],t,!1))},this.event_listener=function(e){if(n.Blink.events.is_listener_enabled()){if(e.type===a.GroupEventType.GroupStart)return""!==n.current_event_group&&0!==n.cached_events.length&&(n.warn("Receiving GroupStart","Starting a new event group before existing group "+n.current_event_group+" closes. "),n.handle_event_group()),void(n.current_event_group=e._group);if(e.type===a.GroupEventType.GroupEnd)return e._group!==n.current_event_group&&0!==n.cached_events.length&&n.warn("Receiving GroupEnd","Ending group "+e._group+" while current processing group is "+n.current_event_group+". Cached events is going to be handled and both group are going to be closed. "),n.current_event_group="",void n.handle_event_group();if(e.type===a.GroupEventType.GroupCancel)return e._group!==n.current_event_group&&0!==n.cached_events.length&&(n.warn("Receiving GroupCancel","Canceling group "+e._group+" while current processing group is "+n.current_event_group+". Cached events is going to be handled and both group are going to be closed. "),n.handle_event_group()),n.current_event_group="",void(n.cached_events=[]);if(e.type===a.BlockEventType.CREATE||e.type===a.BlockEventType.MOVE||e.type===a.BlockEventType.DELETE||e.type===a.BlockEventType.CHANGE)switch(e._group){case"":var t=n.handle_single_event([e],0);if(!t)return;return void n.apply_op_to_doc(t);case n.current_event_group:return void n.cached_events.push(e);default:n.error("Receiving Block Event","Receive event "+e+" when group "+n.current_event_group+" is not finished. This event would be ignored. ")}}},this.get_current_ws_json=function(){return n.cached_json?n.cached_json:e()}}return e.prototype.apply_op_to_doc=function(e){try{try{this.plugins.forEach(function(t){t.before_apply_op_to_doc(e)})}catch(e){throw this.error("Before apply op to doc",e),Error("Should reverse")}try{this.generate_op_callback.call(this,[e])}catch(e){throw this.error("Applying op to doc",e),Error("Should reverse")}try{this.plugins.forEach(function(t){t.after_apply_op_to_doc(e)})}catch(e){this.error("After apply op to doc",e)}}catch(e){this.refresh()}},e.prototype.refresh=function(){var e=this.Blink.mainWorkspace;if(e)try{this.Blink.events.disable(),e.clear(),this.reset();var t=this.get_current_ws_json();this.Blink.json.json_to_workspace(t,e)}catch(e){this.error("Refreshing workspace",e)}finally{this.Blink.events.enable()}},e.prototype.handle_single_event=function(e,t){var n=e[t];try{this.plugins.forEach(function(e){e.before_handle_single_event(n)})}catch(n){return this.error("Before handle single event",n),null}switch(n.type){case a.BlockEventType.CREATE:return this.generate_create_op(n.get_element_json());case a.BlockEventType.DELETE:return this.generate_delete_op(n.ids);case a.BlockEventType.MOVE:return this.generate_move_event_op(e,t);case a.BlockEventType.CHANGE:return this.generate_change_event_op(n);default:return null}},e.prototype.handle_event_group=function(){var e=this;try{this.plugins.forEach(function(t){t.before_handle_event_group(e.cached_events)})}catch(e){return void this.error("Before handle event group",e)}var t=this.Blink.events.filter(this.cached_events,!0),n=(0,u.filter_events)(t);if(this.cached_events=[],n&&0!==n.length){this.cached_json&&(this.error("Handle event group","Handling multi event groups at a time. "),this.cached_json=void 0),this.cached_json=this.get_current_ws_json();var r=null;try{for(var i=0;i<n.length;i++){var a=this.handle_single_event(n,i);this.cached_json=o.type.apply(this.cached_json,a),r=o.type.compose(r,a)}}catch(e){this.error("Generating group op",e),this.refresh()}this.cached_json=void 0,this.apply_op_to_doc(r)}},e.prototype.start=function(){this.Blink.mainWorkspace.remove_change_listener(this.event_listener),this.Blink.mainWorkspace.add_change_listener(this.event_listener,!1)},e.prototype.stop=function(){this.Blink.mainWorkspace.remove_change_listener(this.event_listener)},e.prototype.reset=function(){this.current_event_group="",this.cached_events=[],this.cached_json=void 0},e.prototype.register_plugins=function(e){var t=this;e.forEach(function(e){return t.plugins.add(e)})},e.prototype.generate_create_op=function(e){var t=null;try{Object.keys(e.blocks).forEach(function(n){var r=e.blocks[n],a=["blocks",r.id];t=o.type.compose(t,(0,i.insertOp)(a,r))}),Object.keys(e.connections).forEach(function(n){var r=e.connections[n],a=["connections",n];for(var c in t=o.type.compose(t,(0,i.insertOp)(a,{})),r){var s=["connections",n,c];t=o.type.compose(t,(0,i.insertOp)(s,r[c]))}}),Object.keys(e.comments).forEach(function(n){var r=e.comments[n],a=["comments",r.id];t=o.type.compose(t,(0,i.insertOp)(a,r))})}catch(t){this.error("Generating Create Op",e,t)}return t},e.prototype.generate_delete_op=function(e,t){var n=this;try{var r=t||this.get_current_ws_json(),i=[];return e.forEach(function(e){r.comments[e]?n.delete_comment(e,i):n.delete_block(r,e,i)}),i.reduce(o.type.compose,null)}catch(e){return this.error("Generating Delete Op",e),null}},e.prototype.delete_comment=function(e,t){var n=["comments",e];t.push((0,i.removeOp)(n))},e.prototype.delete_block=function(e,t,n){var r=["connections",t];n.push((0,i.removeOp)(r));var o=["blocks",t];n.push((0,i.removeOp)(o));var a=e.blocks[t];if(!a)throw Error("Cannot find block "+t+" in json.");a.comment&&this.delete_comment(a.comment,n)},e.prototype.generate_move_event_op=function(e,t){try{var n=e[t],r=n.get_block_id(),i=n.get_old_loc(),c=n.get_new_loc();if(this.get_current_ws_json().comments[r])return this.generate_move_op("comments",r,i.coordinate,c.coordinate);var s=[];if(i.parent_id){var l=!0;if(i.input_name)for(var u=t+1;u<e.length;u++){if((p=e[u]).type===a.BlockEventType.MOVE&&p.get_new_loc().parent_id===i.parent_id&&p.get_new_loc().input_name===i.input_name){l=!1;break}if(p.type===a.BlockEventType.CHANGE&&"mutation"===p.element&&p.get_block_id()===i.parent_id){l=!1;break}}s.push(this.generate_disconnect_op(r,i.parent_id,l?i.input_name:void 0))}if(c.coordinate&&s.push(this.generate_move_op("blocks",r,i.coordinate,c.coordinate)),c.parent_id){if(l=!0,c.input_name)for(u=t-1;u>=0;u--){var p;if((p=e[u]).type===a.BlockEventType.MOVE){var d=p.get_old_loc();if(d.parent_id===c.parent_id&&d.input_name===c.input_name){l=!1;break}}}s.push(this.generate_connect_op(r,c.parent_id,c.input_name,void 0,l))}return s.reduce(o.type.compose,null)}catch(p){return this.error("Generating Move Event Op",e[t],p),null}},e.prototype.generate_move_op=function(e,t,n,r){try{if(!r)throw Error("Invalid move data on element "+t);var o=!0;n&&"boolean"!=typeof n&&(o=[n[0],n[1]]);var a=[r[0],r[1]],c=[e,t,"location"];return(0,i.replaceOp)(c,o,a)}catch(e){return this.error("Generating Move Op",e),null}},e.prototype.generate_disconnect_op=function(e,t,n,r){try{var a=[],c=["blocks",e,"parent_id"];a.push((0,i.replaceOp)(c,t,null));var s=(r||this.get_current_ws_json()).connections[t],l=s[e];if(!l)throw Error("Cannot find old connection between block "+t+" and "+e);return Object.keys(s).forEach(function(e){var n=s[e];("next"===n.type&&"next"===l.type||"input"===n.type&&"input"===l.type&&l.input_name===n.input_name)&&a.push((0,i.removeOp)(["connections",t,e]))}),n&&a.push.apply(a,this.respawn_shadow(t,n,r)),a.reduce(o.type.compose,null)}catch(e){return this.error("Generating Disconnect Op",e),null}},e.prototype.generate_connect_op=function(e,t,n,r,a){void 0===a&&(a=!0);try{var c=[],s=["blocks",e,"parent_id"];if(c.push((0,i.replaceOp)(s,!0,t)),!n){var l=["connections",t,e],u={type:"next"};return c.push((0,i.insertOp)(l,u)),c.reduce(o.type.compose,null)}var p=(r||this.get_current_ws_json()).blocks[t];if(p){var d=p.shadows[n]?"value":"statement";l=["connections",t,e],u={type:"input",input_type:d,input_name:n},c.push((0,i.insertOp)(l,u)),a&&"value"===d&&c.push.apply(c,this.delete_shadow(t,n,r))}else l=["connections",t,e],u={type:"input",input_type:"statement",input_name:n},c.push((0,i.insertOp)(l,u));return c.reduce(o.type.compose,null)}catch(e){return this.error("Generating Connect Op",e),null}},e.prototype.generate_change_event_op=function(e,t){if(e.type!==a.BlockEventType.CHANGE)return null;var n=e.element;try{switch(n){case"comment":var r=e.get_new_comment();if(r)return this.generate_create_block_comment_op(e.get_block_id(),r);var i=e.get_old_value().getAttribute("id")||"";return this.generate_delete_block_comment_op(e.get_block_id(),i);case"mutation":case"change_procedure_param":var o=e.get_new_json();if(!o)throw Error("Invalid mutate event. ");return this.generate_mutate_op(e.get_block_id(),o,t);case"field":case"procedure_rename":var c=e.get_name(),s=e.get_new_value();if("string"!=typeof c||"string"!=typeof s)throw Error("invalid edit field event.");return this.generate_edit_field_op(e.get_block_id(),c,s,t);case"comment_text":var u=e.get_old_value(),p=e.get_new_value();if("string"!=typeof u||"string"!=typeof p)throw Error("Invalid edit comment event");return this.generate_edit_comment_op(e.get_block_id(),u,p);case"collapsed":var d=e.get_new_value();if("boolean"!=typeof d)throw Error("Invalid collapse block event");return this.generate_collapse_block_op(e.get_block_id(),d);case"comment_expand":var f=e.get_new_value();if("boolean"!=typeof f)throw Error("Invalid expand comment event");return this.generate_comment_expand_op(e.get_block_id(),f);case"comment_color":var h=e.get_old_value(),_=e.get_new_value();if("string"!=typeof h||"string"!=typeof _)throw Error("Invalid change comment color event");return this.generate_change_comment_color_op(e.get_block_id(),h,_);case"comment_resize":var v=e.get_old_value(),y=e.get_new_value();if("string"!=typeof v||"string"!=typeof y)throw Error("Invalid resize comment event");return this.generate_comment_resize_op(e.get_block_id(),v,y);case"disabled":var g=e.get_new_value();if("boolean"!=typeof g)throw Error("invalid disabled event");return this.generate_disabled_op(e.get_block_id(),g);case"field_default_value":var b=e.get_name(),m=e.get_new_value();if("string"!=typeof b||"boolean"!=typeof m)throw Error("invalid field default value event. ");return this.generate_field_extra_attr_op(e.get_block_id(),b,"has_been_edited",m);case"visibility":var E=e.get_new_value(),k=e.get_old_value();if("string"!=typeof k||"string"!=typeof E)throw Error("invalid visibility event. ");var O=(0,l.parse_visibility)(E),C=(0,l.parse_visibility)(k);if(!O||!C)throw Error("invalid visibility event. ");return this.generate_visibility_op(e.get_block_id(),C,O);default:throw Error("unimplemented event type "+n)}}catch(e){return this.error("Generating Change Op",e),null}},e.prototype.generate_create_block_comment_op=function(e,t){var n=t.id,r=[],a=["comments",n],c=(0,i.insertOp)(a,t);r.push(c);var s=["blocks",e,"comment"],l=(0,i.replaceOp)(s,null,n);return r.push(l),r.reduce(o.type.compose,null)},e.prototype.generate_delete_block_comment_op=function(e,t){var n=[],r=["blocks",e,"comment"];n.push((0,i.replaceOp)(r,t,null));var a=["comments",t];return n.push((0,i.removeOp)(a)),n.reduce(o.type.compose,null)},e.prototype.generate_mutate_op=function(e,t,n){var r=n||this.get_current_ws_json(),a=this.Blink.json.get_block_data_by_id(r,e),c=t,s=[],l={};if(a){var u=a.blocks[e].parent_id;if(u){var p=["connections",u,e],d=(0,i.removeOp)(p);s.push(d),l[u]=l[u]||{},l[u][e]=r.connections[u][e]}Object.keys(a.blocks).forEach(function(e){var t=["connections",e];s.push((0,i.removeOp)(t));var n=["blocks",e];s.push((0,i.removeOp)(n))}),Object.keys(a.comments).forEach(function(e){var t=["comments",e];s.push((0,i.removeOp)(t))})}return Object.keys(c.blocks).forEach(function(e){var t=c.blocks[e],n=["blocks",t.id];s.push((0,i.insertOp)(n,t))}),Object.keys(c.connections).forEach(function(e){var t=c.connections[e],n=["connections",e];for(var r in s.push((0,i.insertOp)(n,{})),t){var o=["connections",e,r];s.push((0,i.insertOp)(o,t[r]))}}),Object.keys(c.comments).forEach(function(e){var t=c.comments[e],n=["comments",t.id];s.push((0,i.insertOp)(n,t))}),Object.keys(l).forEach(function(e){Object.keys(l[e]).forEach(function(t){s.push((0,i.insertOp)(["connections",e,t],l[e][t]))})}),s.reduce(o.type.compose,null)},e.prototype.generate_edit_field_op=function(e,t,n,r){var a,c=null===(a=this.Blink.mainWorkspace.get_block_by_id(e))||void 0===a?void 0:a.get_field(t);if(!c)return null;var l=t;"NUM"===t&&c.allow_text&&!(0,s.is_valid_number)(n)&&(l="TEXT");var u=(r||this.get_current_ws_json()).blocks[e].fields,p=["blocks",e,"fields",l];if(void 0!==u[l])return(0,i.replaceOp)(p,!0,n);var d={TEXT:"NUM",NUM:"TEXT"}[l];if(d&&void 0!==u[d]){var f=["blocks",e,"fields",d];return[(0,i.removeOp)(f),(0,i.insertOp)(p,n)].reduce(o.type.compose,null)}return(0,i.insertOp)(p,n)},e.prototype.generate_comment_expand_op=function(e,t){var n=["comments",e,"pinned"];return(0,i.replaceOp)(n,!t,t)},e.prototype.generate_change_comment_color_op=function(e,t,n){var r=["comments",e,"color_theme"];return(0,i.replaceOp)(r,t,n)},e.prototype.generate_comment_resize_op=function(e,t,n){var r=["comments",e,"size"];return(0,i.replaceOp)(r,t,n)},e.prototype.generate_collapse_block_op=function(e,t){var n=["blocks",e,"collapsed"];return(0,i.replaceOp)(n,!t,t)},e.prototype.generate_edit_comment_op=function(e,t,n){var r=["comments",e,"text"];return(0,i.replaceOp)(r,t,n)},e.prototype.generate_disabled_op=function(e,t){var n=["blocks",e,"disabled"];return(0,i.replaceOp)(n,!t,t)},e.prototype.generate_field_extra_attr_op=function(e,t,n,r){var o=["blocks",e,"field_extra_attr",t,n];return(0,i.replaceOp)(o,null,r)},e.prototype.generate_visibility_op=function(e,t,n){var r=["blocks",e,"visible"];return(0,i.replaceOp)(r,t,n)},e.prototype.respawn_shadow=function(e,t,n){var r=[],o=(n||this.get_current_ws_json()).blocks[e];if(!o)throw Error("Cannot find block "+e+" in json.");var a=o.shadows[t];if(!a)return[];var c=this.Blink.utils.string_to_dom(a),s=c.getAttribute("id")||"",l=this.Blink.json.block_dom_to_json(c).blocks[s];l.parent_id=e;var u=["blocks",s];r.push((0,i.insertOp)(u,l));var p=["connections",s];r.push((0,i.insertOp)(p,{}));var d=["connections",e,s],f={type:"input",input_type:"value",input_name:t},h=(0,i.insertOp)(d,f);return r.push(h),r},e.prototype.delete_shadow=function(e,t,n){var r=[],o=n||this.get_current_ws_json(),a=this.Blink.json.get_block_data_by_id(o,e);if(!a)return[];for(var c=a.connections[e],s=Object.keys(c),l=function(n){var l=c[s[n]];if("input"===l.type&&l.input_name===t){var p=s[n],d=o.blocks[p];if(!d)throw Error("Cannot find block "+p+" in json.");if(!d.is_shadow)return{value:[]};var f=["blocks",p];r.push((0,i.removeOp)(f));var h=["connections",p];r.push((0,i.removeOp)(h));var _=["connections",e,p];r.push((0,i.removeOp)(_));var v=void 0,y={};Object.keys(d.fields).forEach(function(e){v=d.fields[e],d.field_extra_attr[e]&&(y=d.field_extra_attr[e])});var g=a.blocks[e].shadows[t],b=u.Blink.utils.string_to_dom(g);b.setAttribute("id",p);var m=b.childNodes[0];void 0!==v&&"field"===m.nodeName&&(m.textContent=v),Object.keys(y).forEach(function(e){var t=y[e];m.setAttribute(e,JSON.stringify(t))});var E=u.Blink.xml.dom_to_text(b);if(E!==g){var k=["blocks",e,"shadows",t];r.push((0,i.replaceOp)(k,g,E))}return"break"}},u=this,p=0;p<s.length;p++){var d=l(p);if("object"==typeof d)return d.value;if("break"===d)break}return r},(0,r.__decorate)([(0,c.lazy_inject)(c.BINDING.Blink)],e.prototype,"Blink",void 0),e}();t.TransformToOp=p},6474:(e,t,n)=>{n.r(t),n.d(t,{blinkOTAdapter:()=>v,clientOp:()=>r,procedurePlugin:()=>y,serverOp:()=>i});var r={};Object.defineProperty(r,"getCurrentScreenWorkspaceData",{get:function(){return u}}),Object.defineProperty(r,"applyIdeToOp",{get:function(){return p}}),Object.defineProperty(r,"addWorkspace",{get:function(){return d}});var i={};Object.defineProperty(i,"applyServerOp",{get:function(){return _}});const o=n(39726),a=n(29710),c=n(75083),s=n(86119),l=n(32023);function u(){var e=l.a(),t=s.a.getDoc();if(e){var n=null==t?void 0:t.blockly[e].workspaceJson;if(n)return n}return{blocks:{},connections:{},comments:{}}}function p(e){var t=l.a();t&&e.forEach(function(e){null!=e&&e.unshift("workspaceJson"),null!=e&&e.unshift(t),null!=e&&e.unshift("blockly"),s.a.applyClient(e)})}function d(e,t){if(t){var n=c.insertOp(["blockly",e],t);s.a.applyClient(n)}}const f=n(93833),h=n(92004);function _(e){var t=s.a.getDoc(),n=l.a();if(e&&t)if(3===e.length&&"blockly"===e[0])h.g(e[2])||h.e(e[2])&&function(e){f.z.addWorkspaceData(e[2].i)}(e);else{var r,i=e[1];if(i===n)try{v.decompose_and_transform_op(e)}catch(e){window.confirm("协作异常，请刷新页面？")}var o=null===(r=f.z.getWorkspaceDataByScreenId(i))||void 0===r?void 0:r.getProcedureManager(),a=t.blockly[i];o&&a.workspaceJson&&(y.analyze_op_and_update(e,a.workspaceJson,o),f.z.setWorkspaceDataByScreenId(i,a),f.z.refreshProcedureToolbox())}}var v=new o.OTAdapter(u,p),y=new a.ProcedurePlugin;v.register_plugins([y])},8406:(e,t)=>{t.j=void 0;var n=function(){function e(){}return e.prototype.before_handle_event_group=function(e){},e.prototype.before_handle_single_event=function(e){},e.prototype.before_apply_op_to_doc=function(e){return e},e.prototype.after_apply_op_to_doc=function(e){return e},e.prototype.before_decompose_and_sort_op=function(e){return e},e.prototype.before_analyze_op=function(e){return e},e.prototype.after_analyze_op=function(e){return!0},e.prototype.before_generate_event=function(e){return e},e.prototype.after_transform_op_to_event=function(e){},e}();t.j=n},10178:(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictResolver=void 0;var i,o=n(31635),a=n(3672),c=n(86865),s=(0,o.__importStar)(n(31132)),l=n(24042),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.after_analyze_op=function(e){var t=this.detect_conflict(e);return!(t&&(t.type===r.Gesture?(this.interrupt_gesture(t.target),0):t.type===r.EditComment?(this.interrupt_edit_comment(t.target),0):t.type===r.EditField?(this.interrupt_edit_field(t.target),0):t.type===r.UI&&(this.interrupt_ui(t.target),0)))},t.prototype.get_server_affected_id_list=function(e){var t=this,n=new Set;return e.forEach(function(e){t.Blink.mainWorkspace.for_each_element_in_stack(e,function(e){return n.add(e.id)})}),n},t.prototype.analyze_local_operation=function(e){var t,n=new Set,i=this.Blink.mainWorkspace.current_gesture_,o=null==i?void 0:i.target_block;if(i&&o){this.Blink.mainWorkspace.for_each_element_in_stack(o.id,function(e){return n.add(e.id)});var a=i.block_dragger;void 0!==(null==a?void 0:a.parent_before_drag)&&this.Blink.mainWorkspace.for_each_element_in_stack(a.parent_before_drag.id,function(e){return n.add(e.id)});for(var c=Array.from(e),s=0;s<c.length;s++)if(n.has(c[s]))return{type:r.Gesture,target:i}}var u=this.Blink.runtime_data.selected;if(u&&e.has(u.id)){if(this.Blink.context_menu.current_block===u)return{type:r.UI,target:u};if((0,l.is_workspace_comment)(u)&&(u.is_textarea_focused||u.size_before_resize))return{type:r.EditComment,target:u};if((0,l.is_block_svg)(u)){var p=this.Blink.runtime_data.editing;if(!p)return;if(p.source_block===u||(null===(t=p.source_block)||void 0===t?void 0:t.parent_block)===u)return{type:r.EditField,target:p}}}},t.prototype.detect_conflict=function(e){var t=this.get_server_affected_id_list(e);if(t)return this.analyze_local_operation(t)},t.prototype.interrupt_edit_field=function(e){var t;if(this.Blink.events.disable(),this.Blink.runtime_data.editing===e){var n=e.value_before_editing;void 0!==n&&(e.set_value(n),e.set_html_input_value(n)),null!==(t=e.source_block)&&void 0!==t&&t.unselect(),e.focus(!1)}this.Blink.widget_div.owner_&&this.Blink.widget_div.hide(),this.Blink.events.enable()},t.prototype.interrupt_edit_comment=function(e){e.cancel_operation()},t.prototype.interrupt_ui=function(e){this.Blink.events.disable(),this.Blink.context_menu.hide(),e.unselect(),this.Blink.events.enable()},t.prototype.interrupt_gesture=function(e){var t,n,r=this.Blink.events.get_group();this.Blink.events.fire(this.group_event_factory({type:s.GroupEventType.GroupCancel,group:r}));try{this.Blink.events.disable_listener();var i=null===(t=e.block_dragger)||void 0===t?void 0:t.redo_stack_before_drag.slice(),o=null===(n=e.block_dragger)||void 0===n?void 0:n.undo_stack_before_drag.slice();if(void 0===i||void 0===o)return void console.error("Confilct resolver: cannot get redo stack before drag.");e.cancel(),o.length!==this.Blink.mainWorkspace.get_undo_stack().length&&(this.Blink.mainWorkspace.undo(),this.Blink.mainWorkspace.set_redo_stack(i))}catch(e){console.error("Occurs error when interruput gesture: ",e)}finally{this.Blink.events.enable_listener()}},(0,o.__decorate)([(0,a.lazy_inject)(c.BINDING.Blink)],t.prototype,"Blink",void 0),(0,o.__decorate)([(0,a.lazy_inject)(c.BINDING.GroupEvent)],t.prototype,"group_event_factory",void 0),t}(n(8406).j);t.ConflictResolver=u,(i=r||(r={})).Gesture="Gesture",i.EditField="EditField",i.EditComment="EditComment",i.UI="UI"},22176:(e,t)=>{var n,r,i,o,a,c,s;Object.defineProperty(t,"__esModule",{value:!0}),t.EventType=t.is_drop_op=t.is_pick_op=t.is_drop_operation=t.is_pick_operation=t.is_path_5=t.is_path_4=t.is_path_3=t.is_path_2=t.is_path_5_array=t.is_path_4_array=t.is_path_3_array=t.is_path_2_array=t.PathParams5=t.PathParams4=t.PathParams3=t.PathParams2=t.Field_Type=t.Target_Type=void 0,(s=n=t.Target_Type||(t.Target_Type={}))[s.blocks=0]="blocks",s[s.connections=1]="connections",s[s.comments=2]="comments",function(e){e[e.shadows=0]="shadows",e[e.fields=1]="fields"}(r=t.Field_Type||(t.Field_Type={})),function(e){e[e.TARGET=0]="TARGET",e[e.ID=1]="ID"}(i=t.PathParams2||(t.PathParams2={})),function(e){e[e.TARGET=0]="TARGET",e[e.ID=1]="ID",e[e.PROPERTY=2]="PROPERTY"}(o=t.PathParams3||(t.PathParams3={})),function(e){e[e.BLOCK=0]="BLOCK",e[e.ID=1]="ID",e[e.PROPERTY=2]="PROPERTY",e[e.PROPERTY_NAME=3]="PROPERTY_NAME"}(a=t.PathParams4||(t.PathParams4={})),function(e){e[e.BLOCK=0]="BLOCK",e[e.ID=1]="ID",e[e.PROPERTY=2]="PROPERTY",e[e.PROPERTY_NAME=3]="PROPERTY_NAME",e[e.FIELD_ATTR=4]="FIELD_ATTR"}(c=t.PathParams5||(t.PathParams5={})),t.is_path_2_array=function(e){return 2===e.length&&e[i.TARGET]in n&&"string"==typeof e[i.ID]},t.is_path_3_array=function(e){return 3===e.length&&e[o.TARGET]in n&&"string"==typeof e[o.ID]&&"string"==typeof e[o.PROPERTY]},t.is_path_4_array=function(e){return 4===e.length&&"blocks"===e[a.BLOCK]&&"string"==typeof e[a.ID]&&e[a.PROPERTY]in r&&"string"==typeof e[a.PROPERTY_NAME]},t.is_path_5_array=function(e){return 5===e.length&&"blocks"===e[c.BLOCK]&&"string"==typeof e[c.ID]&&"field_extra_attr"===e[c.PROPERTY]&&"string"==typeof e[c.PROPERTY_NAME]&&"string"==typeof e[c.FIELD_ATTR]},t.is_path_2=function(e){return!e.hasOwnProperty("property")},t.is_path_3=function(e){return e.hasOwnProperty("property")&&!e.hasOwnProperty("property_name")},t.is_path_4=function(e){return e.hasOwnProperty("property_name")},t.is_path_5=function(e){return e.hasOwnProperty("field_attr")},t.is_pick_operation=function(e){return void 0!==e.p||void 0!==e.r},t.is_drop_operation=function(e){return void 0!==e.i||void 0!==e.d},t.is_pick_op=function(e){return void 0!==e.operation.p||void 0!==e.operation.r},t.is_drop_op=function(e){return void 0!==e.operation.i||void 0!==e.operation.d},function(e){e.CONNECT="connect",e.DISCONNECT="disconnect",e.CREATE_BLOCK="create_block",e.DELETE_BLOCK="delete_block",e.MOVE_BLOCK="move_block",e.COLLAPSE_BLOCK="collapse_block",e.DISABLE_BLOCK="disable_block",e.EDIT_BLOCK_FIELD="edit_block_field",e.EDIT_FIELD_EXTRA_ATTR="edit_field_extra_attr",e.SET_BLOCK_VISIBILITY="set_block_visibility",e.APPEND_SHADOW_INPUT="append_shadow_input",e.REMOVE_SHADOW_INPUT="remove_shadow_input",e.CREATE_COMMENT="create_comment",e.DELETE_COMMENT="delete_comment",e.MOVE_COMMENT="move_comment",e.COLLAPSE_COMMENT="collapse_comment",e.EDIT_COMMENT="edit_comment",e.CHANGE_COMMENT_COLOR="change_comment_color",e.RESIZE_COMMENT="resize_comment"}(t.EventType||(t.EventType={}))},27759:(e,t,n)=>{n.r(t),n.d(t,{a:()=>h,default:()=>g});const r=n(7452);var i,o,a=(o=(i=r)&&i.__esModule?function(){return i.default}:function(){return i},Object.defineProperty(o,"a",{enumerable:!0,get:o}),o);const c=n(21009),s=n(43470),l=n(3741),u=n(83315);var p="".concat(u.a.serverHost,"/coconut"),d=!1,f=0;function h(e){return _.apply(this,arguments)}function _(){return(_=c.a(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=3;break}return e.next=3,v();case 3:return n=Math.round(Date.now()/1e3)+f,r=s.sha256("".concat("pBlYqXbJDu").concat(n).concat(t)).toLocaleUpperCase(),e.abrupt("return",{sign:r,timestamp:n});case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(){return y.apply(this,arguments)}function y(){return(y=c.a(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.get("".concat(p,"/clouddb/currentTime"));case 2:if(t=e.sent,200===(n=t.data).code)try{r=Math.round(Date.now()/1e3),f=n.data-r,d=!0}catch(e){}case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}const g=h},28245:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictType=void 0,(n=t.ConflictType||(t.ConflictType={}))[n.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",n[n.DROP_COLLISION=2]="DROP_COLLISION",n[n.BLACKHOLE=3]="BLACKHOLE"},29710:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProcedurePlugin=void 0;var r=n(31635),i=(0,r.__importStar)(n(31132)),o=n(88772),a=n(3672),c=n(86865),s=n(18978),l=(0,r.__importStar)(n(64749)),u=(0,r.__importStar)(n(22176)),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.before_handle_event_group=function(e){for(var t=new Map,n=0;n<e.length;){var r=e[n];if(void 0!==r)if(r.type!==i.BlockEventType.CREATE){if(r.type===i.BlockEventType.CHANGE){if("procedure_rename"!==r.element&&"field"!==r.element){n++;continue}l=r.get_block_id();var a=t.get(l);if(void 0!==a){var c=r.get_new_value(),s=e[a].get_element_json();"string"==typeof c&&(s.blocks[l].fields[o.PROCEDURE_BLOCK_FIELD_NAMES.PROCEDURE_NAME]=c),e.splice(n,1);continue}}n++}else{var l=r.get_block_id(),u=r.get_element_json();if(u.blocks[l]){var p=u.blocks[l].type;p!==o.PROCEDURE_BLOCK_TYPES.DEF&&p!==o.PROCEDURE_BLOCK_TYPES.CALL_RETURN&&p!==o.PROCEDURE_BLOCK_TYPES.CALL_NORETURN||t.set(r.get_block_id(),n)}n++}}},t.prototype.analyze_op_and_update=function(e,t,n){var r=this;this.procedure_manager=n,this.ws_json=t;var i=l.decompose_and_sort_op(e);if(i){var o=new Map,a=new Map,c=new Map,s=[],p=[],d=new Map;i.pick_ops.forEach(function(e){var t=l.analyze_path("pick",e.path);if(void 0!==t){var n=t.event_type,r=t.normalized_path;switch(n){case u.EventType.DISCONNECT:s.push(r);break;case u.EventType.DELETE_BLOCK:var i=o.get(r.target_id);void 0===i?o.set(r.target_id,-1):o.set(r.target_id,i-1),a.set(r.target_id,r);break;default:return}}}),i.drop_ops.forEach(function(e){var t=l.analyze_path("drop",e.path);if(void 0!==t){var n=t.event_type,r=t.normalized_path;switch(n){case u.EventType.CREATE_BLOCK:var i=o.get(r.target_id);void 0===i?o.set(r.target_id,1):o.set(r.target_id,i+1),c.set(r.target_id,r);break;case u.EventType.CONNECT:p.push(r);break;case u.EventType.EDIT_BLOCK_FIELD:var a=e.operation.i;if("string"!=typeof a)break;d.set(r,a);break;default:return}}}),o.forEach(function(e,t){switch(e){case 1:var n=c.get(t);n&&r.handle_create(n);break;case-1:var i=a.get(t);i&&r.handle_delete(i);break;case 0:var o=c.get(t);o&&r.handle_mutate(o)}}),d.forEach(function(e,t){r.handle_rename(t,e)}),s.forEach(function(e){r.handle_disconnect(e)}),p.forEach(function(e){r.handle_connect(e)})}},t.prototype.handle_create=function(e){var t=e.target_id,n=this.ws_json.blocks[t];if(n.type===o.PROCEDURE_BLOCK_TYPES.DEF){var r=n.fields[o.PROCEDURE_BLOCK_FIELD_NAMES.PROCEDURE_NAME];(0,s.assert)(r);var i=this.procedure_manager.get_procedure_by_def(t);i?(i.name!==r&&this.procedure_manager.rename_procedure(i.name,r),i.disabled=!1,i.valid=!0,i.base_name=i.name):i=this.procedure_manager.add_procedure_def(r,n.id),this.reload_params(i,t)}if(n.type===o.PROCEDURE_BLOCK_TYPES.CALL_RETURN||n.type===o.PROCEDURE_BLOCK_TYPES.CALL_NORETURN){var a=n.fields[o.PROCEDURE_BLOCK_FIELD_NAMES.PROCEDURE_NAME];(0,s.assert)(a),this.procedure_manager.add_caller(a,n.id,n.type===o.PROCEDURE_BLOCK_TYPES.CALL_RETURN?"call_return":"call")}},t.prototype.handle_delete=function(e){var t=e.target_id;this.procedure_manager.get_procedure_by_def(t)?this.procedure_manager.delete_procedure_def(t):this.procedure_manager.get_procedure_by_caller_id(t)&&this.procedure_manager.delete_caller(t)},t.prototype.handle_connect=function(e){if(u.is_path_3(e)){for(var t=e.target_id,n=this.ws_json.blocks[t];n.parent_id;)n=this.ws_json.blocks[n.parent_id];n.type===o.PROCEDURE_BLOCK_TYPES.DEF&&this.reload_return_count(n.id)}},t.prototype.handle_disconnect=function(e){if(u.is_path_3(e)){var t=e.property,n=e.target_id,r=this.json.get_block_data_by_id(this.ws_json,t);if(r){var i=Object.keys(r.blocks).filter(function(e){return r.blocks[e].type===o.PROCEDURE_BLOCK_TYPES.RETURN&&void 0!==r.blocks[e].shadows.VALUE}).length;if(!(i<1)){for(var a=this.ws_json.blocks[n];a.parent_id;)a=this.ws_json.blocks[a.parent_id];if(a.type===o.PROCEDURE_BLOCK_TYPES.DEF){var c=this.procedure_manager.get_procedure_by_def(a.id);(0,s.assert)(c),this.procedure_manager.change_return_count(c.name,-1*i)}}}}},t.prototype.handle_mutate=function(e){var t=e.target_id;if(this.ws_json.blocks[t].type===o.PROCEDURE_BLOCK_TYPES.DEF){var n=this.procedure_manager.get_procedure_by_def(t);(0,s.assert)(n),this.reload_params(n,t)}},t.prototype.handle_rename=function(e,t){var n=e.target_id;if(this.ws_json.blocks[n].type===o.PROCEDURE_BLOCK_TYPES.DEF){var r=this.procedure_manager.get_procedure_by_def(n);(0,s.assert)(r),r.name!==t&&this.procedure_manager.rename_procedure(r.name,t)}},t.prototype.reload_params=function(e,t){var n=this,r=this.ws_json.connections[t],i=Object.keys(r),a=[];i.forEach(function(e){var t=r[e];if("input"===t.type&&t.input_name.startsWith(o.PROCEDURE_BLOCK_INPUT_NAMES.PARAM_PREFIX)){var i=n.ws_json.blocks[e],c=i.fields[o.PROCEDURE_BLOCK_FIELD_NAMES.PARAM_NAME],s=i.fields[o.PROCEDURE_BLOCK_FIELD_NAMES.PARAM_DEFAULT_VALUE].slice(1);a.push({param_name:c,default_value:s||void 0})}}),e.params=a},t.prototype.reload_return_count=function(e){var t=this.json.get_block_data_by_id(this.ws_json,e);if(t){var n=Object.keys(t.blocks).filter(function(e){return t.blocks[e].type===o.PROCEDURE_BLOCK_TYPES.RETURN&&void 0!==t.blocks[e].shadows.VALUE}).length,r=this.procedure_manager.get_procedure_by_def(e);(0,s.assert)(r),r.return_count=n}},(0,r.__decorate)([(0,a.lazy_inject)(c.BINDING.json)],t.prototype,"json",void 0),t}(n(8406).j);t.ProcedurePlugin=p},32414:(e,t,n)=>{var r=n(79511),i=n(72824),o=n(35612),a=n(79231),c=n(7452),s=n(93992),l=n(58848),u=n(80875),p=n(86082);function d(e,t){if(!e)throw new Error(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.eachChildOf=t.advancer=t.readCursor=t.writeCursor=t.WriteCursor=t.ReadCursor=t.isValidPathItem=void 0;var f=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)},h=function(e,t){return typeof e==typeof t?e>t:"string"==typeof e&&"number"==typeof t};function _(e,t){for(var n in e){var r=n;t.write(r,e[r])}}t.isValidPathItem=function(e){return"number"==typeof e||"string"==typeof e&&"__proto__"!==e};var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u(this,e),this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=t}return p(e,[{key:"ascend",value:function(){d(this.parents.length===this.indexes.length/2),0===this.idx?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(d(this.idx>0),this.idx--,f(this.container[this.idx])&&this.idx--)}},{key:"getPath",value:function(){for(var e=[],t=this.container,n=this.parents.length-1,r=this.idx;r>=0;)e.unshift(t[r]),0===r?(r=this.indexes[2*n],t=this.parents[n--]):r-=f(t[r-1])?2:1;return e}}]),e}(),y=function(e){s(n,e);var t=l(n);function n(){return u(this,n),t.apply(this,arguments)}return p(n,[{key:"get",value:function(){return this.container?this.container.slice(this.idx+1):null}},{key:"getKey",value:function(){return d(null!=this.container,"Invalid call to getKey before cursor descended"),this.container[this.idx]}},{key:"getComponent",value:function(){var e;return this.container&&this.container.length>this.idx+1&&f(e=this.container[this.idx+1])?e:null}},{key:"descendFirst",value:function(){var e=this.idx+1;if(!this.container||e>=this.container.length||f(this.container[e])&&e+1>=this.container.length)return!1;f(this.container[e])&&e++;var t=this.container[e];return Array.isArray(t)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(e),this.idx=0,this.container=t):this.idx=e,!0}},{key:"nextSibling",value:function(){if(d(this.parents.length===this.indexes.length/2),this.idx>0||0===this.parents.length)return!1;var e=this.indexes[this.indexes.length-1]+1,t=this.parents[this.parents.length-1];return!(e>=t.length||(d(!isNaN(e)),this.indexes[this.indexes.length-1]=e,this.container=t[e],0))}},{key:"_init",value:function(e,t,n,r){this.container=e,this.idx=t,this.parents=n.slice(),this.indexes=r.slice()}},{key:"clone",value:function(){var e=new n;return e._init(this.container,this.idx,this.parents,this.indexes),e}},{key:Symbol.iterator,value:c.mark(function e(){return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.descendFirst()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getKey();case 4:if(this.nextSibling()){e.next=2;break}case 5:this.ascend();case 6:case"end":return e.stop()}},e,this)})},{key:"traverse",value:function(e,t){var n,r=this.getComponent();r&&t(r,e);var i=a(this);try{for(i.s();!(n=i.n()).done;){var o=n.value;e&&e.descend(o),this.traverse(e,t),e&&e.ascend()}}catch(e){i.e(e)}finally{i.f()}}},{key:"eachPick",value:function(e,t){this.traverse(e,function(e,n){null!=e.p&&t(e.p,n)})}},{key:"eachDrop",value:function(e,t){this.traverse(e,function(e,n){null!=e.d&&t(e.d,n)})}}]),n}(v);t.ReadCursor=y;var g=function(e){s(a,e);var n=l(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return u(this,a),(e=n.call(this,t)).pendingDescent=[],e._op=t,e}return p(a,[{key:"flushDescent",value:function(){d(this.parents.length===this.indexes.length/2),null===this.container&&(this._op=this.container=[]);for(var e=0;e<this.pendingDescent.length;e++){var t=this.pendingDescent[e],n=this.idx+1;if(n<this.container.length&&f(this.container[n])&&n++,d(n===this.container.length||!f(this.container[n])),n===this.container.length)this.container.push(t),this.idx=n;else if(this.container[n]===t)this.idx=n;else{if(!Array.isArray(this.container[n])){var r=this.container.splice(n,this.container.length-n);this.container.push(r),this.lcIdx>-1&&(this.lcIdx=n)}for(this.indexes.push(this.idx),this.parents.push(this.container),-1!==this.lcIdx&&(d(h(t,this.container[this.lcIdx][0])),n=this.lcIdx+1,this.lcIdx=-1);n<this.container.length&&h(t,this.container[n][0]);)n++;if(this.indexes.push(n),this.idx=0,n<this.container.length&&this.container[n][0]===t)this.container=this.container[n];else{var i=[t];this.container.splice(n,0,i),this.container=i}}}this.pendingDescent.length=0}},{key:"reset",value:function(){this.lcIdx=-1}},{key:"getComponent",value:function(){this.flushDescent();var e=this.idx+1;if(e<this.container.length&&f(this.container[e]))return this.container[e];var t={};return this.container.splice(e,0,t),t}},{key:"write",value:function(e,t){var n=this.getComponent();d(null==n[e]||n[e]===t,"Internal consistency error: Overwritten component. File a bug"),n[e]=t}},{key:"get",value:function(){return this._op}},{key:"descend",value:function(e){if(!t.isValidPathItem(e))throw Error("Invalid JSON key");this.pendingDescent.push(e)}},{key:"descendPath",value:function(e){var t;return(t=this.pendingDescent).push.apply(t,r(e)),this}},{key:"ascend",value:function(){this.pendingDescent.length?this.pendingDescent.pop():i(o(a.prototype),"ascend",this).call(this)}},{key:"mergeTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(null!==e){if(d(Array.isArray(e)),e===this._op)throw Error("Cannot merge into my own tree");for(var n=this.lcIdx,r=this.parents.length,i=0,o=0;o<e.length;o++){var a=e[o];"string"==typeof a||"number"==typeof a?(i++,this.descend(a)):Array.isArray(a)?this.mergeTree(a,t):"object"==typeof a&&t(a,this)}for(;i--;)this.ascend();this.lcIdx=this.parents.length===r?n:-1}}},{key:"at",value:function(e,t){this.descendPath(e),t(this);for(var n=0;n<e.length;n++)this.ascend();return this}},{key:"writeAtPath",value:function(e,t,n){var r=this;return this.at(e,function(){return r.write(t,n)}),this.reset(),this}},{key:"writeMove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.writeAtPath(e,"p",n).writeAtPath(t,"d",n)}},{key:"getPath",value:function(){var e=i(o(a.prototype),"getPath",this).call(this);return e.push.apply(e,r(this.pendingDescent)),e}}]),a}(v);t.WriteCursor=g,t.writeCursor=function(){return new g},t.readCursor=function(e){return new y(e)},t.advancer=function(e,t,n){var r,i;function o(r){for(var o;i;){var a=o=e.getKey();if(null!=r){var c=!1;if(t&&"number"==typeof a&&(o=t(a,e.getComponent()))<0&&(o=~o,c=!0),h(o,r))return null;if(o===r&&!c)return e}n&&"number"==typeof o&&n(o,e.getComponent()),i=e.nextSibling()}return null}return i=r=!!e&&e.descendFirst(),o.end=function(){r&&e.ascend()},o},t.eachChildOf=function(e,t,n){var r,i,o,a;for(r=i=e&&e.descendFirst(),o=a=t&&t.descendFirst();r||o;){var c=r?e.getKey():null,s=o?t.getKey():null;null!==c&&null!==s&&(h(s,c)?s=null:c!==s&&(c=null)),n(null==c?s:c,null!=c?e:null,null!=s?t:null),null!=c&&r&&(r=e.nextSibling()),null!=s&&o&&(o=t.nextSibling())}i&&e.ascend(),a&&t.ascend()}},39726:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OTAdapter=void 0;var r=n(47971),i=n(6152),o=function(){function e(e,t){this.transform_to_op=new i.TransformToOp(e,t),this.transform_to_ide=new r.TransformToIde,this.op_generator=this.transform_to_op}return e.prototype.register_plugins=function(e){this.transform_to_op.register_plugins(e),this.transform_to_ide.register_plugins(e)},e.prototype.start=function(){this.transform_to_op.start()},e.prototype.stop=function(){this.transform_to_op.stop()},e.prototype.reset=function(){this.transform_to_op.reset()},e.prototype.decompose_and_transform_op=function(e){this.transform_to_ide.decompose_and_transform_op(e)},e.prototype.transform_drop_operation=function(e){this.transform_drop_operation(e)},e.prototype.transform_pick_operation=function(e){this.transform_pick_operation(e)},e}();t.OTAdapter=o},41383:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function c(e,t,n){return(c=a()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,i(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,e)})(e)}function l(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t),n.d(t,{a:()=>v,default:()=>y});var d=Object.prototype.hasOwnProperty;function f(e,t){return(e=e.slice()).push(t),e}function h(e,t){return(t=t.slice()).unshift(e),t}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,e);var t=function(e){var t=a();return function(){var n,r=i(e);if(t){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,n)}}(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,'JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)')).avoidNew=!0,r.value=e,r.name="NewError",r}return n}(s(Error));function v(e,t,n,i,o){if(!(this instanceof v))try{return new v(e,t,n,i,o)}catch(e){if(!e.avoidNew)throw e;return e.value}"string"==typeof e&&(o=i,i=n,n=t,t=e,e=null);var a=e&&"object"===r(e);if(e=e||{},this.json=e.json||n,this.path=e.path||t,this.resultType=e.resultType||"value",this.flatten=e.flatten||!1,this.wrap=!d.call(e,"wrap")||e.wrap,this.sandbox=e.sandbox||{},this.preventEval=e.preventEval||!1,this.parent=e.parent||null,this.parentProperty=e.parentProperty||null,this.callback=e.callback||i||null,this.otherTypeCallback=e.otherTypeCallback||o||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},!1!==e.autostart){var c={path:a?e.path:t};a?"json"in e&&(c.json=e.json):c.json=n;var s=this.evaluate(c);if(!s||"object"!==r(s))throw new _(s);return s}}v.prototype.evaluate=function(e,t,n,i){var o=this,a=this.parent,c=this.parentProperty,s=this.flatten,l=this.wrap;if(this.currResultType=this.resultType,this.currPreventEval=this.preventEval,this.currSandbox=this.sandbox,n=n||this.callback,this.currOtherTypeCallback=i||this.otherTypeCallback,t=t||this.json,(e=e||this.path)&&"object"===r(e)&&!Array.isArray(e)){if(!e.path&&""!==e.path)throw new TypeError('You must supply a "path" property when providing an object argument to JSONPath.evaluate().');if(!d.call(e,"json"))throw new TypeError('You must supply a "json" property when providing an object argument to JSONPath.evaluate().');t=e.json,s=d.call(e,"flatten")?e.flatten:s,this.currResultType=d.call(e,"resultType")?e.resultType:this.currResultType,this.currSandbox=d.call(e,"sandbox")?e.sandbox:this.currSandbox,l=d.call(e,"wrap")?e.wrap:l,this.currPreventEval=d.call(e,"preventEval")?e.preventEval:this.currPreventEval,n=d.call(e,"callback")?e.callback:n,this.currOtherTypeCallback=d.call(e,"otherTypeCallback")?e.otherTypeCallback:this.currOtherTypeCallback,a=d.call(e,"parent")?e.parent:a,c=d.call(e,"parentProperty")?e.parentProperty:c,e=e.path}if(a=a||null,c=c||null,Array.isArray(e)&&(e=v.toPathString(e)),(e||""===e)&&t){var u=v.toPathArray(e);"$"===u[0]&&u.length>1&&u.shift(),this._hasParentSelector=null;var p=this._trace(u,t,["$"],a,c,n).filter(function(e){return e&&!e.isParentSelector});return p.length?l||1!==p.length||p[0].hasArrExpr?p.reduce(function(e,t){var n=o._getPreferredOutput(t);return s&&Array.isArray(n)?e=e.concat(n):e.push(n),e},[]):this._getPreferredOutput(p[0]):l?[]:void 0}},v.prototype._getPreferredOutput=function(e){var t=this.currResultType;switch(t){case"all":var n=Array.isArray(e.path)?e.path:v.toPathArray(e.path);return e.pointer=v.toPointer(n),e.path="string"==typeof e.path?e.path:v.toPathString(e.path),e;case"value":case"parent":case"parentProperty":return e[t];case"path":return v.toPathString(e[t]);case"pointer":return v.toPointer(e.path);default:throw new TypeError("Unknown result type")}},v.prototype._handleCallback=function(e,t,n){if(t){var r=this._getPreferredOutput(e);e.path="string"==typeof e.path?e.path:v.toPathString(e.path),t(r,n,e)}},v.prototype._trace=function(e,t,n,i,o,a,c,s){var l,p=this;if(!e.length)return l={path:n,value:t,parent:i,parentProperty:o,hasArrExpr:c},this._handleCallback(l,a,"value"),l;var _=e[0],v=e.slice(1),y=[];function g(e){Array.isArray(e)?e.forEach(function(e){y.push(e)}):y.push(e)}if(("string"!=typeof _||s)&&t&&d.call(t,_))g(this._trace(v,t[_],f(n,_),t,_,a,c));else if("*"===_)this._walk(_,v,t,n,i,o,a,function(e,t,n,r,i,o,a,c){g(p._trace(h(e,n),r,i,o,a,c,!0,!0))});else if(".."===_)g(this._trace(v,t,n,i,o,a,c)),this._walk(_,v,t,n,i,o,a,function(e,t,n,i,o,a,c,s){"object"===r(i[e])&&g(p._trace(h(t,n),i[e],f(o,e),i,e,s,!0))});else{if("^"===_)return this._hasParentSelector=!0,{path:n.slice(0,-1),expr:v,isParentSelector:!0};if("~"===_)return l={path:f(n,_),value:o,parent:i,parentProperty:null},this._handleCallback(l,a,"property"),l;if("$"===_)g(this._trace(v,t,n,null,null,a,c));else if(/^(\x2D?[0-9]*):(\x2D?[0-9]*):?([0-9]*)$/.test(_))g(this._slice(_,v,t,n,i,o,a));else if(0===_.indexOf("?(")){if(this.currPreventEval)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");this._walk(_,v,t,n,i,o,a,function(e,t,n,r,i,o,a,c){p._eval(t.replace(/^\?\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)\)$/,"$1"),r[e],e,i,o,a)&&g(p._trace(h(e,n),r,i,o,a,c,!0))})}else if("("===_[0]){if(this.currPreventEval)throw new Error("Eval [(expr)] prevented in JSONPath expression.");g(this._trace(h(this._eval(_,t,n[n.length-1],n.slice(0,-1),i,o),v),t,n,i,o,a,c))}else if("@"===_[0]){var b=!1,m=_.slice(1,-2);switch(m){case"scalar":t&&["object","function"].includes(r(t))||(b=!0);break;case"boolean":case"string":case"undefined":case"function":r(t)===m&&(b=!0);break;case"integer":!Number.isFinite(t)||t%1||(b=!0);break;case"number":Number.isFinite(t)&&(b=!0);break;case"nonFinite":"number"!=typeof t||Number.isFinite(t)||(b=!0);break;case"object":t&&r(t)===m&&(b=!0);break;case"array":Array.isArray(t)&&(b=!0);break;case"other":b=this.currOtherTypeCallback(t,n,i,o);break;case"null":null===t&&(b=!0);break;default:throw new TypeError("Unknown value type "+m)}if(b)return l={path:n,value:t,parent:i,parentProperty:o},this._handleCallback(l,a,"value"),l}else if("`"===_[0]&&t&&d.call(t,_.slice(1))){var E=_.slice(1);g(this._trace(v,t[E],f(n,E),t,E,a,c,!0))}else if(_.includes(",")){var k,O=function(e){var t,n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=u(e))){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=!0,a=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){a=!0,n=e},f:function(){try{o||null==t.return||t.return()}finally{if(a)throw n}}}}(_.split(","));try{for(O.s();!(k=O.n()).done;){var C=k.value;g(this._trace(h(C,v),t,n,i,o,a,!0))}}catch(e){O.e(e)}finally{O.f()}}else!s&&t&&d.call(t,_)&&g(this._trace(v,t[_],f(n,_),t,_,a,c,!0))}if(this._hasParentSelector)for(var P=0;P<y.length;P++){var w=y[P];if(w&&w.isParentSelector){var T=this._trace(w.expr,t,w.path,i,o,a,c);if(Array.isArray(T)){y[P]=T[0];for(var A=T.length,B=1;B<A;B++)P++,y.splice(P,0,T[B])}else y[P]=T}}return y},v.prototype._walk=function(e,t,n,i,o,a,c,s){if(Array.isArray(n))for(var l=n.length,u=0;u<l;u++)s(u,e,t,n,i,o,a,c);else n&&"object"===r(n)&&Object.keys(n).forEach(function(r){s(r,e,t,n,i,o,a,c)})},v.prototype._slice=function(e,t,n,r,i,o,a){if(Array.isArray(n)){var c=n.length,s=e.split(":"),l=s[2]&&Number.parseInt(s[2])||1,u=s[0]&&Number.parseInt(s[0])||0,p=s[1]&&Number.parseInt(s[1])||c;u=u<0?Math.max(0,u+c):Math.min(c,u),p=p<0?Math.max(0,p+c):Math.min(c,p);for(var d=[],f=u;f<p;f+=l)this._trace(h(f,t),n,r,i,o,a,!0).forEach(function(e){d.push(e)});return d}},v.prototype._eval=function(e,t,n,r,i,o){e.includes("@parentProperty")&&(this.currSandbox._$_parentProperty=o,e=e.replace(/@parentProperty/g,"_$_parentProperty")),e.includes("@parent")&&(this.currSandbox._$_parent=i,e=e.replace(/@parent/g,"_$_parent")),e.includes("@property")&&(this.currSandbox._$_property=n,e=e.replace(/@property/g,"_$_property")),e.includes("@path")&&(this.currSandbox._$_path=v.toPathString(r.concat([n])),e=e.replace(/@path/g,"_$_path")),e.includes("@root")&&(this.currSandbox._$_root=this.json,e=e.replace(/@root/g,"_$_root")),/@([\t-\r \)\.\[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])/.test(e)&&(this.currSandbox._$_v=t,e=e.replace(/@([\t-\r \)\.\[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])/g,"_$_v$1"));try{return this.vm.runInNewContext(e,this.currSandbox)}catch(t){throw console.log(t),new Error("jsonPath: "+t.message+": "+e)}},v.cache={},v.toPathString=function(e){for(var t=e,n=t.length,r="$",i=1;i<n;i++)/^(~|\^|@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\(\))$/.test(t[i])||(r+=/^[\*0-9]+$/.test(t[i])?"["+t[i]+"]":"['"+t[i]+"']");return r},v.toPointer=function(e){for(var t=e,n=t.length,r="",i=1;i<n;i++)/^(~|\^|@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\(\))$/.test(t[i])||(r+="/"+t[i].toString().replace(/~/g,"~0").replace(/\//g,"~1"));return r},v.toPathArray=function(e){var t=v.cache;if(t[e])return t[e].concat();var n=[],r=e.replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\(\)/g,";$&;").replace(/['\[](\??\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\))['\]]/g,function(e,t){return"[#"+(n.push(t)-1)+"]"}).replace(/\['((?:(?!['\]])[\s\S])*)'\]/g,function(e,t){return"['"+t.replace(/\./g,"%@%").replace(/~/g,"%%@@%%")+"']"}).replace(/~/g,";~;").replace(/'?\.'?(?!(?:(?!\[)[\s\S])*\])|\['?/g,";").replace(/%@%/g,".").replace(/%%@@%%/g,"~").replace(/(?:;)?(\^+)(?:;)?/g,function(e,t){return";"+t.split("").join(";")+";"}).replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").split(";").map(function(e){var t=e.match(/#([0-9]+)/);return t&&t[1]?n[t[1]]:e});return t[e]=r,t[e].concat()},v.prototype.vm={runInNewContext:function(e,t){var n=Object.keys(t),r=[];!function(e,t,n){for(var r=e.length,i=0;i<r;i++)n(e[i])&&t.push(e.splice(i--,1)[0])}(n,r,function(e){return"function"==typeof t[e]});var i=n.map(function(e,n){return t[e]}),o=r.reduce(function(e,n){var r=t[n].toString();return/function/.test(r)||(r="function "+r),"var "+n+"="+r+";"+e},"");/(["'])use strict\1/.test(e=o+e)||n.includes("arguments")||(e="var arguments = undefined;"+e);var a=(e=e.replace(/;[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*$/,"")).lastIndexOf(";"),s=a>-1?e.slice(0,a+1)+" return "+e.slice(a+1):" return "+e;return c(Function,l(n).concat([s])).apply(void 0,l(i))}};const y=v},43470:function(module,__unused_webpack_exports,__webpack_require__){module=__webpack_require__.nmd(module),function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,AMD=__webpack_require__(69175),ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(n){return new Sha256(t,!0).update(n)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createOutputMethod(r,e)}return t},nodeWrap=function nodeWrap(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(n,r){return new HmacSha256(n,t,!0).update(r)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,n){return t.create(e).update(n)};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createHmacOutputMethod(r,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,n){var r,i=typeof e;if("string"===i){var o,a=[],c=e.length,s=0;for(r=0;r<c;++r)(o=e.charCodeAt(r))<128?a[s++]=o:o<2048?(a[s++]=192|o>>6,a[s++]=128|63&o):o<55296||o>=57344?(a[s++]=224|o>>12,a[s++]=128|o>>6&63,a[s++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++r)),a[s++]=240|o>>18,a[s++]=128|o>>12&63,a[s++]=128|o>>6&63,a[s++]=128|63&o);e=a}else{if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var l=[],u=[];for(r=0;r<64;++r){var p=e[r]||0;l[r]=92^p,u[r]=54^p}Sha256.call(this,t,n),this.update(u),this.oKeyPad=l,this.inner=!0,this.sharedMemory=n}Sha256.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var r,i,o=0,a=e.length,c=this.blocks;o<a;){if(this.hashed&&(this.hashed=!1,c[0]=this.block,c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),t)for(i=this.start;o<a&&i<64;++o)c[i>>2]|=e[o]<<SHIFT[3&i++];else for(i=this.start;o<a&&i<64;++o)(r=e.charCodeAt(o))<128?c[i>>2]|=r<<SHIFT[3&i++]:r<2048?(c[i>>2]|=(192|r>>6)<<SHIFT[3&i++],c[i>>2]|=(128|63&r)<<SHIFT[3&i++]):r<55296||r>=57344?(c[i>>2]|=(224|r>>12)<<SHIFT[3&i++],c[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],c[i>>2]|=(128|63&r)<<SHIFT[3&i++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++o)),c[i>>2]|=(240|r>>18)<<SHIFT[3&i++],c[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++],c[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],c[i>>2]|=(128|63&r)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=c[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,n,r,i,o,a,c,s,l=this.h0,u=this.h1,p=this.h2,d=this.h3,f=this.h4,h=this.h5,_=this.h6,v=this.h7,y=this.blocks;for(e=16;e<64;++e)t=((i=y[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,n=((i=y[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,y[e]=y[e-16]+t+y[e-7]+n|0;for(s=u&p,e=0;e<64;e+=4)this.first?(this.is224?(o=300032,v=(i=y[0]-1413257819)-150054599|0,d=i+24177077|0):(o=704751109,v=(i=y[0]-210244248)-1521486534|0,d=i+143694565|0),this.first=!1):(t=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),r=(o=l&u)^l&p^s,v=d+(i=v+(n=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&h^~f&_)+K[e]+y[e])|0,d=i+(t+r)|0),t=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),r=(a=d&l)^d&u^o,_=p+(i=_+(n=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&f^~v&h)+K[e+1]+y[e+1])|0,t=((p=i+(t+r)|0)>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),r=(c=p&d)^p&l^a,h=u+(i=h+(n=(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&v^~_&f)+K[e+2]+y[e+2])|0,t=((u=i+(t+r)|0)>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),r=(s=u&p)^u&d^c,f=l+(i=f+(n=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&_^~h&v)+K[e+3]+y[e+3])|0,l=i+(t+r)|0;this.h0=this.h0+l|0,this.h1=this.h1+u|0,this.h2=this.h2+p|0,this.h3=this.h3+d|0,this.h4=this.h4+f|0,this.h5=this.h5+h|0,this.h6=this.h6+_|0,this.h7=this.h7+v|0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,c=this.h7,s=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(s+=HEX_CHARS[c>>28&15]+HEX_CHARS[c>>24&15]+HEX_CHARS[c>>20&15]+HEX_CHARS[c>>16&15]+HEX_CHARS[c>>12&15]+HEX_CHARS[c>>8&15]+HEX_CHARS[c>>4&15]+HEX_CHARS[15&c]),s},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,c=this.h7,s=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||s.push(c>>24&255,c>>16&255,c>>8&255,255&c),s},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,void 0,exports,module),void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}.call(this,__webpack_require__(15692),__webpack_require__(69475))},47971:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformToIde=void 0;var r=n(31635),i=n(46538),o=n(88772),a=n(53307),c=n(48428),s=(0,r.__importStar)(n(31132)),l=n(24042),u=(0,r.__importStar)(n(22176)),p=(0,r.__importStar)(n(64749)),d=n(49755),f=function(){function e(){this.plugins=new Set,this.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,(0,r.__spreadArray)(["Error when transform to ide ","["+e+"]: "],t,!1))},this.param_block_ids=[],this.redo_param_connect=[],this.redo_collapse_ids=[];var e=new d.ConflictResolver;this.register_plugins([e])}return e.prototype.register_plugins=function(e){var t=this;e.forEach(function(e){return t.plugins.add(e)})},e.prototype.decompose_and_transform_op=function(e){var t=this;try{this.plugins.forEach(function(t){t.before_decompose_and_sort_op(e)})}catch(e){this.error("Before decompose and sort op",e)}var n=void 0;try{n=p.decompose_and_sort_op(e)}catch(e){this.error("Decompose and sort op",e)}if(n){for(var r=this.analyze_sorted_ops(n),i=r.analyze_result,o=r.affected_ids,a=Array.from(this.plugins),c=0;c<a.length;c++){var s=a[c];try{if(!s.after_analyze_op(o))return}catch(e){return void this.error("After analyze op",e)}}i.pick_ops.forEach(function(e){t.transform_pick_operation(e,i.drop_ops)}),i.drop_ops.forEach(function(e){t.transform_drop_operation(e)}),this.redo_param_connect.length&&this.redo_param_connect.forEach(function(e){t.transform_drop_operation(e)}),this.redo_param_connect=[],this.param_block_ids=[],this.redo_collapse_ids.length&&this.redo_collapse_ids.forEach(function(e){try{t.Blink.events.disable();var n=t.Blink.mainWorkspace.get_block_by_id(e);null!=n&&n.set_collapsed(!1),null!=n&&n.set_collapsed(!0)}catch(n){t.error("Retrying creating collapsed blocks",e)}finally{t.Blink.events.enable()}}),this.redo_collapse_ids=[];try{this.plugins.forEach(function(t){t.after_transform_op_to_event(e)})}catch(e){this.error("After transform op to event",e)}}},e.prototype.analyze_sorted_ops=function(e){var t=this,n=[],r={drop_ops:[],pick_ops:[]};return e.pick_ops.forEach(function(e){if(u.is_pick_operation(e.operation)){try{t.plugins.forEach(function(t){t.before_analyze_op(e)})}catch(n){t.error("Before analyze pick op",e,n)}var i=p.analyze_path("pick",e.path);if(void 0!==i&&(r.pick_ops.push({event_type:i.event_type,normalized_path:i.normalized_path,operation:e.operation}),n.push(i.normalized_path.target_id),i.event_type===u.EventType.DISCONNECT)){if(!u.is_path_3(i.normalized_path))return;n.push(i.normalized_path.property)}}}),e.drop_ops.forEach(function(e){if(u.is_drop_operation(e.operation)){try{t.plugins.forEach(function(t){t.before_analyze_op(e)})}catch(n){t.error("Before analyze drop op",e,n)}var i=p.analyze_path("drop",e.path);if(void 0!==i){if(r.drop_ops.push({event_type:i.event_type,normalized_path:i.normalized_path,operation:e.operation}),n.push(i.normalized_path.target_id),i.event_type===u.EventType.CONNECT){if(!u.is_path_3(i.normalized_path))return;n.push(i.normalized_path.property)}if(i.event_type===u.EventType.CREATE_COMMENT){var o=e.operation;o.i&&(0,c.is_comment_json)(o.i)&&null!==o.i.parent_id&&n.push(o.i.parent_id)}}}}),{analyze_result:r,affected_ids:n}},e.prototype.transform_pick_operation=function(e,t){var n=this;try{this.plugins.forEach(function(t){t.before_generate_event(e)})}catch(t){this.error("Before generate pick event",e,t)}var i=e.event_type,o=e.normalized_path,a=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return n.error.apply(n,(0,r.__spreadArray)(["Transforming pick operation",e],t,!1))};if(i!==u.EventType.DISCONNECT)if(i!==u.EventType.DELETE_BLOCK)if(i!==u.EventType.DELETE_COMMENT){if(i===u.EventType.REMOVE_SHADOW_INPUT){if(!u.is_path_4(o))return;if(_=o.target_id,!(g=this.Blink.mainWorkspace.get_block_by_id(_)))return void a("remove shadow input: cannot find target block "+_);for(var c=void 0,s=0;s<t.length;s++){var l=t[s];if(l.event_type===u.EventType.APPEND_SHADOW_INPUT&&u.is_path_4(l.normalized_path)&&l.normalized_path.target_id===o.target_id&&l.normalized_path.property_name===o.property_name){c=l;break}}if(!c){if(!g.removeMutation)return void a("Block "+_+" should have function: removeMutation.");this.Blink.events.disable();try{g.removeMutation()}catch(e){a(e)}finally{this.Blink.events.enable()}}}}else{if(!u.is_path_2(o))return;var p=o.target_id,d=this.Blink.mainWorkspace.workspace_comment_db.get(p);if(!d)return;if(y=this.Blink.json.comment_to_json(d).parent_id){var f=this.Blink.mainWorkspace.get_element_from_db(y);if(!f)return void a("cannot find block connected to this comment "+p);this.Blink.events.disable();try{var h=this.Blink.xml.comment_to_dom_with_xy(d);this.change_event_factory("comment",{block:f,old_value:h,new_value:void 0}).run(!0)}catch(e){a(e)}finally{this.Blink.events.enable()}}else{v=this.delete_event_factory({block:d}),this.Blink.events.disable();try{v.run(!0)}catch(e){a(e)}finally{this.Blink.events.enable()}}}else{if(!u.is_path_2(o))return;var _=o.target_id;if(!(g=this.Blink.mainWorkspace.get_block_by_id(_))||g.is_shadow())return;if(b=g.get_parent()){m={id:_,group:"",old_parent_id:b.id},E=this.move_event_factory({block:g}),this.Blink.events.disable();try{E.deserialize(m),E.run(!0)}catch(e){a("disconnecting from parent",e)}finally{this.Blink.events.enable()}}var v=this.delete_event_factory({block:g});this.Blink.events.disable();try{v.run(!0)}catch(e){a("deleting",e)}finally{this.Blink.events.enable()}}else{if(!u.is_path_3(o))return;_=o.property;var y=o.target_id,g=this.Blink.mainWorkspace.get_block_by_id(_),b=this.Blink.mainWorkspace.get_block_by_id(y);if(!g||!b||g.is_shadow())return;var m={id:_,group:"",old_parent_id:y},E=this.move_event_factory({block:g});this.Blink.events.disable();try{E.deserialize(m),E.run(!0)}catch(e){a(e)}finally{this.Blink.events.enable()}}},e.prototype.transform_drop_operation=function(e){var t,n,a,p,d,f,h,_=this;try{this.plugins.forEach(function(t){t.before_generate_event(e)})}catch(t){this.error("Before generate drop event",e,t)}var v=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return _.error.apply(_,(0,r.__spreadArray)(["Transforming drop operation",e],t,!1))},y=e.event_type,g=e.normalized_path,b=e.operation;if(u.is_path_2(g)){if(y===u.EventType.CREATE_BLOCK){var m=g.target_id;if(!b.i||!(0,c.is_block_json)(b.i))return void v("Invalid op. ");if(M=this.Blink.mainWorkspace.get_block_by_id(m))return void this.Blink.json.parse_block_data(b.i,M);var E={blocks:(t={},t[m]=b.i,t),connections:{},comments:{}};this.Blink.events.disable();try{this.Blink.json.json_to_workspace(E,this.Blink.mainWorkspace)}catch(e){v(e)}finally{this.Blink.events.enable()}var k=this.Blink.mainWorkspace.get_block_by_id(m);return"param"===(null==k?void 0:k.element_type)&&this.param_block_ids.push(m),void((null==k?void 0:k.is_collapsed())&&this.redo_collapse_ids.push(m))}if(y===u.EventType.CREATE_COMMENT){var O=g.target_id;if(!b.i||!(0,c.is_comment_json)(b.i))return void v("Invalid op. ");var C=b.i;if(C.parent_id){if(!(J=this.Blink.mainWorkspace.get_element_from_db(C.parent_id)))return void v("cannot find block connected to this comment "+O);var P=this.change_event_factory("comment",{block:J,old_value:void 0,new_value:O});this.Blink.events.disable();try{P.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}if(!(X=this.Blink.mainWorkspace.get_element_from_db(O))||!(0,l.is_workspace_comment)(X))return void v("create: cannot find target comment "+O);var w=C.location;if(!Array.isArray(w)||"number"!=typeof w[0]||"number"!=typeof w[1])return void v("Invalid op. ");var T=[w[0],w[1]],A={id:X.id,group:"",new_coordinate:T},B=this.move_event_factory({block:X});this.Blink.events.disable();try{B.deserialize(A),B.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}if(C.text){var R=this.change_event_factory("comment_text",{block:X,old_value:"",new_value:C.text});this.Blink.events.disable();try{R.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}}var j=X.get_color_theme(),S=this.change_event_factory("comment_color",{block:X,old_value:j,new_value:C.color_theme});this.Blink.events.disable();try{S.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}}else{E={blocks:{},connections:{},comments:(n={},n[C.id]=C,n)},this.Blink.events.disable();try{this.Blink.json.json_to_workspace(E,this.Blink.mainWorkspace)}catch(e){v(e)}finally{this.Blink.events.enable()}}return}}if(u.is_path_3(g)){if(y===u.EventType.MOVE_BLOCK){m=g.target_id;var D=this.Blink.mainWorkspace.get_block_by_id(m);if(!D)return void v("move block: cannot find target block "+m);if(D.is_shadow())return;if(!Array.isArray(b.i)||"number"!=typeof b.i[0]||"number"!=typeof b.i[1])return void v("invalid op. ");A={id:m,group:"",new_coordinate:T=[b.i[0],b.i[1]]},B=this.move_event_factory({block:D}),this.Blink.events.disable();try{B.deserialize(A),B.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.COLLAPSE_BLOCK){m=g.target_id;var I=this.Blink.mainWorkspace.get_element_from_db(m);if(!I)return void v("Invalid block "+m+". ");if("boolean"!=typeof b.i)return void v("Invalid op. ");var L=b.i;P=this.change_event_factory("collapsed",{block:I,old_value:!L,new_value:L}),this.Blink.events.disable();try{P.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.DISABLE_BLOCK){if(m=g.target_id,!(M=this.Blink.mainWorkspace.get_block_by_id(m)))return void v("Invalid block "+m+". ");var x=b.i;if("boolean"!=typeof x)return void v("Invalid op. ");P=this.change_event_factory("disabled",{block:M,old_value:!x,new_value:x}),this.Blink.events.disable();try{P.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.SET_BLOCK_VISIBILITY){if(m=g.target_id,!(M=this.Blink.mainWorkspace.get_block_by_id(m)))return void v("Invalid block "+m+". ");var F=b.i;if("string"!=typeof F)return void v("Invalid op. ");var N=(0,i.parse_visibility)(F);if(!N)return void v("Invalid op. ");P=this.change_event_factory("visibility",{block:M,old_value:s.BlockVisibility.HIDDEN,new_value:N}),this.Blink.events.disable();try{P.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.CONNECT){m=g.property;var H=g.target_id,M=this.Blink.mainWorkspace.get_block_by_id(m),U=this.Blink.mainWorkspace.get_block_by_id(H);if(!M)return void v("Invalid block "+m+". ");if(!b.i||!(0,c.is_connection_json)(b.i))return void v("Invalid op. ");var W=b.i;if(A={id:m,group:""},"next"===W.type&&(A.new_parent_id=H),"input"===W.type){if(A.new_parent_id=H,A.new_input_name=W.input_name,!U)return void v("Invalid block "+m+". ");if(!(z=U.get_input(W.input_name)))return void v("Cannot find target input "+W.input_name+" on block "+H)}B=this.move_event_factory({block:M}),this.Blink.events.disable();try{B.deserialize(A),B.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}if(this.param_block_ids.includes(m)&&this.redo_param_connect.push(e),!M.is_shadow())return;for(var V=0;V<M.inputList.length;V++)for(var z=M.inputList[V],G=0;G<z.fieldRow.length;G++){var K=z.fieldRow[G];(0,l.is_field_number)(K)&&K.update_allow_text()}return}if(y===u.EventType.MOVE_COMMENT){var X;if(O=g.target_id,!(X=this.Blink.mainWorkspace.get_element_from_db(O)))return void v("Invalid comment "+O);if(!Array.isArray(b.i)||"number"!=typeof b.i[0]||"number"!=typeof b.i[1])return void v("Invalid op. ");A={id:O,group:"",new_coordinate:T=[b.i[0],b.i[1]]},B=this.move_event_factory({block:X}),this.Blink.events.disable();try{B.deserialize(A),B.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.EDIT_COMMENT){if(O=g.target_id,!(J=this.Blink.mainWorkspace.get_element_from_db(O)))return void v("Invalid comment "+O);if("string"!=typeof b.i)return void v("Invalid op. ");R=this.change_event_factory("comment_text",{block:J,old_value:"",new_value:b.i}),this.Blink.events.disable();try{R.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.COLLAPSE_COMMENT){if(O=g.target_id,!(J=this.Blink.mainWorkspace.get_element_from_db(O)))return void v("Invalid comment "+O);if("boolean"!=typeof b.i)return void v("Invalid op. ");var Y=b.i,$=this.change_event_factory("comment_expand",{block:J,old_value:!Y,new_value:Y});this.Blink.events.disable();try{$.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.CHANGE_COMMENT_COLOR){O=g.target_id;var J=this.Blink.mainWorkspace.get_element_from_db(O);if(!(0,l.is_workspace_comment)(J))return void v("Invalid comment "+O);if(!(0,l.is_comment_theme)(b.i))return void v("Invalid op. ");j=J.get_color_theme(),S=this.change_event_factory("comment_color",{block:J,old_value:j,new_value:b.i}),this.Blink.events.disable();try{S.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.RESIZE_COMMENT){if(O=g.target_id,!(J=this.Blink.mainWorkspace.get_element_from_db(O)))return void v("Invalid comment "+O);if(!Array.isArray(b.i)||"number"!=typeof b.i[0]||"number"!=typeof b.i[1])return void v("Invalid op. ");var q=J.get_height_width(),Q=this.change_event_factory("comment_resize",{block:J,old_value:[q.width,q.height],new_value:[b.i[0],b.i[1]]});this.Blink.events.disable();try{Q.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}}if(u.is_path_4(g)){if(y===u.EventType.EDIT_BLOCK_FIELD){if("string"!=typeof b.i)return void v("Invalid op. ");if(m=g.target_id,!(M=this.Blink.mainWorkspace.get_block_by_id(m)))return void v("Invalid block "+m);var Z=g.property_name;if(!(K=M.get_field(Z))){var ee={TEXT:"NUM",NUM:"TEXT"};if(!(K=M.get_field(ee[Z]))||!K.allow_text)return void v("Invalid field "+Z+" on block "+m);Z=ee[Z]}var te=K.get_value();if(te===b.i)return;var ne=M.type===o.PROCEDURE_BLOCK_TYPES.DEF&&Z===o.PROCEDURE_BLOCK_FIELD_NAMES.PROCEDURE_NAME;P=this.change_event_factory(ne?"procedure_rename":"field",{block:M,old_value:te,new_value:b.i,name:Z}),this.Blink.events.disable();try{P.run(!0)}catch(e){v(e)}finally{this.Blink.events.enable()}return}if(y===u.EventType.APPEND_SHADOW_INPUT){if("string"!=typeof b.i)return void v("Invalid op. ");m=g.target_id;var re=g.property_name;if(!(M=this.Blink.mainWorkspace.get_block_by_id(m)))return void v("Invalid block "+m);if(z=M.get_input(re))null!==(a=z.connection)&&void 0!==a&&a.set_shadow_from_string(b.i);else{this.Blink.events.disable();try{null!==(p=M.addMutation)&&void 0!==p&&p.call(M),null!==(h=null===(f=null===(d=M.get_input(re))||void 0===d?void 0:d.connection)||void 0===f?void 0:f.targetBlock())&&void 0!==h&&h.dispose()}catch(e){v(e)}finally{this.Blink.events.enable()}}}}if(u.is_path_5(g)&&y===u.EventType.EDIT_FIELD_EXTRA_ATTR){if(m=g.target_id,!(M=this.Blink.mainWorkspace.get_block_by_id(m)))return void v("Invalid block "+m);if(Z=g.property_name,!(K=M.get_field(Z)))return void v("Cannot find field "+Z+" on block "+m);if((0,l.is_field_default_value)(K)){if("boolean"!=typeof b.i)return void v("Invalid op. ");K.set_has_been_edited(b.i)}}},(0,r.__decorate)([(0,a.lazy_inject)(a.BINDING.Blink)],e.prototype,"Blink",void 0),(0,r.__decorate)([(0,a.lazy_inject)(a.BINDING.MoveEvent)],e.prototype,"move_event_factory",void 0),(0,r.__decorate)([(0,a.lazy_inject)(a.BINDING.DeleteEvent)],e.prototype,"delete_event_factory",void 0),(0,r.__decorate)([(0,a.lazy_inject)(a.BINDING.ChangeEvent)],e.prototype,"change_event_factory",void 0),e}();t.TransformToIde=f},48703:(e,t,n)=>{n.r(t),n.d(t,{a:()=>E,b:()=>P,c:()=>C,d:()=>c,default:()=>T,e:()=>a,f:()=>m,g:()=>_,h:()=>h,i:()=>f,j:()=>d,k:()=>l,l:()=>p,m:()=>b,n:()=>u,o:()=>v,p:()=>k,q:()=>O,r:()=>g,s:()=>y,t:()=>w});const r=n(21272),i=n(5197),o=n(53307);function a(e){return{alt:"*",src:e,type:"field_icon",is_head:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}function c(e,t,n){return{type:"field_image",src:"".concat(e),width:t||"%{BKY_BLOCK_TYPE_ICON_WIDTH}",height:n||"%{BKY_BLOCK_TYPE_ICON_WIDTH}"}}function s(e){return e&&e.length?e.join(", "):""}function l(e,t){var n=e.map(function(e,t){return e||"_unset_".concat(t)});return"async function(".concat(s(n),") {").concat(t,"}")}function u(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=s(t),a=s(r),c="".concat(i?"CocoExtension.":"Coco.").concat(e,"(").concat(o);if(n&&null!==n){var l=t&&t.length?", ":"";c+="".concat(l," async function(").concat(a,") {\n").concat(n,"}")}return c+");\n"}function p(e,t,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=JSON.stringify({blockId:t.id,blockType:t.type,screenId:n.getDynamicValue("__CURRENT_SCREEN_ID__")}),o="await ".concat("Coco.","withContextAsync(async ()=> { ").concat(r?"return":""," ").concat(e," }, ").concat(i,")").concat(r?"":";"," ");return e.endsWith("\n")&&(o+="\n"),o}function d(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=t?s(t):"",a="await ".concat(i?"CocoExtension.":"Coco.").concat(e,"(").concat(o),c=s(r);if(n&&null!==n){var l=t&&t.length?", ":"";a+="".concat(l," async function(").concat(c,") {\n").concat(n,"}")}return a+");\n"}function f(e,t,n,r){var i="await ".concat(e,"(");return t&&(i+="async function(".concat(s(r),") {\n").concat(t,"}")),n&&(i+="".concat(t?", ":"").concat(s(n))),i+");\n"}function h(e,t){return"/* ".concat(Object.entries(t).map(function(e){var t=r.a(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)}).join(";")," */ ").concat(e)}function _(e,t){return"async function () {\n    if (typeof (".concat(e,') === "boolean") {\n      return ((').concat(e,") === ").concat(t,");\n    } else if (typeof (").concat(e,') === "number" && ((').concat(e,") === 0)) {\n      return (false === ").concat(t,");\n    }\n    return (true === ").concat(t,")\n  }")}function v(e){return JSON.stringify(e)}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t?s(t):"";return"".concat(n?"CocoExtension.":"Coco.").concat(e,"(").concat(r,")")}function g(e,t){var n=t?s(t):"";return"await ".concat("Coco.").concat(e,"(").concat(n,")")}function b(e,t,n){var r=t?s(t):"",i="".concat("Coco.").concat(e,"(").concat(r);if(n&&null!==n){var o=t&&t.length?", ":"";i+="".concat(o," asyncScheduler.plan(async function() {\n").concat(n,"})")}return i+");\n"}function m(e,t){var n=encodeURI(e).replace(/%/g,"$");return"$"+t.replace(/-/g,"$")+"_"+n}var E="_param_",k=i.Blink.di_container.get(o.BINDING.MutationAddButton),O=i.Blink.di_container.get(o.BINDING.MutationRemoveButton),C=i.Blink.di_container.get(o.BINDING.ChangeEvent);function P(e,t,n,r){if(!this.get_input(e)){var o=this.rendered;this.rendered=!1;var a=t();if(o&&(this.inputList.forEach(function(e){return e.init()}),this.render(!0)),this.rendered&&(this.cacheId[e]=this.cacheId[e]||i.Blink.utils.gen_uid()),this.cacheId[e]){var c,s,l=i.Blink.utils.string_to_dom(n);if(l.setAttribute("id",this.cacheId[e]),void 0!==r&&l.firstElementChild&&(l.firstElementChild.textContent=r),null!==(c=a.connection)&&void 0!==c&&c.set_shadow_dom(l),null!==(s=a.connection)&&void 0!==s&&s.respawn_shadow(),i.Blink.events.is_enabled()){var u=C("mutation",{block:this,old_value:void 0,new_value:"1"});i.Blink.events.fire(u)}this.rendered=o}}}function w(e,t,n){var r,o=this.get_input(e);if(o){var a,c=null===(r=o.connection)||void 0===r?void 0:r.targetBlock();if(c&&c.is_shadow())this.cacheId[e]=c.id,a=c.get_field_value(t)||"1";else{var s,l,u=null===(s=o.connection)||void 0===s?void 0:s.get_shadow_dom();this.cacheId[e]=(null==u?void 0:u.getAttribute("id"))||i.Blink.utils.gen_uid(),a=(null==u||null===(l=u.querySelector('field[name="'.concat(t,'"]')))||void 0===l?void 0:l.textContent)||"1"}var p=this.rendered;if(this.rendered=!1,n(),p&&(this.inputList.forEach(function(e){return e.init()}),this.render(!0)),i.Blink.events.is_enabled()){var d=C("mutation",{block:this,old_value:a,new_value:void 0});i.Blink.events.fire(d)}this.rendered=p}}const T=E},49755:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictResolver=t.GlobalCommentPlugin=t.ProcedurePlugin=void 0;var r=n(29710);Object.defineProperty(t,"ProcedurePlugin",{enumerable:!0,get:function(){return r.ProcedurePlugin}});var i=n(96041);Object.defineProperty(t,"GlobalCommentPlugin",{enumerable:!0,get:function(){return i.GlobalCommentPlugin}});var o=n(10178);Object.defineProperty(t,"ConflictResolver",{enumerable:!0,get:function(){return o.ConflictResolver}})},52342:(e,t,n)=>{var r=n(92808);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},53307:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lazy_inject=t.get_instance=t.BINDING=void 0;var r=n(86865);Object.defineProperty(t,"BINDING",{enumerable:!0,get:function(){return r.BINDING}});var i=n(3672);Object.defineProperty(t,"get_instance",{enumerable:!0,get:function(){return i.get_instance}}),Object.defineProperty(t,"lazy_inject",{enumerable:!0,get:function(){return i.lazy_inject}})},56042:(e,t,n)=>{n.r(t),n.d(t,{a:()=>i,default:()=>o});const r=n(41460);function i(e,t){var n=r.a({},e);return Array.isArray(t)&&t.forEach(function(e){delete n[e]}),n}const o=i},64749:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.analyze_path=t.decompose_and_sort_op=t.filter_events=void 0;var r=n(31635),i=(0,r.__importStar)(n(31132)),o=(0,r.__importStar)(n(22176));function a(e){var t=e[e.length-2],n=e[e.length-3];if("field_extra_attr"===n){var r=e.slice(-5);return o.is_path_5_array(r)?{target_type:r[o.PathParams5.BLOCK],target_id:r[o.PathParams5.ID],property:r[o.PathParams5.PROPERTY],property_name:r[o.PathParams5.PROPERTY_NAME],field_attr:r[o.PathParams5.FIELD_ATTR]}:void console.error("Invalid op path: "+e)}if(t in o.Field_Type){var i=e.slice(-4);return o.is_path_4_array(i)?{target_type:i[o.PathParams4.BLOCK],target_id:i[o.PathParams4.ID],property:i[o.PathParams4.PROPERTY],property_name:i[o.PathParams4.PROPERTY_NAME]}:void console.error("Invalid op path: "+e)}if(n in o.Target_Type){var a=e.slice(-3);return o.is_path_3_array(a)?{target_type:a[o.PathParams3.TARGET],target_id:a[o.PathParams3.ID],property:a[o.PathParams3.PROPERTY]}:void console.error("Invalid op path: "+e)}if(t in o.Target_Type){var c=e.slice(-2);return o.is_path_2_array(c)?{target_type:c[o.PathParams2.TARGET],target_id:c[o.PathParams2.ID]}:void console.error("Invalid op path: "+e)}}t.filter_events=function(e){if(0===e.length)return[];var t=[];e.forEach(function(e){e.type!==i.BlockEventType.CREATE&&e.type!==i.BlockEventType.DELETE&&e.type!==i.BlockEventType.CHANGE&&e.type!==i.BlockEventType.MOVE||t.push(e)});for(var n=new Map,r=0;r<=t.length-1;){var o=t[r];if(o.type!==i.BlockEventType.CREATE)if(o.type!==i.BlockEventType.DELETE)r++;else{c=o.get_block_id();var a=n.get(c);if(void 0!==a){t.splice(a,r-a+1),r=a,n.set(c,void 0);continue}r++}else{var c=o.get_block_id();if(void 0!==n.get(c))return console.error("create the same block "+c+" multi times."),[];n.set(c,r),r++}}return t},t.decompose_and_sort_op=function(e){var t=function(e){for(var t={pick_ops:[],drop_ops:[],edit_ops:[]},n=[{path:[],operation:e}],r=[];0!==n.length&&null!=n[0].operation;){for(var i=0;i<n.length;i++){var o=n[i],a=o.path.slice(0),c=o.operation;if(!c)return;for(var s=function(e){var n=c[e];if("string"==typeof n||"number"==typeof n)return a.push(n),"continue";if(Array.isArray(n))return r.push({path:a.slice(0),operation:n}),"continue";if("object"==typeof n){var i=a.slice(0);Object.keys(n).forEach(function(e){var r,o,a;"p"!==e&&"r"!==e?"i"!==e&&"d"!==e?"es"!==e&&"ena"!==e||t.edit_ops.push({path:i.slice(0),operation:(a={},a[e]=n[e],a)}):t.drop_ops.push({path:i.slice(0),operation:(o={},o[e]=n[e],o)}):t.pick_ops.push({path:i.slice(0),operation:(r={},r[e]=n[e],r)})})}},l=0;l<c.length;l++)s(l);a=[]}n=r,r=[]}return t}(e);return t?function(e){var t=function(e){var t=[],n=[],r=[];return e.forEach(function(e){var i=a(e.path);if(i)switch(i.target_type){case"blocks":t.push(e);break;case"connections":r.push(e);break;case"comments":n.push(e)}}),{block_ops:t,comment_ops:n,conn_ops:r}},n=t(e.pick_ops),r=n.conn_ops.concat(n.block_ops).concat(n.comment_ops),i=t(e.drop_ops);return{pick_ops:r,drop_ops:i.block_ops.concat(i.conn_ops).concat(i.comment_ops),edit_ops:e.edit_ops}}(t):(console.error(e+" cannot be decomposed"),{pick_ops:[],drop_ops:[],edit_ops:[]})},t.analyze_path=function(e,t){var n=void 0,r=a(t);if(r){var i=r.target_type;if("pick"===e){if(o.is_path_2(r))switch(i){case"blocks":n=o.EventType.DELETE_BLOCK;break;case"comments":n=o.EventType.DELETE_COMMENT}o.is_path_3(r)&&"connections"===i&&(n=o.EventType.DISCONNECT),o.is_path_4(r)&&"blocks"===i&&"shadows"===r.property&&(n=o.EventType.REMOVE_SHADOW_INPUT)}if("drop"===e){if(o.is_path_2(r))switch(i){case"blocks":n=o.EventType.CREATE_BLOCK;break;case"comments":n=o.EventType.CREATE_COMMENT}if(o.is_path_3(r))switch(i){case"blocks":switch(r.property){case"location":n=o.EventType.MOVE_BLOCK;break;case"collapsed":n=o.EventType.COLLAPSE_BLOCK;break;case"disabled":n=o.EventType.DISABLE_BLOCK;break;case"visible":n=o.EventType.SET_BLOCK_VISIBILITY}break;case"connections":n=o.EventType.CONNECT;break;case"comments":switch(r.property){case"location":n=o.EventType.MOVE_COMMENT;break;case"text":n=o.EventType.EDIT_COMMENT;break;case"pinned":n=o.EventType.COLLAPSE_COMMENT;break;case"color_theme":n=o.EventType.CHANGE_COMMENT_COLOR;break;case"size":n=o.EventType.RESIZE_COMMENT}}if(o.is_path_4(r))switch(r.property){case"fields":n=o.EventType.EDIT_BLOCK_FIELD;break;case"shadows":n=o.EventType.APPEND_SHADOW_INPUT}o.is_path_5(r)&&(n=o.EventType.EDIT_FIELD_EXTRA_ATTR)}if(void 0!==n)return{event_type:n,normalized_path:r}}else console.warn("path "+t+" cannot be normalized")}},65252:(e,t,n)=>{var r,i,o=n(72505),a=(r=o,i=r&&r.__esModule?function(){return r.default}:function(){return r},Object.defineProperty(i,"a",{enumerable:!0,get:i}),i).a.create({timeout:5e3,withCredentials:!0});a.interceptors.request.use(function(e){return e},function(e){return Promise.reject(e)}),a.interceptors.response.use(function(e){return e},function(e){return e.response,Promise.reject(e)}),t.a=a},69175:function(e){(function(t){e.exports=t}).call(this,{})},76762:(e,t,n)=>{n.r(t),n.d(t,{oTHelper:()=>Rn});var r={};Object.defineProperty(r,"addWidgetOp",{get:function(){return pe}}),Object.defineProperty(r,"addInvisibleWidgetOp",{get:function(){return fe}}),Object.defineProperty(r,"addBrushAndActorWidgetOp",{get:function(){return _e}}),Object.defineProperty(r,"deleteWidgetOp",{get:function(){return ye}}),Object.defineProperty(r,"deleteInvisibleWidgetOp",{get:function(){return ge}}),Object.defineProperty(r,"replaceWidgetAttributeOp",{get:function(){return be}}),Object.defineProperty(r,"moveWidget",{get:function(){return me}});var i={};Object.defineProperty(i,"pick",{get:function(){return Ae}}),Object.defineProperty(i,"drop",{get:function(){return Be}});var o={};Object.defineProperty(o,"clientOp",{get:function(){return r}}),Object.defineProperty(o,"serverOp",{get:function(){return i}});var a={};Object.defineProperty(a,"changeProjectProperty",{get:function(){return je}});var c={};Object.defineProperty(c,"pick",{get:function(){return Se}}),Object.defineProperty(c,"drop",{get:function(){return De}});var s={};Object.defineProperty(s,"clientOp",{get:function(){return a}}),Object.defineProperty(s,"serverOp",{get:function(){return c}});var l={};Object.defineProperty(l,"addScreen",{get:function(){return Fe}}),Object.defineProperty(l,"removeScreen",{get:function(){return Ne}}),Object.defineProperty(l,"moveScreen",{get:function(){return He}}),Object.defineProperty(l,"updateScreenStyle",{get:function(){return Me}});var u={};Object.defineProperty(u,"pick",{get:function(){return Ue}}),Object.defineProperty(u,"drop",{get:function(){return We}});var p={};Object.defineProperty(p,"clientOp",{get:function(){return l}}),Object.defineProperty(p,"serverOp",{get:function(){return u}});var d={};Object.defineProperty(d,"add",{get:function(){return ze}}),Object.defineProperty(d,"remove",{get:function(){return Ke}}),Object.defineProperty(d,"replaceImageFileId",{get:function(){return Xe}}),Object.defineProperty(d,"replaceImageFileCdnUrl",{get:function(){return Ye}});var f={};Object.defineProperty(f,"pick",{get:function(){return Je}}),Object.defineProperty(f,"drop",{get:function(){return qe}});var h={};Object.defineProperty(h,"clientOp",{get:function(){return d}}),Object.defineProperty(h,"serverOp",{get:function(){return f}});var _={};Object.defineProperty(_,"add",{get:function(){return Qe}}),Object.defineProperty(_,"remove",{get:function(){return et}}),Object.defineProperty(_,"replaceSoundName",{get:function(){return tt}}),Object.defineProperty(_,"replaceSoundFileCdnUrl",{get:function(){return nt}});var v={};Object.defineProperty(v,"pick",{get:function(){return ot}}),Object.defineProperty(v,"drop",{get:function(){return at}});var y={};Object.defineProperty(y,"clientOp",{get:function(){return _}}),Object.defineProperty(y,"serverOp",{get:function(){return v}});var g={};Object.defineProperty(g,"add",{get:function(){return ct}}),Object.defineProperty(g,"remove",{get:function(){return lt}}),Object.defineProperty(g,"replaceIconName",{get:function(){return pt}}),Object.defineProperty(g,"replaceIconFileCdnUrl",{get:function(){return dt}});var b={};Object.defineProperty(b,"pick",{get:function(){return ht}}),Object.defineProperty(b,"drop",{get:function(){return _t}});var m={};Object.defineProperty(m,"clientOp",{get:function(){return g}}),Object.defineProperty(m,"serverOp",{get:function(){return b}});var E={};Object.defineProperty(E,"add",{get:function(){return bt}}),Object.defineProperty(E,"remove",{get:function(){return Et}}),Object.defineProperty(E,"update",{get:function(){return kt}});var k={};Object.defineProperty(k,"pick",{get:function(){return Ot}}),Object.defineProperty(k,"drop",{get:function(){return Ct}});var O={};Object.defineProperty(O,"clientOp",{get:function(){return E}}),Object.defineProperty(O,"serverOp",{get:function(){return k}});var C={};Object.defineProperty(C,"add",{get:function(){return Tt}}),Object.defineProperty(C,"remove",{get:function(){return Bt}}),Object.defineProperty(C,"updateProperty",{get:function(){return Rt}});var P={};Object.defineProperty(P,"pick",{get:function(){return jt}}),Object.defineProperty(P,"drop",{get:function(){return St}});var w={};Object.defineProperty(w,"clientOp",{get:function(){return C}}),Object.defineProperty(w,"serverOp",{get:function(){return P}});var T={};Object.defineProperty(T,"add",{get:function(){return Lt}}),Object.defineProperty(T,"remove",{get:function(){return Ft}}),Object.defineProperty(T,"updateProperty",{get:function(){return Nt}});var A={};Object.defineProperty(A,"pick",{get:function(){return Ht}}),Object.defineProperty(A,"drop",{get:function(){return Mt}});var B={};Object.defineProperty(B,"clientOp",{get:function(){return T}}),Object.defineProperty(B,"serverOp",{get:function(){return A}});var R={};Object.defineProperty(R,"add",{get:function(){return Wt}});var j={};Object.defineProperty(j,"pick",{get:function(){return zt}}),Object.defineProperty(j,"drop",{get:function(){return Gt}});var S={};Object.defineProperty(S,"clientOp",{get:function(){return R}}),Object.defineProperty(S,"serverOp",{get:function(){return j}});var D={};Object.defineProperty(D,"focusItem",{get:function(){return $t}}),Object.defineProperty(D,"userColors",{get:function(){return Qt}}),Object.defineProperty(D,"cloudDb",{get:function(){return Zt}});var I={};Object.defineProperty(I,"emit",{get:function(){return D}}),Object.defineProperty(I,"accept",{get:function(){return tn}});var L={};Object.defineProperty(L,"add",{get:function(){return cn}}),Object.defineProperty(L,"del",{get:function(){return ln}}),Object.defineProperty(L,"replaceWidgetAttributeOp",{get:function(){return un}});var x={};Object.defineProperty(x,"pick",{get:function(){return fn}}),Object.defineProperty(x,"drop",{get:function(){return hn}});var F={};Object.defineProperty(F,"clientOp",{get:function(){return L}}),Object.defineProperty(F,"serverOp",{get:function(){return x}});var N={};Object.defineProperty(N,"addUnsafeExtensionWidget",{get:function(){return vn}}),Object.defineProperty(N,"addMallExtensionWidget",{get:function(){return gn}});var H={};Object.defineProperty(H,"drop",{get:function(){return En}});var M={};Object.defineProperty(M,"clientOp",{get:function(){return N}}),Object.defineProperty(M,"serverOp",{get:function(){return H}});var U={};Object.defineProperty(U,"updateCloudDictKeys",{get:function(){return On}}),Object.defineProperty(U,"updateCloudTableColumns",{get:function(){return Cn}}),Object.defineProperty(U,"updateCloudTableData",{get:function(){return Pn}}),Object.defineProperty(U,"updateCloudDictList",{get:function(){return wn}}),Object.defineProperty(U,"updateCloudTableList",{get:function(){return Tn}});var W={};Object.defineProperty(W,"pick",{get:function(){return An}}),Object.defineProperty(W,"drop",{get:function(){return Bn}});var V={};Object.defineProperty(V,"clientOp",{get:function(){return U}}),Object.defineProperty(V,"serverOp",{get:function(){return W}});var z={};Object.defineProperty(z,"oTHelper",{get:function(){return Rn}});const G=n(66905),K=n(99666),X=n(7452);var Y,$,J=($=(Y=X)&&Y.__esModule?function(){return Y.default}:function(){return Y},Object.defineProperty($,"a",{enumerable:!0,get:$}),$);const q=n(54176),Q=n(21009),Z=n(41383),ee=n(75083),te=n(86119),ne=n(92004),re=n(21272);function ie(e){var t,n=te.a.getDoc(),r=null==n?void 0:n.screens;if(r){var i=Object.entries(r).find(function(t){var n=re.a(t,2);return n[0],n[1].widgets[e]});t=null==i?void 0:i[1].id}return t||console.error("can't find screen of including widget"),t||""}function oe(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.screens[e].widgetIds,i=0;r&&(i=r.findIndex(function(e){return e===t}))<0&&(i=r.length);for(var o=arguments.length,a=new Array(o>2?o-2:0),c=2;c<o;c++)a[c-2]=arguments[c];return["screens",e,"widgetIds",i].concat(a)}function ae(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.screens[e].invisibleWidgetIds,i=0;r&&(i=r.findIndex(function(e){return e===t}))<0&&(i=r.length);for(var o=arguments.length,a=new Array(o>2?o-2:0),c=2;c<o;c++)a[c-2]=arguments[c];return["screens",e,"invisibleWidgetIds",i].concat(a)}function ce(e,t){return["screens",e,"widgetIds",t]}function se(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return["screens",e,"widgets",t].concat(r)}function le(e){return"widgets"===e[2]}function ue(e){return 4===e.length&&le(e)}function pe(e,t){return de.apply(this,arguments)}function de(){return(de=Q.a(J.a.mark(function e(t,n){var r,i;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=ee.insertOp(se(t,n.id),n),i=ee.insertOp(oe(t,n.id),n.id),te.a.applyClient(ee.type.compose(i,r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fe(e,t){return he.apply(this,arguments)}function he(){return(he=Q.a(J.a.mark(function e(t,n){var r,i;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=ee.insertOp(se(t,n.id),n),i=ee.insertOp(ae(t,n.id),n.id),te.a.applyClient(ee.type.compose(i,r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _e(e,t,n,r){return ve.apply(this,arguments)}function ve(){return(ve=Q.a(J.a.mark(function e(t,n,r,i){var o,a,c;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=ee.insertOp(se(t,n.id),n),a=ee.insertOp(oe(t,n.id),n.id),c=ee.replaceOp(se(t,r,"widgetIds"),!0,i),te.a.applyClient(ne.a(a,o,c));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ye(e,t){var n=ee.removeOp(oe(e,t)),r=ee.removeOp(se(e,t));te.a.applyClient(ee.type.compose(n,r))}function ge(e,t){var n=ee.removeOp(ae(e,t)),r=ee.removeOp(se(e,t));te.a.applyClient(ee.type.compose(n,r))}function be(e,t,n,r){var i,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=te.a.getDoc();if(["size","position","visible","title","widgetIds"].includes(n)&&o){var c=se(e,t,n);i=0===(a?Z.a({path:["$"].concat(q.a(c)),json:a}):[]).length?ee.insertOp(c,r):ee.replaceOp(c,!0,r)}else{var s=se(e,t,"attributes",n);i=0===(a?Z.a({path:["$"].concat(q.a(s)),json:a}):[]).length?ee.insertOp(s,r):ee.replaceOp(s,!0,r)}te.a.applyClient(i)}function me(e,t,n){var r=ee.moveOp(q.a(ce(e,t)),q.a(ce(e,n)));te.a.applyClient(r)}const Ee=n(2536),ke=n(79955),Oe=n(30691),Ce=n(32023),Pe=n(54181),we=n(16693),Te=n(73393);function Ae(e){ue(e.path)&&function(e){var t=e.path,n=t[3],r=t[1];n&&r&&Ce.h(Ee.Mf(n,r,!1))}(e)}function Be(e){var t;ue(e.path)&&function(e){Re.apply(this,arguments)}(e),"screens"===(t=e.path)[0]&&"widgetIds"===t[2]&&function(e){var t,n=e.path[1],r=null===(t=te.a.getDoc())||void 0===t?void 0:t.screens[n].widgetIds;r&&Ce.h(Ee.Bj(n,r))}(e),function(e){return"screens"===e[0]&&"invisibleWidgetIds"===e[2]}(e.path)&&function(e){var t=e.path,n=e.op,r=t[1],i=n.i;Ce.h(Ee.jf(r,i,!0))}(e),function(e){return 6===e.length&&le(e)&&"attributes"===e[4]}(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[3],o=n[5],a=ie(i);Ce.h(Ee.Lg(i,o,r,Ce.g(a),Ce.g(a),!1))}(e),function(e){return 5===e.length&&le(e)}(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[3],o=n[4],a=ie(i);"title"===o?Ce.h(Ee.Ng(i,r,!1,!0,!1)):"widgetIds"===o?Ce.h(Ee.Mg(a,i,r,!0,!0,!1)):Ce.h(Ee.Lg(i,o,r,Ce.g(a),Ce.g(a),!1))}(e)}function Re(){return(Re=Q.a(J.a.mark(function e(t){var n,r,i,o,a,c,s,l,u,p,d,f,h,_,v;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.path,i=t.op,o=i.i,!Pe.e(o.type)||ke.Db(o.type)){e.next=11;break}if(!(s=null===(a=te.a.getDoc())||void 0===a||null===(c=a.extensionWidgetList)||void 0===c?void 0:c.find(function(e){return e.type===o.type}))){e.next=11;break}return l=s.cdnUrl,u=s.id,Oe.a(Ee.zh({title:we.c(we.b,"ExtensionWidget.loading").toString(),cancelBtnVisible:!1,confirmBtnVisible:!1})),e.next=9,Te.u(l,u);case 9:(p=e.sent)&&(d=p.title,f=p.type,h=Pe.f(f,!0),Oe.a(Ee.Vg()),Oe.a(Ee.zh({title:we.c(we.b,"ExtensionWidget.finishRegistration",{title:d,type:h}).toString(),cancelBtnVisible:!1})));case 11:_=r[1],ke.Ub(o.id,o),(v=null===(n=te.a.getDoc())||void 0===n?void 0:n.screens[_].widgetIds)&&Ce.h(Ee.Bj(_,v));case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function je(e,t){var n=ee.replaceOp([e],!0,t);te.a.applyClient(n)}function Se(e){}function De(e,t){var n;1===(n=e.path).length&&"title"===n[0]&&function(e){var t=e.op.i;Ce.h(Ee.Bf(t,!1))}(e)}const Ie=n(6474),Le=n(26448);function xe(e){return 2===e.length&&"screens"===e[0]}function Fe(e,t){e=Le.g(e);var n=ee.insertOp(["screens",e.id],e),r=ee.insertOp(["screenIds",t],e.id),i=ee.type.compose(n,r);te.a.applyClient(i)}function Ne(e,t){var n=ee.removeOp(["screens",t]),r=ee.removeOp(["screenIds",e]),i=ee.type.compose(n,r);(function(e){var t=te.a.getDoc();return null==t?void 0:t.blockly[e]})(t)&&(i=ee.type.compose(i,ee.removeOp(["blockly",t]))),te.a.applyClient(i)}function He(e,t){var n=ee.moveOp(["screenIds",e],["screenIds",t]);te.a.applyClient(n)}function Me(e,t,n){var r=ee.replaceOp(["screens",e,t],!0,n);te.a.applyClient(r)}function Ue(e){xe(e.path)&&function(e){var t=e.path[1];Ce.h(Ee.ng(t,!1))}(e)}function We(e,t){var n;xe(e.path)&&function(e){var t,n=e.op.i;Object.entries(n.widgets).forEach(function(e){var t=re.a(e,2);t[0];var n=t[1];ke.Ub(n.id,n)});var r=Le.d(n);Ce.h(Ee.if(r));var i=null===(t=te.a.getDoc())||void 0===t?void 0:t.screenIds;i&&Ce.h(Ee.xg(q.a(i)))}(e),2===(n=e.path).length&&"screenIds"===n[0]&&function(){var e,t=null===(e=te.a.getDoc())||void 0===e?void 0:e.screenIds;t&&Ce.h(Ee.xg(q.a(t)))}(),function(e){return 3===e.length&&"screens"===e[0]}(e.path)&&function(e){var t=e.path,n=e.op,r=t[1],i=t[2],o=n.i;Ce.h(Ee.Jg(r,i,o,!1))}(e)}const Ve=n(2543);function ze(e){return Ge.apply(this,arguments)}function Ge(){return(Ge=Q.a(J.a.mark(function e(t){var n,r,i,o;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(r=Ve.cloneDeep(t)).source="",i=null===(n=te.a.getDoc())||void 0===n?void 0:n.imageFileList,o=ee.insertOp(["imageFileList",(null==i?void 0:i.length)||0],r),te.a.applyClient(o);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ke(e){var t,n=null===(t=te.a.getDoc())||void 0===t?void 0:t.imageFileList,r=null==n?void 0:n.findIndex(function(t){return t.id===e});if(void 0!==r&&r>-1){var i=ee.removeOp(["imageFileList",r]);te.a.applyClient(i)}}function Xe(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.imageFileList;if(r){var i=r.findIndex(function(t){return t.id===e});if(i>-1){var o=ee.replaceOp(["imageFileList",i,"id"],!0,t);te.a.applyClient(o)}}}function Ye(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.imageFileList;if(r){var i=r.findIndex(function(t){return t.id===e}),o=ee.replaceOp(["imageFileList",i,"cdnUrl"],!0,t);te.a.applyClient(o)}}function $e(e){return 2===e.length&&"imageFileList"===e[0]}function Je(e){$e(e.path)&&function(e){var t,n=e.path,r=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.imageFileList[n[1]];r&&Ce.h(Ee.Jf(r.id,!1))}(e)}function qe(e){var t;$e(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[1];ke.Tb(r,i),Ce.h(Ee.Zj()),Ce.h(Ee.Uj()),Ce.h(Ee.Qj())}(e),3===(t=e.path).length&&"imageFileList"===t[0]&&function(e){var t,n=e.path,r=e.op,i=n[1],o=n[2],a=r.i,c=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.imageFileList[i];c&&("id"===o&&Ce.h(Ee.zf(a,c.id,!1)),"cdnUrl"===o&&ke.bc(c.id,a),Ce.h(Ee.Zj()),Ce.h(Ee.Uj()),Ce.h(Ee.Qj()))}(e)}function Qe(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=Q.a(J.a.mark(function e(t){var n,r,i;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=null===(n=te.a.getDoc())||void 0===n?void 0:n.soundFileList,i=(null==r?void 0:r.length)||0,t.forEach(function(e,t){var n=Ve.cloneDeep(e);n.source="";var r=ee.insertOp(["soundFileList",i+t],n);te.a.applyClient(r)});case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function et(e){var t,n=null===(t=te.a.getDoc())||void 0===t?void 0:t.soundFileList,r=null==n?void 0:n.findIndex(function(t){return t.id===e});if(void 0!==r&&r>-1){var i=ee.removeOp(["soundFileList",r]);te.a.applyClient(i)}}function tt(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.soundFileList;if(r){var i=r.findIndex(function(t){return t.id===e});if(i>-1){var o=ee.replaceOp(["soundFileList",i,"name"],!0,t);te.a.applyClient(o)}}}function nt(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.soundFileList;if(r){var i=r.findIndex(function(t){return t.id===e}),o=ee.replaceOp(["soundFileList",i,"cdnUrl"],!0,t);te.a.applyClient(o)}}const rt=n(93833);function it(e){return 2===e.length&&"soundFileList"===e[0]}function ot(e){it(e.path)&&function(e){var t,n,r=e.path,i=null===(t=te.a.getPreviousDoc())||void 0===t||null===(n=t.soundFileList)||void 0===n?void 0:n[r[1]];i&&Ce.h(Ee.og(i.id,!1))}(e)}function at(e){var t;it(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[1];Ce.h(Ee.kf([r],i)),Ce.h(Ee.Zj()),Ce.h(Ee.Uj()),Ce.h(Ee.Qj())}(e),3===(t=e.path).length&&"soundFileList"===t[0]&&function(e){var t,n,r=e.path,i=e.op,o=r[1],a=r[2],c=i.i,s=null===(t=te.a.getPreviousDoc())||void 0===t||null===(n=t.soundFileList)||void 0===n?void 0:n[o];if(s){if("cdnUrl"===a&&Ce.h(Ee.Rg(s.id,c)),"name"===a){var l=s.name;Ce.h(Ee.Ph(s.id,c)),rt.z.replaceTextValue("audio_sound_file_list_dropdown","SOUND_FILE_ID",l,c)}Ce.h(Ee.Uj()),Ce.h(Ee.Qj())}}(e)}function ct(e){return st.apply(this,arguments)}function st(){return(st=Q.a(J.a.mark(function e(t){var n,r,i;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=null===(n=te.a.getDoc())||void 0===n?void 0:n.iconFileList,i=(null==r?void 0:r.length)||0,t.forEach(function(e,t){var n=Ve.cloneDeep(e);n.source="";var r=ee.insertOp(["iconFileList",i+t],n);te.a.applyClient(r)});case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lt(e){return ut.apply(this,arguments)}function ut(){return(ut=Q.a(J.a.mark(function e(t){var n,r,i,o;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=null===(n=te.a.getDoc())||void 0===n?void 0:n.iconFileList,void 0!==(i=null==r?void 0:r.findIndex(function(e){return e.id===t}))&&i>-1&&(o=ee.removeOp(["iconFileList",i]),te.a.applyClient(o));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pt(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.iconFileList;if(r){var i=r.findIndex(function(t){return t.id===e});if(i>-1){var o=ee.replaceOp(["iconFileList",i,"name"],!0,t);te.a.applyClient(o)}}}function dt(e,t){var n,r=null===(n=te.a.getDoc())||void 0===n?void 0:n.iconFileList;if(r){var i=r.findIndex(function(t){return t.id===e}),o=ee.replaceOp(["iconFileList",i,"cdnUrl"],!0,t);te.a.applyClient(o)}}function ft(e){return 2===e.length&&"iconFileList"===e[0]}function ht(e){ft(e.path)&&function(e){var t,n,r=e.path,i=null===(t=te.a.getPreviousDoc())||void 0===t||null===(n=t.iconFileList)||void 0===n?void 0:n[r[1]];i&&Ce.h(Ee.mg(i.id,!1))}(e)}function _t(e){var t;ft(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[1];Ce.h(Ee.df([r],i)),Ce.h(Ee.Zj()),Ce.h(Ee.Uj()),Ce.h(Ee.Qj())}(e),3===(t=e.path).length&&"iconFileList"===t[0]&&function(e){var t,n,r=e.path,i=e.op,o=r[1],a=r[2],c=i.i,s=null===(t=te.a.getPreviousDoc())||void 0===t||null===(n=t.iconFileList)||void 0===n?void 0:n[o];s&&("cdnUrl"===a&&Ce.h(Ee.Pg(s.id,c)),"name"===a&&Ce.h(Ee.Oh(s.id,c)),Ce.h(Ee.Uj()),Ce.h(Ee.Qj()))}(e)}const vt=n(8599);function yt(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return["screens",e,"primitiveVariables",t].concat(r)}function gt(e){return 4===e.length&&"primitiveVariables"===e[2]||2===e.length&&"globalVariableList"===e[0]}function bt(e,t,n,r,i,o){return mt.apply(this,arguments)}function mt(){return(mt=Q.a(J.a.mark(function e(t,n,r,i,o,a){var c,s,l;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c={id:r,name:i,defaultValue:o,value:o},t===vt.i.GLOBAL?(s=ee.insertOp(["globalVariableList",a],c),te.a.applyClient(s)):(l=ee.insertOp(yt(n,a),c),te.a.applyClient(l));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Et(e,t,n){if(e===vt.i.GLOBAL){var r,i=null===(r=te.a.getDoc())||void 0===r?void 0:r.globalVariableList.findIndex(function(e){return e.id===n});if(void 0!==i){var o=ee.removeOp(["globalVariableList",i]);te.a.applyClient(o)}else console.error("can't find index of globalVariableList")}else{var a,c=null===(a=te.a.getDoc())||void 0===a?void 0:a.screens[t].primitiveVariables.findIndex(function(e){return e.id===n});if(void 0!==c){var s=ee.removeOp(yt(t,c));te.a.applyClient(s)}else console.error("can't find index of primitiveVariable")}}function kt(e,t,n,r,i){if(e===vt.i.GLOBAL){var o,a=null===(o=te.a.getDoc())||void 0===o?void 0:o.globalVariableList.findIndex(function(e){return e.id===n});if(void 0!==a){var c=ee.replaceOp(["globalVariableList",a,r],!0,i);te.a.applyClient(c)}}else{var s,l=null===(s=te.a.getDoc())||void 0===s?void 0:s.screens[t].primitiveVariables.findIndex(function(e){return e.id===n});if(void 0!==l){var u=ee.replaceOp(yt(t,l,r),!0,i);te.a.applyClient(u)}}}function Ot(e){gt(e.path)&&function(e){var t,n=e.path;if("globalVariableList"!==n[0]){var r=n[1],i=n[3],o=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.screens[r].primitiveVariables[i],a=null==o?void 0:o.id;a&&Ce.h(Ee.Lf(vt.i.SCREEN,a,r,!1))}else{var c,s=n[1],l=null===(c=te.a.getPreviousDoc())||void 0===c?void 0:c.globalVariableList[s],u=null==l?void 0:l.id;u&&Ce.h(Ee.Lf(vt.i.GLOBAL,u,"",!1))}}(e)}function Ct(e){var t;gt(e.path)&&function(e){var t=e.path,n=e.op.i,r=n.id,i=n.name,o=n.defaultValue;if("globalVariableList"!==t[0]){var a=t[3],c=t[1];Ce.h(Ee.uf(vt.i.SCREEN,r,i,o,c,a,void 0,!1))}else{var s=t[1];Ce.h(Ee.uf(vt.i.GLOBAL,r,i,o,"",s,void 0,!1))}}(e),(5===(t=e.path).length&&"primitiveVariables"===t[2]||3===t.length&&"globalVariableList"===t[0])&&function(e){var t,n=e.path,r=e.op;if("globalVariableList"!==n[0]){var i=n[1],o=n[3],a=r.i,c=n[4],s=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.screens[i].primitiveVariables[o],l=null==s?void 0:s.id;l&&Ce.h(Ee.Hg(vt.i.SCREEN,l,c,a,i,!1))}else{var u,p=n[1],d=r.i,f=n[2],h=null===(u=te.a.getPreviousDoc())||void 0===u?void 0:u.globalVariableList[p],_=null==h?void 0:h.id;_&&Ce.h(Ee.Hg(vt.i.GLOBAL,_,f,d,"",!1))}}(e)}function Pt(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return["screens",e,"arrayVariables",t].concat(r)}function wt(e){return 4===e.length&&"arrayVariables"===e[2]||2===e.length&&"globalArrayList"===e[0]}function Tt(e,t,n,r,i,o){return At.apply(this,arguments)}function At(){return(At=Q.a(J.a.mark(function e(t,n,r,i,o,a){var c,s,l;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c={id:r,name:i,defaultValue:o,value:o},t===vt.i.GLOBAL?(s=ee.insertOp(["globalArrayList",a],c),te.a.applyClient(s)):(l=ee.insertOp(Pt(n,a),c),te.a.applyClient(l));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Bt(e,t,n){if(e===vt.i.GLOBAL){var r,i=null===(r=te.a.getDoc())||void 0===r?void 0:r.globalArrayList.findIndex(function(e){return e.id===n});if(void 0!==i){var o=ee.removeOp(["globalArrayList",i]);te.a.applyClient(o)}else console.error("can't find index of arrayVariable")}else{var a,c=null===(a=te.a.getDoc())||void 0===a?void 0:a.screens[t].arrayVariables.findIndex(function(e){return e.id===n});if(void 0!==c){var s=ee.removeOp(Pt(t,c));te.a.applyClient(s)}else console.error("can't find index of arrayVariable")}}function Rt(e,t,n,r,i){if(e===vt.i.GLOBAL){var o,a=null===(o=te.a.getDoc())||void 0===o?void 0:o.globalArrayList.findIndex(function(e){return e.id===n});if(void 0!==a){var c=ee.replaceOp(["globalArrayList",a,r],!0,i);te.a.applyClient(c)}}else{var s,l=null===(s=te.a.getDoc())||void 0===s?void 0:s.screens[t].arrayVariables.findIndex(function(e){return e.id===n});if(void 0!==l){var u=ee.replaceOp(Pt(t,l,r),!0,i);te.a.applyClient(u)}}}function jt(e){wt(e.path)&&function(e){var t,n=e.path;if("globalArrayList"!==n[0]){var r=n[1],i=n[3],o=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.screens[r].arrayVariables[i],a=null==o?void 0:o.id;a&&Ce.h(Ee.If(vt.i.SCREEN,a,r,!1))}else{var c,s=n[1],l=null===(c=te.a.getPreviousDoc())||void 0===c?void 0:c.globalArrayList[s],u=null==l?void 0:l.id;u&&Ce.h(Ee.If(vt.i.GLOBAL,u,"",!1))}}(e)}function St(e){var t;wt(e.path)&&function(e){var t=e.path,n=e.op.i,r=n.id,i=n.name,o=n.defaultValue;if("globalArrayList"!==t[0]){var a=t[3],c=t[1];Ce.h(Ee.of(vt.i.SCREEN,r,i,o,c,a,void 0,!1))}else{var s=t[1];Ce.h(Ee.of(vt.i.GLOBAL,r,i,o,"",s,void 0,!1))}}(e),(5===(t=e.path).length&&"arrayVariables"===t[2]||3===t.length&&"globalArrayList"===t[0])&&function(e){var t,n=e.path,r=e.op;if("globalArrayList"!==n[0]){var i=n[1],o=n[3],a=r.i,c=n[4],s=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.screens[i].arrayVariables[o],l=null==s?void 0:s.id;l&&Ce.h(Ee.yg(vt.i.SCREEN,l,c,a,i,!1))}else{var u,p=n[1],d=r.i,f=n[2],h=null===(u=te.a.getPreviousDoc())||void 0===u?void 0:u.globalArrayList[p],_=null==h?void 0:h.id;_&&Ce.h(Ee.yg(vt.i.GLOBAL,_,f,d,"",!1))}}(e)}function Dt(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return["screens",e,"objectVariables",t].concat(r)}function It(e){return 4===e.length&&"objectVariables"===e[2]||2===e.length&&"globalObjectList"===e[0]}function Lt(e,t,n,r,i,o){return xt.apply(this,arguments)}function xt(){return(xt=Q.a(J.a.mark(function e(t,n,r,i,o,a){var c,s,l;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c={id:r,name:i,defaultValue:o,value:o},t===vt.i.GLOBAL?(s=ee.insertOp(["globalObjectList",a],c),te.a.applyClient(s)):(l=ee.insertOp(Dt(n,a),c),te.a.applyClient(l));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ft(e,t,n){if(e===vt.i.GLOBAL){var r,i=null===(r=te.a.getDoc())||void 0===r?void 0:r.globalObjectList.findIndex(function(e){return e.id===n});if(void 0!==i){var o=ee.removeOp(["globalObjectList",i]);te.a.applyClient(o)}else console.error("can't find index of objectVariable")}else{var a,c=null===(a=te.a.getDoc())||void 0===a?void 0:a.screens[t].objectVariables.findIndex(function(e){return e.id===n});if(void 0!==c){var s=ee.removeOp(Dt(t,c));te.a.applyClient(s)}else console.error("can't find index of objectVariable")}}function Nt(e,t,n,r,i){if(e===vt.i.GLOBAL){var o,a=null===(o=te.a.getDoc())||void 0===o?void 0:o.globalObjectList.findIndex(function(e){return e.id===n});if(void 0!==a){var c=ee.replaceOp(["globalObjectList",a,r],!0,i);te.a.applyClient(c)}}else{var s,l=null===(s=te.a.getDoc())||void 0===s?void 0:s.screens[t].objectVariables.findIndex(function(e){return e.id===n});if(void 0!==l){var u=ee.replaceOp(Dt(t,l,r),!0,i);te.a.applyClient(u)}}}function Ht(e){It(e.path)&&function(e){var t,n=e.path;if("globalObjectList"!==n[0]){var r=n[1],i=n[3],o=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.screens[r].objectVariables[i],a=null==o?void 0:o.id;a&&Oe.a(Ee.Kf(vt.i.SCREEN,a,r,!1))}else{var c,s=n[1],l=null===(c=te.a.getPreviousDoc())||void 0===c?void 0:c.globalObjectList[s],u=null==l?void 0:l.id;u&&Oe.a(Ee.Kf(vt.i.GLOBAL,u,"",!1))}}(e)}function Mt(e){var t;It(e.path)&&function(e){var t=e.path,n=e.op.i,r=n.id,i=n.name,o=n.defaultValue;if("globalObjectList"!==t[0]){var a=t[3],c=t[1];Oe.a(Ee.tf({scopeType:vt.i.SCREEN,id:r,name:i,defaultValue:o,screenId:c,index:a,isEmitOT:!1}))}else{var s=t[1];Oe.a(Ee.tf({scopeType:vt.i.GLOBAL,id:r,name:i,defaultValue:o,screenId:"",index:s,isEmitOT:!1}))}}(e),(5===(t=e.path).length&&"objectVariables"===t[2]||3===t.length&&"globalObjectList"===t[0])&&function(e){var t,n=e.path,r=e.op;if("globalObjectList"!==n[0]){var i=n[1],o=n[3],a=r.i,c=n[4],s=null===(t=te.a.getPreviousDoc())||void 0===t?void 0:t.screens[i].objectVariables[o],l=null==s?void 0:s.id;l&&Oe.a(Ee.Gg({scopeType:vt.i.SCREEN,id:l,key:c,value:a,screenId:i,isEmitOT:!1}))}else{var u,p=n[1],d=r.i,f=n[2],h=null===(u=te.a.getPreviousDoc())||void 0===u?void 0:u.globalObjectList[p],_=null==h?void 0:h.id;_&&Oe.a(Ee.Gg({scopeType:vt.i.GLOBAL,id:_,key:f,value:d,screenId:"",isEmitOT:!1}))}}(e)}function Ut(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return["screens",e,"broadcasts",t].concat(r)}function Wt(e,t,n){return Vt.apply(this,arguments)}function Vt(){return(Vt=Q.a(J.a.mark(function e(t,n,r){var i;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=ee.insertOp(Ut(t,r),n),te.a.applyClient(i);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zt(e){}function Gt(e){var t;4===(t=e.path).length&&"broadcasts"===t[2]&&function(e){var t=e.path,n=e.op.i,r=t[3],i=t[1];Ce.h(Ee.pf(n,i,r,void 0,!1))}(e)}var Kt,Xt;const Yt=n(78698);function $t(e,t){var n,r=Ce.e(),i=Ce.a()||"";t||(e=vt.k,t="");var o={userId:r,path:{id:t,screenId:i,type:e}};null!==(n=te.a.client)&&void 0!==n&&n.emitCustomEvent({type:Kt.USER_FOCUS,data:o}),qt.runIntervalTask(o)}var Jt;(Jt=Kt||(Kt={})).USER_FOCUS="USER_FOCUS",Jt.CLOUD_DATABASE="CLOUD_DATABASE",Jt.USER_COLORS="USER_COLORS",function(e){e.CHANGE_NAME="CHANGE_NAME",e.ADD_DOC="ADD_DOC",e.INITIAL="INITIAL",e.REPLACE_DATA="REPLACE_DATA"}(Xt||(Xt={}));var qt=new(function(){function e(){G.a(this,e),this.intervalTime=1e4,this.currentUserFocusInfo=void 0,this.timeId=void 0,this.currentUserFocusInfo={userId:-1,path:{screenId:"",id:"",type:""}}}return K.a(e,[{key:"runIntervalTask",value:function(e){var t=this;this.currentUserFocusInfo=Yt.a({},e),this.timeId&&clearInterval(this.timeId),this.timeId=setInterval(function(){var e;t.currentUserFocusInfo.path.type!==vt.k&&null!==(e=te.a.client)&&void 0!==e&&e.emitCustomEvent({type:Kt.USER_FOCUS,data:t.currentUserFocusInfo})},this.intervalTime)}}]),e}());function Qt(e){var t;null!==(t=te.a.client)&&void 0!==t&&t.emitCustomEvent({type:Kt.USER_COLORS,data:e})}function Zt(e,t,n,r){var i;null!==(i=te.a.client)&&void 0!==i&&i.emitCustomEvent({type:Kt.CLOUD_DATABASE,data:{type:e,id:t,name:n,fields:r}})}const en=n(40605);function tn(e){e.type===Kt.USER_COLORS?Ce.h(en.t(e.data)):e.type===Kt.USER_FOCUS?Ce.h(en.m(e.data)):e.type===Kt.CLOUD_DATABASE&&function(e){var t=e.data,n=t.type,r=t.id,i=t.name;n===Xt.ADD_DOC&&r&&i&&Ce.h(Ee.af(r,i)),Xt.INITIAL}(e)}function nn(e){var t,n=null===(t=te.a.getDoc())||void 0===t?void 0:t.globalWidgetIds,r=0;return n&&(r=n.findIndex(function(t){return t===e}))<0&&(r=n.length),["globalWidgetIds",r]}function rn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return["globalWidgets",e].concat(n)}function on(e){return"globalWidgets"===e[0]}function an(e){return 2===e.length&&on(e)}function cn(e){return sn.apply(this,arguments)}function sn(){return(sn=Q.a(J.a.mark(function e(t){var n,r;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=ee.insertOp(rn(t.id),t),r=ee.insertOp(nn(t.id),t.id),te.a.applyClient(ee.type.compose(r,n));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ln(e){var t=ee.removeOp(nn(e)),n=ee.removeOp(rn(e));te.a.applyClient(ee.type.compose(t,n))}function un(e,t,n){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=te.a.getDoc();if(["size","position","visible","title","widgetIds"].includes(t)&&i){var a=rn(e,t);r=0===(o?Z.a({path:["$"].concat(q.a(a)),json:o}):[]).length?ee.insertOp(a,n):ee.replaceOp(a,!0,n)}else{var c=rn(e,"attributes",t);r=0===(o?Z.a({path:["$"].concat(q.a(c)),json:o}):[]).length?ee.insertOp(c,n):ee.replaceOp(c,!0,n)}te.a.applyClient(r)}const pn=n(3631),dn=n(68680);function fn(e){an(e.path)&&function(e){var t=e.path[1];t&&Ce.h(Ee.Mf(t,void 0,!1))}(e)}function hn(e){var t;an(e.path)&&function(e){_n.apply(this,arguments)}(e),2===(t=e.path).length&&function(e){return"globalWidgetIds"===e[0]}(t)&&e.path,function(e){return 4===e.length&&on(e)&&"attributes"===e[2]}(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[1],o=n[3];Ce.h(Ee.Lg(i,o,r,!1,!0,!1))}(e),function(e){return 3===e.length&&on(e)}(e.path)&&function(e){var t=e.op,n=e.path,r=t.i,i=n[1],o=n[2];"title"===o?Ce.h(Ee.Ng(i,r,!1,!0,!1)):Ce.h(Ee.Lg(i,o,r,!1,!0,!1))}(e)}function _n(){return(_n=Q.a(J.a.mark(function e(t){var n,r,i,o,a,c,s,l,u,p,d,f;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.op,r=n.i,!Pe.e(r.type)||ke.Db(r.type)){e.next=11;break}if(!(a=null===(i=te.a.getDoc())||void 0===i||null===(o=i.extensionWidgetList)||void 0===o?void 0:o.find(function(e){return e.type===r.type}))){e.next=11;break}return c=a.cdnUrl,s=a.id,Oe.a(Ee.zh({title:we.c(we.b,"ExtensionWidget.loading").toString(),cancelBtnVisible:!1,confirmBtnVisible:!1})),e.next=9,Te.u(c,s);case 9:(l=e.sent)&&(u=l.title,p=l.type,d=Pe.f(p,!0),Oe.a(Ee.Vg()),Oe.a(Ee.zh({title:we.c(we.b,"ExtensionWidget.finishRegistration",{title:u,type:d}).toString(),cancelBtnVisible:!1})));case 11:ke.Ub(r.id,r),Ce.h(Ee.hf(r.id)),r.type===pn.B||r.type===pn.y?(f=r.attributes.fields,Oe.a(Ee.bf(dn.a(r.type,{id:r.id,name:r.title,value:f,defaultValue:"no-use"},{isWatching:!1})))):r.type===pn.G&&Oe.a(Ee.bf(dn.a(pn.G,{id:r.id,name:r.title,value:r.attributes.db,defaultValue:"no-use"},{isWatching:!1})));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vn(e){return yn.apply(this,arguments)}function yn(){return(yn=Q.a(J.a.mark(function e(t){var n,r,i,o,a;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=null===(n=te.a.getDoc())||void 0===n?void 0:n.unsafeExtensionWidgetList)){e.next=3;break}return e.abrupt("return");case 3:-1!==(i=function(){for(var e=0;e<r.length;e++)if(r[e].type===t.type)return e;return-1}())?(o=ee.replaceOp(["unsafeExtensionWidgetList",i],!0,t),te.a.applyClient(o)):(a=ee.insertOp(["unsafeExtensionWidgetList",r.length],t),te.a.applyClient(a));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gn(e){return bn.apply(this,arguments)}function bn(){return(bn=Q.a(J.a.mark(function e(t){var n,r,i,o,a;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=null===(n=te.a.getDoc())||void 0===n?void 0:n.extensionWidgetList)){e.next=3;break}return e.abrupt("return");case 3:i=function(){for(var e=0;e<r.length;e++)if(r[e].type===t.type)return e;return-1}(),o={id:t.id,cdnUrl:t.cdnUrl,type:t.type,version:t.version||0},-1===i&&(a=ee.insertOp(["extensionWidgetList",r.length],o),te.a.applyClient(a));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}const mn=n(21052);function En(e){var t;2===(t=e.path).length&&"unsafeExtensionWidgetList"===t[0]&&function(e){kn.apply(this,arguments)}(e),function(e){2===e.length&&e[0]}(e.path)}function kn(){return(kn=Q.a(J.a.mark(function e(t){var n,r,i,o,a,c,s,l;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.path,n=t.op,!(r=n.i.code)){e.next=16;break}return Oe.a(Ee.zh({title:we.c(we.b,"ExtensionWidget.loading").toString(),cancelBtnVisible:!1,confirmBtnVisible:!1})),e.next=6,Te.r(r,!1);case 6:i=e.sent,o=i.types,a=i.widget,Te.v({types:o,widget:a}),c=o.title,s=o.type,l=Pe.f(s,!1),mn.a({type:s,types:o,code:r}),Oe.a(Ee.Rj()),Oe.a(Ee.Vg()),Oe.a(Ee.zh({title:we.c(we.b,"ExtensionWidget.finishRegistration",{title:c,type:l}).toString(),cancelBtnVisible:!1}));case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function On(e,t){var n,r,i=null===(n=te.a.getDoc())||void 0===n?void 0:n.cloudDictKeysList;r=(null==i?void 0:i[e])?ee.replaceOp(["cloudDictKeysList",e.toString()],!0,t):ee.insertOp(["cloudDictKeysList",e.toString()],t),te.a.applyClient(r)}function Cn(e,t){var n,r,i=null===(n=te.a.getDoc())||void 0===n?void 0:n.cloudTableColumnList;r=(null==i?void 0:i[e])?ee.replaceOp(["cloudTableColumnList",e.toString()],!0,t):ee.insertOp(["cloudTableColumnList",e.toString()],t),te.a.applyClient(r)}function Pn(e,t){var n,r,i=null===(n=te.a.getDoc())||void 0===n?void 0:n.cloudTableDataList;r=(null==i?void 0:i[e])?ee.replaceOp(["cloudTableDataList",e.toString()],!0,t):ee.insertOp(["cloudTableDataList",e.toString()],t),te.a.applyClient(r)}function wn(e){var t,n;n=(null===(t=te.a.getDoc())||void 0===t?void 0:t.cloudDictList)?ee.replaceOp(["cloudDictList"],!0,e):ee.insertOp(["cloudDictList"],e),te.a.applyClient(n)}function Tn(e){var t,n;n=(null===(t=te.a.getDoc())||void 0===t?void 0:t.cloudTableList)?ee.replaceOp(["cloudTableList"],!0,e):ee.insertOp(["cloudTableList"],e),te.a.applyClient(n)}function An(e){}function Bn(e,t){var n;2===(n=e.path).length&&"cloudDictKeysList"===n[0]&&function(e){var t=e.path,n=e.op,r=t[1],i=n.i;Ce.h(Ee.Ag(Number(r),i,!1))}(e),function(e){return 2===e.length&&"cloudTableColumnList"===e[0]}(e.path)&&function(e){var t=e.path,n=e.op,r=t[1],i=n.i;Ce.h(Ee.Dg(Number(r),i,!1))}(e),function(e){return 2===e.length&&"cloudTableDataList"===e[0]}(e.path)&&function(e){var t=e.path,n=e.op,r=t[1],i=n.i;Ce.h(Ee.Nj(Number(r),i))}(e),function(e){return 1===e.length&&"cloudDictList"===e[0]}(e.path)&&function(e){e.path;var t=e.op.i;Ce.h(Ee.Bg(t,!1))}(e),function(e){return 1===e.length&&"cloudTableList"===e[0]}(e.path)&&function(e){e.path;var t=e.op.i;Ce.h(Ee.Eg(t,!1))}(e)}var Rn=new(function(){function e(){G.a(this,e),this.projectOt=void 0,this.blink=void 0,this.widget=void 0,this.screen=void 0,this.imageFileList=void 0,this.soundFileList=void 0,this.iconFileList=void 0,this.primitiveVariables=void 0,this.arrayVariables=void 0,this.objectVariables=void 0,this.localStorage=void 0,this.focus=void 0,this.broadcasts=void 0,this.customEvent=void 0,this.globalWidget=void 0,this.extensionWidget=void 0,this.cloudSpace=void 0}return K.a(e,[{key:"init",value:function(){this.blink=Ie,this.widget=o,this.screen=p,this.imageFileList=h,this.soundFileList=y,this.iconFileList=m,this.primitiveVariables=O,this.arrayVariables=w,this.objectVariables=B,this.localStorage=localStorage,this.focus=z,this.broadcasts=S,this.projectOt=s,this.customEvent=I,this.globalWidget=F,this.extensionWidget=M,this.cloudSpace=V}},{key:"dispose",value:function(){var e=this;Object.keys(this).forEach(function(t){return e[t]=void 0})}}]),e}())},81403:(e,t)=>{var n={openServiceHost:"https://dev-open-service.codemao.cn",serverHost:"https://backend-dev.codemao.cn",apiOverseaServiceHost:"https://oversea-api.code.game",apiQiniuHost:"https://upload.qiniup.com/",pid:"7KeVbBdw",productCode:"appcraft",env:"dev",cdnPath:{root:"coco/",player:"coco/player/",playerUnstable:"coco/player/unstable"}};!function(){var e,t;switch(function(){var e=window.document.querySelector("meta[name=environment]");if(e){var t=e.getAttribute("content");if(t&&"__ENVIRONMENT__"!==t&&"undefined"!==t)return t}var n=window.location.hostname;return n.startsWith("dev")||"localhost"===n?"development":n.startsWith("test")?"test":n.startsWith("staging")?"staging":n.startsWith("press")?"press":"production"}()){case"press":case"pressure":case"test":e="test-",t="test";break;case"staging":e="staging-",t="staging";break;case"dev":case"development":e="dev-",t="dev";break;default:e="",t="prod"}n.openServiceHost="https://".concat(e,"open-service.codemao.cn"),n.serverHost="https://".concat(e,"api-creation.codemao.cn"),n.apiOverseaServiceHost="https://".concat(e,"oversea-api.code.game"),n.env=t}(),t.a=n},85552:(e,t,n)=>{var r;n.r(t),n.d(t,{a:()=>d,b:()=>g,c:()=>h,d:()=>v,default:()=>C,e:()=>k,f:()=>m,g:()=>f});const i=n(7452);var o,a,c=(a=(o=i)&&o.__esModule?function(){return o.default}:function(){return o},Object.defineProperty(a,"a",{enumerable:!0,get:a}),a);const s=n(78698),l=n(21009),u=n(3741);var p=n(83315).a.socketHost;function d(){var e={};if(r&&(r.authorization&&(e["x-coconut-authorization"]=r.authorization),r.device)){var t=r.device,n=t.groupId,i=t.platform,o=t.origin;e["X-CodeMao-Mobile-Requested"]=JSON.stringify({group_id:n,platform:i,origin:o})}return e}function f(e){r=e}function h(e,t,n){return _.apply(this,arguments)}function _(){return(_=l.a(c.a.mark(function e(t,n,r){var i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={room_name:t,work_id:n,user_limit:r},e.next=3,u.a.post(p+"/coconut/room",s.a({},i),{headers:d()});case 3:if((o=e.sent).data.success){e.next=6;break}throw new Error(o.data.msg);case 6:return e.abrupt("return",o.data.data);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=l.a(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:t},e.next=3,u.a.put(p+"/coconut/room/username",s.a({},n),{headers:d()});case 3:if((r=e.sent).data.success){e.next=6;break}throw new Error(r.data.msg);case 6:return e.abrupt("return",r.data.msg);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e){return b.apply(this,arguments)}function b(){return(b=l.a(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get(p+"/coconut/room/allow_join?id=".concat(t),{headers:d()});case 2:if((n=e.sent).data.success){e.next=5;break}throw new Error(n.data.msg);case 5:return e.abrupt("return",n.data.data);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e){return E.apply(this,arguments)}function E(){return(E=l.a(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get(p+"/coconut/room/users?id=".concat(t),{headers:d()});case 2:if((n=e.sent).data.success){e.next=5;break}throw new Error(n.data.msg);case 5:return e.abrupt("return",n.data.data);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(e){return O.apply(this,arguments)}function O(){return(O=l.a(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get(p+"/coconut/room?work_id=".concat(t),{headers:d()});case 2:if((n=e.sent).data.success){e.next=5;break}throw new Error(n.data.msg);case 5:return e.abrupt("return",n.data.data);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}const C=d},92004:(e,t,n)=>{n.r(t),n.d(t,{a:()=>d,b:()=>a,c:()=>p,d:()=>l,default:()=>f,e:()=>c,f:()=>s,g:()=>u});const r=n(48096),i=n(54176),o=n(75083);function a(e){for(var t=[],n=[],o=[],a=[{path:[],op:e}],c=[];0!==a.length&&null!=a[0].op;){var s=0;for(s=0;s<a.length;s++){var l=a[s],u=i.a(l.path),p=l.op,d=0,f=function(){var e=p[d];if("string"==typeof e||"number"==typeof e)u.push(e);else if(Array.isArray(e))c.push({path:u.slice(0),op:e});else if("object"==typeof e){var i=u.slice(0);Object.keys(e).forEach(function(a){if("p"===a||"r"===a)t.push({path:i.slice(0),op:r.a({},a,e[a])});else if("i"===a||"d"===a)n.push({path:i.slice(0),op:r.a({},a,e[a])});else{if("es"!==a&&"ena"!==a)throw Error("new operation. pls add it ");o.push({path:i.slice(0),op:r.a({},a,e[a])})}})}};for(d=0;d<p.length;d++)f();u=[]}a=c,c=[]}return{picks:t,drops:n,edits:o}}function c(e){return"i"in e}function s(e){return"p"in e}function l(e){return"d"in e}function u(e){return"r"in e}function p(e){return Array.isArray(e)&&e.length>1&&Array.isArray(e[0])}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length>1?t.reduce(function(e,t){return o.type.compose(e,t)}):t[0]}const f=d},92808:e=>{e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},96041:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalCommentPlugin=void 0;var r=n(31635),i=(0,r.__importStar)(n(31132)),o=n(3672),a=n(86865),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.before_handle_event_group=function(e){for(var t=new Map,n=0;n<e.length;){var r=e[n];if(r.type!==i.BlockEventType.CREATE){if(r.type===i.BlockEventType.CHANGE){var o=r.get_new_value();if("comment_expand"!==r.element||"boolean"!=typeof o){n++;continue}s=r.get_block_id();var a=t.get(s);if(void 0!==a){(c=e[a].get_element_json()).comments[s].pinned=o,e.splice(n,1);continue}}n++}else{var c,s=r.get_block_id();(c=r.get_element_json()).comments[s]&&null===c.comments[s].parent_id&&t.set(s,n),n++}}},(0,r.__decorate)([(0,o.lazy_inject)(a.BINDING.json)],t.prototype,"json",void 0),t}(n(8406).j);t.GlobalCommentPlugin=c}}]);