"use strict";(self.webpackChunkcoco_next=self.webpackChunkcoco_next||[]).push([[7890],{41267:e=>{e.exports="https://creation.codemao.cn/coco/home/dist/asset/search_0e148.png"},46259:e=>{e.exports="https://creation.codemao.cn/coco/home/dist/asset/empty_17253.png"},77939:e=>{e.exports={work:"work_vTtGt",content:"content_23HoB",workContent:"workContent_2TPph",loginBox:"loginBox_3f2Qy",image:"image_2w5h6",loginTips:"loginTips_1gap4",loginBtn:"loginBtn_2BbK7",createBox:"createBox_u--86",createItem:"createItem_2RzIk",createIcon:"createIcon_1_8kW",disabled:"disabled_2Cuak",tips:"tips_104GA",userWorkBox:"userWorkBox_1CWXt",workList:"workList_3hQHC",noData:"noData_2xEbF",oldUser:"oldUser_3JWDk",noWorkTips:"noWorkTips_1g6WT",searchTips:"searchTips_JEhNj",createBtn:"createBtn_2YrUr",icon:"icon_7P9Rn",workCategory:"workCategory_3DvgF",workType:"workType_2Bw2Q",typeItem:"typeItem_18xio",active:"active_303_X",searchBox:"searchBox_3rBJG",searchInput:"searchInput_OGRBW",recoverBtn:"recoverBtn_3Zn2x",templateBox:"templateBox_vg5G7",notLogin:"notLogin_23kfG",titleBox:"titleBox_3Gn98",templateTitle:"templateTitle_3fguU",title:"title_262ud",titleIcon:"titleIcon_2TWmT",pageBtn:"pageBtn_34nkk",btnItem:"btnItem_3fOsw",prev:"prev_1G3gE",templateList:"templateList_1l5Ed",recoverHeader:"recoverHeader_3BCat",backBox:"backBox_2PuUx",back:"back_2OaYV",clearRecoverBtn:"clearRecoverBtn_2b4DY",recoverNoData:"recoverNoData_b2fEi",recoverList:"recoverList_1o8Oq"}},95509:(e,t,o)=>{o.r(t),o.d(t,{default:()=>C});var r=o(69733),n=o(14644),l=o(96540),a=o(72407),i=o(46942),c=o.n(i),s=o(68064),m=o(43005),p=o(63011),d=o(61928),h=o(38099),u=o(62012),k=o(77939),f=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.isCompositionEnd=!0,o.state={workType:s.L.CREATE,recoverVisible:!1,keyword:""},o.handleLogin=o.handleLogin.bind(o),o.handleCreateScroll=o.handleCreateScroll.bind(o),o.handleCollScroll=o.handleCollScroll.bind(o),o.handleDeleteScroll=o.handleDeleteScroll.bind(o),o.handleSwitchWorkType=o.handleSwitchWorkType.bind(o),o.handleCompositionStart=o.handleCompositionStart.bind(o),o.handleCompositionEnd=o.handleCompositionEnd.bind(o),o.handleInputChange=o.handleInputChange.bind(o),o.handleClearInput=o.handleClearInput.bind(o),o.handleToggleRecoverVisible=o.handleToggleRecoverVisible.bind(o),o.handleClearDeletedWork=o.handleClearDeletedWork.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this.state.keyword,t=this.props.userInfo;t&&!t.isNewUser&&(this.props.getCreateWorkListAction({name:e,offset:0}),this.props.getCollWorkListAction({name:e,offset:1}))}},{key:"componentDidUpdate",value:function(e,t){}},{key:"handleLogin",value:function(){this.props.setSignDialogVisibleAction(!0)}},{key:"handleSwitchWorkType",value:function(e){var t=this.props.userInfo,o=this.state.keyword;this.setState({workType:e}),t&&!t.isNewUser&&(this.props.getCreateWorkListAction({name:o,offset:0}),this.props.getCollWorkListAction({name:o,offset:1}))}},{key:"handleInputChange",value:function(e){var t=this.props.userInfo;this.setState({keyword:e}),this.isCompositionEnd&&t&&!t.isNewUser&&(this.state.workType===s.L.CREATE?this.props.getCreateWorkListAction({name:e,offset:0}):this.props.getCollWorkListAction({name:e,offset:1}))}},{key:"handleClearInput",value:function(){this.handleInputChange("")}},{key:"handleCompositionStart",value:function(){this.isCompositionEnd=!1}},{key:"handleCompositionEnd",value:function(){this.isCompositionEnd=!0,this.handleInputChange(this.state.keyword)}},{key:"handleToggleRecoverVisible",value:function(e){e&&this.props.getDeleteWorkListAction({offset:0}),this.setState({recoverVisible:e})}},{key:"handleNavToCocoEditor",value:function(){var e=u.$().cocoEditorUrl;window.open(e,Date.now().toString())}},{key:"handleClearDeletedWork",value:function(){0!==this.props.deleteWorkList.length&&this.props.setConfirmDialogInfoAction({visible:!0,isDangerous:!0,content:"清空回收站所有作品，删除后无法恢复。",onConfirm:this.props.clearDeletedWorkAction})}},{key:"prevTemplate",value:function(){this.templateListRef.scrollBy({left:-960,behavior:"smooth"})}},{key:"nextTemplate",value:function(){this.templateListRef.scrollBy({left:960,behavior:"smooth"})}},{key:"handleCreateScroll",value:function(e){var t=this,o=this.props,r=o.createWorkOffset,n=o.createWorkIsLoaded,l=this.state.keyword;if(!n){this.scroll_clock&&clearTimeout(this.scroll_clock);var a=e.target;this.scroll_clock=setTimeout(function(){var e=a.clientHeight,o=a.scrollHeight,n=a.scrollTop,i=o-n;Math.abs(i-e)<800&&n&&t.props.getCreateWorkListAction({name:l,offset:r+1})},100)}}},{key:"handleCollScroll",value:function(e){var t=this,o=this.props,r=o.collWorkOffset,n=o.collWorkIsLoaded,l=this.state.keyword;if(!n){this.scroll_clock&&clearTimeout(this.scroll_clock);var a=e.target;this.scroll_clock=setTimeout(function(){var e=a.clientHeight,o=a.scrollHeight,n=a.scrollTop,i=o-n;Math.abs(i-e)<800&&n&&t.props.getCollWorkListAction({name:l,offset:r+1})},100)}}},{key:"handleDeleteScroll",value:function(e){var t=this,o=this.props,r=o.deleteWorkOffset;if(!o.deleteWorkIsLoaded){this.scroll_clock&&clearTimeout(this.scroll_clock);var n=e.target;this.scroll_clock=setTimeout(function(){var e=n.clientHeight,o=n.scrollHeight,l=n.scrollTop,a=o-l;Math.abs(a-e)<800&&l&&t.props.getDeleteWorkListAction({offset:r+1})},100)}}},{key:"renderWorkFilter",value:function(){var e=this,t=this.state,o=t.workType,r=t.keyword;return l.createElement("div",{styleName:"workCategory"},l.createElement("div",{styleName:"workType"},l.createElement("div",{onClick:function(){return e.handleSwitchWorkType(s.L.CREATE)},styleName:c()("typeItem",o===s.L.CREATE&&"active")},"我创建的"),l.createElement("div",{onClick:function(){return e.handleSwitchWorkType(s.L.COLL)},styleName:c()("typeItem",o===s.L.COLL&&"active")},"我参与的")),l.createElement("div",{styleName:"searchBox"},o===s.L.CREATE&&l.createElement(h.A,{value:r,ref:function(t){return e.keywordRef=t},onClearCallback:this.handleClearInput,styleName:"searchInput",placeholder:"搜索作品",onChange:this.handleInputChange,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,clearButtonVisible:!!r,before:l.createElement(d.A,{type:"icon-search"})}),l.createElement("div",{styleName:"recoverBtn",onClick:function(){return e.handleToggleRecoverVisible(!0)}},l.createElement(d.A,{type:"icon-deleted",styleName:"icon"}),"回收站")))}},{key:"renderTemplate",value:function(){var e=this,t=this.props,o=t.templateList,r=t.userInfo;return l.createElement("div",{styleName:c()("templateBox",!r&&"notLogin")},l.createElement("div",{styleName:"titleBox"},l.createElement("div",{styleName:"templateTitle"},l.createElement(d.A,{type:"icon-template",styleName:"titleIcon"}),l.createElement("h2",{styleName:"title"},"从模版开始探索")),l.createElement("div",{styleName:"pageBtn"},l.createElement("div",{styleName:c()("btnItem"),onClick:function(){return e.prevTemplate()}},l.createElement(d.A,{type:"icon-next",styleName:"prev"})),l.createElement("div",{styleName:"btnItem",onClick:function(){return e.nextTemplate()}},l.createElement(d.A,{type:"icon-next"})))),l.createElement("div",{styleName:"templateList",ref:function(t){return e.templateListRef=t}},o.map(function(e){return l.createElement(p.A,{key:e.id,item:e})})))}},{key:"renderUserContent",value:function(){var e=this,t=this.state,r=t.workType,n=t.keyword,a=this.props,i=a.createWorkList,p=a.collWorkList,h=a.userInfo;return i.forEach(function(e){return e.role=1}),p.forEach(function(e){return e.role=2}),l.createElement(l.Fragment,null,l.createElement("div",{styleName:"userWorkBox"},this.renderWorkFilter(),r===s.L.CREATE&&l.createElement(l.Fragment,null,i.length>0&&l.createElement("div",{styleName:"workList",onScroll:this.handleCreateScroll},i.map(function(t){return l.createElement(m.A,{key:t.work_id,item:t,workType:s.L.CREATE,callback:function(){return e.props.getCreateWorkListAction(n)}})})),0==i.length&&l.createElement("div",{styleName:c()("noData",h&&!h.isNewUser&&"oldUser")},n&&l.createElement(l.Fragment,null,l.createElement("img",{src:o(41267),alt:""}),l.createElement("span",{styleName:"searchTips"},"没有找到作品，换个姿势再搜索一次吧～")),!n&&l.createElement(l.Fragment,null,l.createElement("img",{src:o(46259),styleName:"image",alt:""}),l.createElement("span",{styleName:"noWorkTips"},"你还未创作任何作品"),l.createElement("div",{styleName:"createBtn",onClick:this.handleNavToCocoEditor},"去创作 ",l.createElement(d.A,{type:"icon-button-arrow",styleName:"icon"}))))),r===s.L.COLL&&l.createElement(l.Fragment,null,p.length>0&&l.createElement("div",{styleName:"workList",onScroll:this.handleCollScroll},p.map(function(t){return l.createElement(m.A,{key:t.work_id,item:t,workType:s.L.COLL,callback:function(){return e.props.getCollWorkListAction(n)}})})),0==p.length&&l.createElement("div",{styleName:c()("noData",h&&!h.isNewUser&&"oldUser")},n&&l.createElement(l.Fragment,null,l.createElement("img",{src:o(41267),alt:""}),l.createElement("span",{styleName:"searchTips"},"没有找到作品，换个姿势再搜索一次吧～")),!n&&l.createElement(l.Fragment,null,l.createElement("img",{src:o(46259),styleName:"image",alt:""}),l.createElement("span",{styleName:"noWorkTips"},"你还没有任何协作作品"))))),h&&h.isNewUser&&this.renderTemplate())}},{key:"renderRecover",value:function(){var e=this,t=this.state,o=t.workType,r=t.keyword,n=this.props.deleteWorkList;return l.createElement("div",{styleName:"content"},l.createElement("div",{styleName:"recoverHeader"},l.createElement("div",{styleName:"backBox"},l.createElement("div",{styleName:"back",onClick:function(){return e.handleToggleRecoverVisible(!1)}},l.createElement(d.A,{type:"icon-next",styleName:"icon"}),"返回"),l.createElement("div",{styleName:"title"},"回收站")),l.createElement("div",{styleName:c()("clearRecoverBtn",0===n.length&&"disabled"),onClick:this.handleClearDeletedWork},l.createElement(d.A,{type:"icon-clear",styleName:"icon"}),"清空当前回收站")),0===n.length&&l.createElement("div",{styleName:"recoverNoData"},"空空如也～"),n.length>0&&l.createElement("div",{styleName:"recoverList",onScroll:this.handleDeleteScroll},n.map(function(t){return l.createElement(m.A,{key:t.work_id,item:t,workType:s.L.DELETE,callback:function(){o===s.L.CREATE?e.props.getCreateWorkListAction({name:r,offset:0}):e.props.getCollWorkListAction({name:r,offset:1})}})})))}},{key:"render",value:function(){var e=this.state.recoverVisible,t=this.props,r=t.userInfo;return t.userInfoFetchDone?e?l.createElement("div",{styleName:"work"},this.renderRecover()):l.createElement("div",{styleName:"work"},r&&!r.isNewUser&&l.createElement("div",{styleName:"createBox"},l.createElement("div",{styleName:"createItem",onClick:this.handleNavToCocoEditor},l.createElement(d.A,{type:"icon-create-app",styleName:"createIcon"}),"应用创作"),l.createElement("div",{styleName:c()("createItem","disabled")},l.createElement(d.A,{type:"icon-create-web",styleName:"createIcon"}),"网页搭建",l.createElement("span",{styleName:"tips"},"（敬请期待）"))),!r&&l.createElement(l.Fragment,null,l.createElement("div",{styleName:"loginBox"},l.createElement("img",{src:o(46259),styleName:"image",alt:""}),l.createElement("span",{styleName:"loginTips"},"你还未登录账号"),l.createElement("div",{styleName:"loginBtn",onClick:this.handleLogin},"去登录")),this.renderTemplate()),r&&l.createElement("div",{styleName:"workContent"},this.renderUserContent())):null}}]),t}(l.Component);v=function(e,t,o,r){var n,l=arguments.length,a=l<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===("undefined"==typeof Reflect?"undefined":y(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(a=(l<3?n(a):l>3?n(t,o,a):n(t,o))||a);return l>3&&a&&Object.defineProperty(t,o,a),a}([a(k,{allowMultiple:!0})],v);var g=o(7195),E=o(85030);const C=r.Ng(function(e){return{userInfo:e.main_reducer.userInfo,userInfoFetchDone:e.main_reducer.userInfoFetchDone,templateList:e.home_reducer.templateList,createWorkOffset:e.work_reducer.createWorkOffset,createWorkIsLoaded:e.work_reducer.createWorkIsLoaded,createWorkList:e.work_reducer.createWorkList,collWorkOffset:e.work_reducer.collWorkOffset,collWorkIsLoaded:e.work_reducer.createWorkIsLoaded,collWorkList:e.work_reducer.collWorkList,deleteWorkOffset:e.work_reducer.deleteWorkOffset,deleteWorkIsLoaded:e.work_reducer.deleteWorkIsLoaded,deleteWorkList:e.work_reducer.deleteWorkList}},function(e){return n.zH({getCreateWorkListAction:g.Q$,getCollWorkListAction:g._X,getDeleteWorkListAction:g.lV,clearDeletedWorkAction:g.eW,setSignDialogVisibleAction:E.e$,setConfirmDialogInfoAction:E.fo},e)})(v)}}]);