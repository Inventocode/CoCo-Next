"use strict";(self.webpackChunkcoco_next=self.webpackChunkcoco_next||[]).push([["828"],{28388(e,t,n){n.d(t,{_t:()=>h,bt:()=>k,vt:()=>N,yt:()=>C});var a,r=n(90787),c=n(49736),o=n(33383),i=n(52301),l=n(33007),s=n(46942),u=n.n(s),m=n(95644),d=n(22827),f=n(451),p=n(19040),v=n(41594),E=n.n(v),g=n(55874),y=n.n(g),b=function(){var e=(0,p.useSelector)(function(e){return e.oTState.userFocusOTInfoList}),t=(0,p.useSelector)(function(e){return e.oTState.cooperationUserList}),n=(0,p.useSelector)(function(e){return e.oTState.onlineCooperationUserColorRecord}),r=m.a().formatMessage,o=(0,v.useState)([]),i=f.a(o,2),l=i[0],s=i[1],u=(0,v.useState)({left:0,top:0}),d=f.a(u,2),g=d[0],b=d[1],h=(0,v.useState)(!1),N=f.a(h,2),k=N[0],C=N[1];return(0,v.useEffect)(function(){var n=function(n){C(!1),a&&clearTimeout(a);var r,c=(null==(r=n.target.closest(".otFocusElement"))?void 0:r.id)||function(e){var t=e.target;if(t instanceof SVGElement){var n=t.closest(".focusSvgClassName");return null==n?void 0:n.dataset.focusId}}(n);c&&(a&&clearTimeout(a),a=setTimeout(function(){var a=e.filter(function(e){return e.path.id===c});b({left:n.clientX+20,top:n.clientY+20}),C(!0),s(t.filter(function(e){return a.some(function(t){return t.userId===e.id})}).toJSON())},1e3))};return document.body.addEventListener("mousemove",n),function(){document.body.removeEventListener("mousemove",n)}}),0===l.length?E().createElement(E().Fragment,null):E().createElement("div",{style:{display:k?"block":"none",position:"fixed",left:g.left,top:g.top,backgroundColor:1===l.length?n.get(l[0].id):c.a},className:y().userFocusCard},l.length>1?E().createElement("div",{className:y().item},l.map(function(e,t){return E().createElement("div",{key:t,className:y().headPhoto,style:{zIndex:l.length-t,backgroundImage:'url("'.concat(e.avatar_url,'")'),borderColor:n.get(e.id)}})}),E().createElement("span",{className:y().nickname},l.length," ",r({id:"OT.collPeopleCount"}))):E().createElement("div",{key:l[0].id,className:y().item},E().createElement("div",{className:y().headPhoto,style:{backgroundImage:'url("'.concat(l[0].avatar_url,'")'),borderColor:n.get(l[0].id)}}),E().createElement("div",{className:y().nickname},l[0].nickname)))},h=E().memo(function(){var e=(0,p.useSelector)(function(e){return e.oTState.userFocusOTInfoList}),t=(0,p.useSelector)(function(e){return e.oTState.onlineCooperationUserColorRecord}),n=e.filter(function(e){return"block"===e.path.type}).toJSON();return(0,v.useEffect)(function(){var n=e.filter(function(e){return"dynamicData"===e.path.type||"widget"===e.path.type}).toJSON();if(document.querySelectorAll(".otFocusElement").forEach(function(e){var t=e.querySelector(".otFocusElementBorder");null!=t&&t.remove(),e.classList.remove("otFocusElement")}),n&&n.length>0){var a=(0,r.lt)(n,t.toJSON());n.forEach(function(e){var t=document.getElementById(e.path.id);if(t&&!t.classList.contains("otFocusElement")){var n=document.createElement("div");n.setAttribute("data-html2canvas-ignore","true"),n.classList.add("otFocusElementBorder"),n.style.borderColor=a[e.userId],t.classList.add("otFocusElement"),t.appendChild(n)}})}},[t,e]),E().createElement(E().Fragment,null,E().createElement(r.ft,{list:n}),E().createElement(b,null))}),N=function(e){var t=e.visible,n=e.onClose,a=m.a().formatMessage;return E().createElement(l.f,{className:y().invalidUrlDialog,visible:t,onClose:n},E().createElement("h3",null,a({id:"OT.urlIsInvalid"})),E().createElement("p",null,a({id:"OT.urlIsInvalidDetail"})),E().createElement(l.d,{type:"primary",onClick:n},a({id:"know"})))},k=function(e){var t=e.visible,n=m.a().formatMessage;return E().createElement(l.f,{className:y().loadingDialog,visible:t,showCloseButton:!1},E().createElement("div",{className:y().icon},E().createElement(l.j,{type:"icon-loading2"})),E().createElement("p",null,n({id:"OT.isBuildingCollWork"})))},C=E().memo(function(){var e=(0,p.useSelector)(function(e){return e.oTState.onlineCooperationUserList}).toJSON(),t=(0,p.useSelector)(function(e){return e.oTState.onlineCooperationUserColorRecord}),n=o.q(e).reverse();return E().createElement("div",{className:y().users},n.map(function(e,n){return n+1>3?null:E().createElement("div",{className:u()(y().headerPhotoBorder,y().user),key:e.id,style:{borderColor:t.get(e.id)}},E().createElement(d.a,{placement:"bottom",title:e.nickname},E().createElement("div",{className:y().headPhoto,style:{backgroundImage:'url("'.concat(e.avatar_url,'")')}})))}),n.length>3&&E().createElement(i.a,{overlayClassName:y().avatarPopover,content:E().createElement("div",{className:y().avatarContent},n.map(function(e){return E().createElement("div",{key:e.id,className:y().avatarItem},E().createElement("div",{className:u()(y().headerPhotoBorder,y().user),key:e.id,style:{borderColor:t.get(e.id)}},E().createElement(d.a,{placement:"bottom",title:e.nickname},E().createElement("div",{className:y().headPhoto,style:{backgroundImage:'url("'.concat(e.avatar_url,'")')}}))),E().createElement("div",{className:y().itemName},e.nickname))}))},E().createElement("div",{className:u()(y().count,y().user)},E().createElement("div",{className:y().countPhoto},n.length))))})},16361(e,t,n){n.d(t,{AC:()=>C,IC:()=>w,SC:()=>k,jC:()=>I});var a=n(39029),r=n(52301),c=n(33007),o=n(46942),i=n.n(o),l=n(451),s=n(34221),u=n(7452),m=n.n(u),d=n(19040),f=n(41594),p=n.n(f),v=n(85036),E=n.n(v),g="64a70012-f691-4b93-a6f4-0968f5b648f8",y="64a70011-f691-4b93-a6f4-0968f5b648f8",b={filters:[{name:"Kano-wand"},{namePrefix:"Kano"}],optionalServices:[g,y]},h=null;function N(){return(N=s.a(m().mark(function e(t,n){var a,r,c,o,i,l,u,d;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPrimaryService(y);case 2:return a=e.sent,e.next=5,a.getCharacteristic("64a70002-f691-4b93-a6f4-0968f5b648f8");case 5:return r=e.sent,e.next=8,t.getPrimaryService(g);case 8:return c=e.sent,e.next=11,c.getCharacteristic("64a7000d-f691-4b93-a6f4-0968f5b648f8");case 11:return o=e.sent,e.next=14,c.getCharacteristic("64a7000f-f691-4b93-a6f4-0968f5b648f8");case 14:return i=e.sent,l=0,u=[],r.addEventListener("characteristicvaluechanged",function(e){var t=e.target.value,a=t.getInt16(0,!0),r=-1*t.getInt16(2,!0);n(r,a),l?u.push({x:r,y:a}):u.length>0&&(localStorage.setItem("kanoData",JSON.stringify(u)),u.length=0)}),o.addEventListener("characteristicvaluechanged",function(e){l=e.target.value.getUint8(0)}),d=window.setInterval(s.a(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.writeValue(Uint8Array.from([255])).catch(function(e){console.error(e),window.clearInterval(d)});case 2:case"end":return e.stop()}},e)})),1e4),e.next=22,r.startNotifications();case 22:return e.next=24,o.startNotifications();case 24:return e.abrupt("return",s.a(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("clearInterval "),window.clearInterval(d),e.next=4,r.stopNotifications();case 4:return e.next=6,o.stopNotifications();case 6:case"end":return e.stop()}},e)})));case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}var k=(0,f.memo)(function(e){var t,n=e.keyName,o=void 0===n?"device":n,u=e.getValue,v=e.onChange,g=(0,f.useState)(!1),k=l.a(g,2),C=k[0],w=k[1],I=(0,f.useState)(!1),S=l.a(I,2),x=S[0],L=S[1],_=(0,f.useState)(0),T=l.a(_,2),A=T[0],O=T[1],D=(0,f.useState)(0),B=l.a(D,2),j=B[0],R=B[1],P=(0,f.useState)(0),V=l.a(P,2),W=V[0],M=V[1],z=(0,f.useRef)(),G=(0,f.useRef)(),F=(0,d.useSelector)(function(e){return e.project.playing}),U=u(o);function H(){return(H=s.a(m().mark(function e(){var t,n,a,r;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,L(!0),e.next=6,navigator.bluetooth.requestDevice(b);case 6:return h=e.sent,e.next=9,null==(t=h.gatt)?void 0:t.connect();case 9:z.current=a=e.sent,M(r=Date.now()),h.addEventListener("gattserverdisconnected",s.a(m().mark(function e(){var t,n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("gattserverdisconnected:",null==(t=a)?void 0:t.connected),console.info("keep alive seconds:",(Date.now()-r)/1e3),e.next=4,null==(n=a)?void 0:n.connect().catch(function(){var e=s.a(m().mark(function e(t){var n,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,null==(n=h)||null==(c=n.gatt)?void 0:c.connect();case 3:a=e.sent,M(r=Date.now());case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:M(r=Date.now()),console.info("connected",a);case 7:case"end":return e.stop()}},e)}))),v&&v(o,(null==(n=h)?void 0:n.name)||""),L(!1),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(2),console.error(e.t0),L(!1);case 22:case"end":return e.stop()}},e,null,[[2,18]])}))).apply(this,arguments)}(0,f.useEffect)(function(){s.a(m().mark(function e(){var t,n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=z.current,!(n=G.current)){e.next=6;break}return e.next=5,n().catch(function(e){return console.error(e)});case 5:G.current=void 0;case 6:if(!t){e.next=12;break}return e.next=9,function(e,t){return N.apply(this,arguments)}(t,function(e,t){O(e),R(t),F&&(localStorage.setItem("kanoX","".concat(e)),localStorage.setItem("kanoY","".concat(t)))});case 9:G.current=e.sent,e.next=13;break;case 12:v("device","");case 13:case"end":return e.stop()}},e)}))()},[W]);var Y=(t=s.a(m().mark(function e(){var t,n,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=z.current)?void 0:t.getPrimaryService(y);case 2:return n=e.sent,e.next=5,null==n?void 0:n.getCharacteristic("64a70004-f691-4b93-a6f4-0968f5b648f8");case 5:null!=(a=e.sent)&&a.writeValue(Uint8Array.from([1])).catch(function(e){console.error(e)});case 7:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});return p().createElement(c.i,{align:"vertical",className:i()(E().formItemWrapper,E().bluetoothConnect,U&&E().connected),label:U?"已连接":"设备未连接"},U?p().createElement(p().Fragment,null,p().createElement("div",{className:E().device},U),p().createElement("div",{className:E().position},p().createElement("span",null,"X: ",A),p().createElement("span",null,"Y: ",j)),p().createElement("div",{className:E().moreBox},p().createElement(r.a,{content:p().createElement("div",{className:E().popoverBox},p().createElement("div",{className:E().popoverItem,onClick:Y},"重置坐标"),p().createElement("div",{className:E().popoverItem,onClick:function(){var e;if(w(!1),v&&v(o,""),null==(e=h)?void 0:e.gatt)try{h.gatt.disconnect()}catch(e){console.error(e)}}},"断开连接")),placement:"bottomLeft",trigger:"click",visible:C,onVisibleChange:function(e){w(e)}},p().createElement("div",{className:E().more},p().createElement(c.j,{type:"icon-more"}))))):p().createElement("div",{className:i()(E().connect,x&&E().connecting),onClick:function(){return H.apply(this,arguments)}},p().createElement("span",{className:E().icon},p().createElement(a.Ge,{stroke:"#847da4"})),p().createElement("span",{className:E().text},"连接")))}),C="9326741751927357445c6b5a",w="h14qlzk7z9zx8xlgcyu9tvrz9i845295";function I(){var e=new URL("https://open-cn.aqara.com/v3.0/open/authorize");e.searchParams.set("redirect_uri",new URL("/editor",window.location.origin).toString()),e.searchParams.set("client_id",C),e.searchParams.set("response_type","code"),e.searchParams.set("state","browser"),window.open(e.toString(),"_blank")}},75661(e,t,n){n.d(t,{HC:()=>ey});var a=n(7306),r=n(39029),c=n(83823),o=n(44800),i=n(85365),l=n(78142),s=n(67356),u=n(6779),m=n(48390),d=n(53405),f=n(8039),p=n(88991),v=n(47962),E=n(84129),g=n(80676),y=n(43075),b=n(92759),h=n(81480),N=n(62873),k=n(60402),C=n(66323),w=n(21076),I=n(66421),S=n(70590),x=n(6351),L=n(84440),_=n(89925),T=n(54788),A=n(65603),O=n(35490),D=n(3529),B=n(70552),j=n(10119),R=n(22624),P=n(50813),V=n(16361),W=n(13719),M=n.n(W),z=n(51877),G=n(33007),F=n(46942),U=n.n(F),H=n(451),Y=n(34221),J=n(7452),K=n.n(J),q=n(19040),Z=n(41594),X=n.n(Z),Q=n(45304),$=n.n(Q);function ee(){return localStorage.getItem("lvmi_access_token")}function et(){return en.apply(this,arguments)}function en(){return(en=Y.a(K().mark(function e(){var t;return K().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<30)){e.next=15;break}if(e.prev=2,!ee()){e.next=5;break}return e.abrupt("return");case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.warn(e.t0);case 10:return e.next=12,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){return setTimeout(t,e)})}(2e3);case 12:t++,e.next=1;break;case 15:throw Error("timeout");case 16:case"end":return e.stop()}},e,null,[[2,7]])}))).apply(this,arguments)}function ea(){return(ea=Y.a(K().mark(function e(){var t,n;return K().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("lvmi_refresh_token"),e.next=3,M().post("https://open-cn.aqara.com/v3.0/open/access_token?client_id=".concat(V.AC,"&client_secret=").concat(V.IC,"&redirect_uri=&grant_type=refresh_token&refresh_token=").concat(t),{},{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 3:if(!(n=e.sent).data.access_token){e.next=9;break}localStorage.setItem("lvmi_access_token",n.data.access_token),localStorage.setItem("lvmi_refresh_token",n.data.refresh_token),e.next=13;break;case 9:return localStorage.removeItem("lvmi_access_token"),(0,V.jC)(),e.next=13,et();case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var er=(0,Z.memo)(function(e){var t=(0,q.useDispatch)(),n=e.keyName,a=void 0===n?"token":n,c=e.getValue,o=e.onChange,i=(0,Z.useState)(!1),l=H.a(i,2),s=l[0],u=l[1],m=c(a);function d(){return(d=Y.a(K().mark(function e(){return K().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,u(!0),ee()){e.next=10;break}return(0,V.jC)(),e.next=8,et();case 8:e.next=12;break;case 10:return e.next=12,function(){return ea.apply(this,arguments)}();case 12:o&&o(a,localStorage.getItem("lvmi_access_token")),u(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0),u(!1);case 20:case"end":return e.stop()}},e,null,[[2,16]])}))).apply(this,arguments)}function f(){return(f=Y.a(K().mark(function e(){return K().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o&&o(a,""),t(z.mj({message:"已取消授权",type:"info"}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}return X().createElement(G.i,{align:"vertical",className:U()($().formItemWrapper,$().aqaraAuth,m&&$().connected),label:m?"已授权 绿米":"未授权 绿米"},m?X().createElement("div",{className:$().connect,onClick:function(){return f.apply(this,arguments)}},X().createElement("span",{className:$().text},"取消授权")):X().createElement("div",{className:U()($().connect,s&&$().connecting),onClick:function(){return d.apply(this,arguments)}},X().createElement("span",{className:$().icon},X().createElement(r.Ge,{stroke:"#847da4"})),X().createElement("span",{className:$().text},"开始授权")))}),ec={Align:m.HE,TextInput:c.Sy,InputNumber:o.fE,Color:o.gE,VisibleSwitch:o.hE,DisabledSwitch:o.mE,InputMode:i.EE,InputSizeType:i.OE,InputTextGroup:i.wE,InputSettingGroup:l.SE,InputBackground:l.jE,Coordinate:l.RE,Size:d.QE,TextArea:l.kE,FontFamily:s.ME,BackgroundColor:o._E,HorizontalAlign:u.BE,VerticalAlign:u.GE,ButtonSizeType:f.nO,ButtonTextGroup:f.rO,ButtonIconGroup:f.oO,ButtonBackground:f.sO,ButtonMode:f.tO,ChangeImage:l.NE,WidgetTitle:m.VE,Headline:d.qE,Options:p.dO,RadioMode:v.mO,RadioSizeType:v.gO,CheckboxSizeType:v._O,SliderDirection:g.RO,SwitchMode:E.EO,SwitchSizeType:E.OO,SwitchBackground:E.CO,SliderMode:g.jO,SliderRange:g.NO,NumberInputRow:g.kO,DegreeInputRow:y.MO,FlipInputRow:y.LO,ScaleInputRow:y.BO,StyleEditorSwitch:b.WO,AudioChangeSoundFile:h.KO,AudioVolume:h.qO,AudioRate:h.XO,LocalStorageFields:N.JO,HttpBody:k.tw,HttpHeader:C.ow,HttpParams:C.iw,ListNewDataSource:w.pw,ListViewerDataSource:w.lw,ListViewerStyleTemplate:I.hw,OptionSwitch:I.mw,PreviewImage:S._w,Select:S.vw,HelpUrl:S.bw,CloudDbList:x.Sw,AntSwitch:L.Pw,WidgetOpacity:_.Gw,TextWidgetTextGroup:T.Hw,TableData:A.Yw,RichTextEditor:O.Xw,NumberSlider:D.Jw,BrushDrawProcess:B.tC,BrushPenColor:B.rC,DictFields:j.uC,TableFields:R.hC,WarningFields:P._C,BluetoothConnect:V.SC,AqaraAuth:er},eo=n(89622),ei=n.n(eo),el=n(12327),es=n(9065),eu=n(32919),em=n(50862),ed=n(2980),ef=n(88963),ep=n(95644),ev=n(8335),eE=n.n(ev),eg=(0,Z.memo)(function(e){var t=e.widgetId,n=e.editConfig,a=e.widgetIcon,r=e.widgetType,c=el.Cb(t),o=n.some(function(e){return!Array.isArray(e)&&"HelpUrl"===e.type}),i=es.b(),l=(0,q.useDispatch)();if(!c||!c.type)return null;function s(e){return e in c?c[e]:c.attributes&&e in c.attributes?c.attributes[e]:void 0}var u=function(e,n){var c=e.type,o=e.key,i=ec[c],u="".concat(t,"-").concat(c,"-").concat(o||"");if(i)return X().createElement(i,{key:u,widgetId:t,keyName:o,icon:a,onChange:function(e,n){var a;a=!0,ed.q(r)&&!(el.k.includes(e)&&el.l.includes(c))&&(a=!1),l(z.Lg(t,e,n,void 0,void 0,void 0,a))},getValue:s,formConfig:e,renderInline:n})};return X().createElement(G.h,{className:U()(eE().formGroup,o&&eE().formGroupHasHelpUrl),"data-updated-at":i},X().createElement("div",null,function e(n,a){return n.map(function(n,r){return Array.isArray(n)?X().createElement(G.u,{key:"".concat(t,"-").concat(r),className:eE().formItemWrapper,align:"middle",justify:"space-between"},e(n,!0)):u(n,a)})}(n,!1)))}),ey=(0,Z.memo)(function(){var e=(0,q.useDispatch)(),t=ep.a().formatMessage,n=(0,q.useSelector)(function(e){return e.project.selectedWidgetId}),r=(0,q.useSelector)(function(e){return e.common.widgetAttributeVisible}),c=(0,q.useSelector)(function(e){return e.common.consoleHeight}),o=(0,q.useSelector)(function(e){return e.common.blockyToolboxPinned}),i=n?eu.Bb(n):void 0,l=(0,q.useSelector)(function(e){return e.uiConfig.widgetEditor})===ef.j.ReadOnly,s=function(){var t;e(z.fj(!1)),o||(em.g.setSelectedItem(),null!=(t=em.g.getToolbox())&&t.flyout.hide())};if(n&&!i)return e(z.fj(!1)),null;if(null==i?void 0:i.type){var u=i.type,m=eu.Db(u);if(m){var d=m.editConfig,f=m.icon,p=m.childWidgetEditConfig,v=i.parentId&&p?p:d;return X().createElement("div",{className:U()(ei().wrapper,!r&&ei().hide),style:{bottom:c+8}},X().createElement("div",{className:ei().header},X().createElement("h3",{className:ei().title},t({id:"property"})),X().createElement("div",{onClick:s,className:ei().close},X().createElement(G.j,{type:"icon-close-bold"}))),X().createElement("div",{className:U()(ei().content,l&&ei().readonly)},X().createElement(eg,{widgetId:i.id,widgetType:i.type,editConfig:v,widgetIcon:f})))}}return X().createElement("div",{className:U()(ei().wrapper,!r&&ei().hide),style:{bottom:c+8}},X().createElement("div",{className:ei().header},X().createElement("h3",{className:ei().title},t({id:"property"})),X().createElement("div",{onClick:s,className:ei().close},X().createElement(G.j,{type:"icon-close-bold"}))),X().createElement("div",{className:U()(ei().content,l&&ei().readonly)},X().createElement(a.wy,null)))})},2757(e,t,n){n.d(t,{nT:()=>C,tT:()=>k});var a=n(57420),r=n.n(a),c=n(9065),o=n(50862),i=n(33383),l=n(88963),s=n(51877),u=n(33007),m=n(28413),d=n(46942),f=n.n(d),p=n(95644),v=n(451),E=n(19040),g=n(41594),y=n.n(g),b=n(51327),h=n.n(b),N=new Map;function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e)return N.set(e.nodeName,t),"undefined"!=typeof document&&document.addEventListener("click",function(a){n?t(e,a):e.contains(a.target)||t(e,a)}),function(){N.delete(e)}}var C=(0,g.memo)(function(){var e=(0,E.useSelector)(function(e){return e.block.get("editArrayDialog")}),t=e.visible,n=e.array,a=e.arrayType,d=(0,g.useState)([]),b=v.a(d,2),N=b[0],C=b[1],w=(0,g.useState)(0),I=v.a(w,2),S=I[0],x=I[1],L=(0,g.useRef)(1),_=p.a().formatMessage,T=(0,g.useRef)(null),A=(0,g.useRef)(null),O=(0,E.useDispatch)(),D=c.d();(0,g.useEffect)(function(){n&&(C(m.a(n.defaultValue)),x(n.defaultValue.length))},[n]),(0,g.useEffect)(function(){var e;return A.current&&(e=k(A.current.button,function(e,t){var n;"INPUT"!==(null==(n=t.target)?void 0:n.tagName)&&(L.current=0)})),e&&e()},[]),(0,g.useEffect)(function(){var e;t&&(null!=(e=T.current)&&e.focus(),o.z.unselectCurrentBlock())},[t]);var B=function(e){x(e)},j=(0,g.useCallback)(function(e){var t=Number(e)-N.length;if(t>0)for(var n=0;n<t;n++)N.push("");else N.splice(Number(e),N.length);C(m.a(N)),x(N.length),L.current=0},[N]),R=function(e,t){if(13===t.keyCode){var n=e+1;N.splice(n,0,""),C(m.a(N)),B(n+1),setTimeout(function(){var e=document.querySelectorAll(".".concat(r().list," input"))[n];null!=e&&e.focus()},0)}};(0,g.useLayoutEffect)(function(){if(L.current){var e=document.querySelectorAll(".".concat(r().list," input"))[S-1];null!=e&&e.focus()}},[S]);var P=(0,g.useCallback)(function(e){N.splice(e,1),C(m.a(N)),x(N.length),L.current=0},[N]),V=(0,g.useCallback)(function(e,t){N.splice(e,1,t),C(m.a(N))},[N]),W=(0,g.useCallback)(function(){O(s.oh())},[O]),M=(0,g.useCallback)(function(){if(L.current=0,n&&D){var e=[];N.forEach(function(t){"string"==typeof t?e.push(i.mb(t)):e.push(t)});var t=n.id;O(s.yg(a||l.i.SCREEN,t,"defaultValue",e,D.id))}W()},[n,D,W,N,O,a]);return(0,g.useEffect)(function(){function e(e){var t,n=null==(t=e.clipboardData)?void 0:t.getData("text");n&&n.split("\n").forEach(function(e,t){V(t,e)})}return t&&0===N.length&&document.body.addEventListener("paste",e),function(){document.body.removeEventListener("paste",e)}},[t,V,N]),y().createElement(u.f,{className:f()(r().editListDialog,r().editDialog),visible:t,withPortal:!0,onClose:W},y().createElement("p",{className:r().dialogTitle},_({id:"editVariableList"})),y().createElement("div",{className:r().summary},y().createElement("span",null,null==n?void 0:n.name),y().createElement("div",{className:r().count},y().createElement("span",null,_({id:"itemCount"})),y().createElement(u.k,{type:"number",min:0,max:1e3,onBlur:j,ref:T,className:r().input,defaultValue:N.length||"0",dependency:N.length.toString()}),y().createElement(u.d,{onClick:function(){L.current?(L.current=1,N.length<1e3&&(N.splice(S,0,""),C(m.a(N)),B(S+1))):(N.push(""),C(m.a(N)),B(N.length),L.current=1)},type:"primary",ref:A},y().createElement(u.j,{type:"icon-add"})))),y().createElement("div",{className:r().list},N.length>0?y().createElement("ul",null,N.map(function(e,t){return y().createElement("li",{className:r().listItem,key:t},y().createElement(u.k,{type:"text",before:y().createElement("div",{className:r().inputLabel},t+1),after:y().createElement("div",{className:r().inputClose,onClick:P.bind(null,t)},"x"),onClick:function(e){e.currentTarget.select(),L.current=1,B(t+1)},className:r().listInput,defaultValue:e,onBlur:V.bind(null,t),dependency:N.length.toString(),onKeyDown:R.bind(null,t)}))})):y().createElement("div",{className:r().emptyContent},y().createElement("img",{className:r().image,src:h(),alt:""}),y().createElement("div",{className:r().label},_({id:"variableListEmptyContentLabel"})))),y().createElement(u.d,{className:r().save,type:"primary",onClick:M},_({id:"save"})))})},66465(e,t,n){n.d(t,{xT:()=>eN,yg:()=>a});var a,r=n(98852),c=n(92136),o=n(88963),i=n(51877),l=n(33007),s=n(46942),u=n.n(s),m=n(95644),d=n(451),f=n(50687),p=n(19040),v=n(41594),E=n.n(v),g=n(51089),y=n(47157),b=n(50072),h=n(57420),N=n.n(h),k=n(36303),C=["addPrimitiveVariableName","addArrayVariableName","object.createNewObject","addDocKey"],w=(0,v.memo)(function(){var e=(0,p.useSelector)(function(e){return e.block.get("createVariableDialog")}),t=e.visible,n=e.onClose,a=e.title,r=e.validators,s=e.onConfirm,g=e.tips,y=e.placeholder,b=(0,v.useState)(""),h=d.a(b,2),k=h[0],w=h[1],I=(0,v.useState)(""),S=d.a(I,2),x=S[0],L=S[1],_=(0,v.useState)(!1),T=d.a(_,2),A=T[0],O=T[1],D=(0,v.useState)(o.i.GLOBAL),B=d.a(D,2),j=B[0],R=B[1],P=m.a().formatMessage,V=(0,v.useRef)(null),W=(0,v.useRef)(!0),M=(0,p.useSelector)(function(e){return e.project.currentScreenIndex}),z=(0,p.useDispatch)();(0,v.useEffect)(function(){t&&setTimeout(function(){var e;null!=(e=V.current)&&e.focus()},0)},[t]);var G=(0,v.useCallback)(function(e){var t="";if(e){if(r&&W.current){var n,a=c.a(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!o.validator(e,j)){t=o.message;break}}}catch(e){a.e(e)}finally{a.f()}w(t)}}else w("");L(e)},[r,j]),F=(0,v.useCallback)(function(){L(""),w(""),R(o.i.GLOBAL),z(i.lh()),n&&n()},[z,n]),U=(0,v.useCallback)(function(e){A&&!e&&w(P({id:"invalidVariableName"}))},[P,A]),H=(0,v.useCallback)(function(){!k&&x&&(s&&s(x,j),F())},[F,x,s,j,k]),Y=function(){O(!0)},J=function(){O(!1)},K=(0,v.useCallback)(function(){W.current=!1},[]),q=(0,v.useCallback)(function(e){W.current=!0,G(e.target.value)},[G]),Z=function(e){R(e);var t="";if(x&&r){var n,a=c.a(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!o.validator(x,e)){t=o.message;break}}}catch(e){a.e(e)}finally{a.f()}}w(t)},X="",Q="";switch(a){case"addPrimitiveVariableName":X=P({id:"screenVariable"}),Q=P({id:"globalVariable"});break;case"addArrayVariableName":X=P({id:"screenArray"}),Q=P({id:"globalArray"});break;case"object.createNewObject":X=P({id:"object.screenObject"}),Q=P({id:"object.globalObject"})}return E().createElement(l.f,{visible:t,className:u()(N().nameDialog),withPortal:!0,onClose:F},E().createElement(f.a,{useCapture:!0},E().createElement(f.b,{keys:"enter",callback:H})),E().createElement("p",{className:N().dialogTitle},C.includes(a)?P({id:a}):P({id:"addCurrentScreenIndexTitle"},{currentScreenIndex:M+1})),E().createElement("div",{className:u()(N().inputWrapper,k&&N().inputWaringWrapper)},E().createElement("span",null,P({id:"name"})),E().createElement(l.k,{ref:V,warning:!!k,onChange:G,onBlur:U,onCompositionStart:K,onCompositionEnd:q,value:x,isTrimmed:!0,placeholder:y}),k&&E().createElement("div",{className:N().warningTips}," ",k)),("addPrimitiveVariableName"===a||"addArrayVariableName"===a||"object.createNewObject"===a)&&E().createElement("div",{className:N().inputWrapper},E().createElement("span",null,P({id:"property"})),E().createElement("div",{className:N().propertyBox,onMouseUp:Y,onMouseDown:J},E().createElement(l.d,{shape:"square",icon:"icon-style-selected",className:j===o.i.GLOBAL?N().active:"",onClick:Z.bind(null,o.i.GLOBAL)},Q),E().createElement(l.d,{shape:"square",icon:"icon-style-selected",className:j===o.i.SCREEN?N().active:"",onClick:Z.bind(null,o.i.SCREEN)},E().createElement("div",{style:{display:" inline-block",position:"relative",marginRight:"4px"}},E().createElement(l.j,{className:"coco-iconfont-screen-bg",type:M>8?"icon-screen-variable-plus":"icon-screen-variable"}),E().createElement("span",{style:{position:"absolute",transform:"scale(0.5)",fontFamily:"sans-serif",left:0,right:0,bottom:0,margin:"auto",top:M>8?"-3px":"-2px",fontSize:16,color:"#fff"}},M+1)),E().createElement("span",null,X)))),E().createElement("div",{className:N().confirmBox,onMouseUp:Y,onMouseDown:J},E().createElement(l.d,{onClick:F},P({id:"cancel"})),E().createElement(l.d,{onClick:H,type:"primary",disabled:!!k||!x},P({id:"confirm"}))),g&&E().createElement("span",{className:N().bottomTips},g))}),I=n(2757),S=n(51327),x=n.n(S),L=n(22224),_=n(9065),T=n(50862),A=n(28413),O=n(13244),D=n(73232),B=n.n(D),j=(0,v.memo)(function(){var e=(0,p.useSelector)(function(e){return e.block.get("editObjectDialog")}),t=e.visible,n=e.variable,a=e.scopeType,r=null==n?void 0:n.id,c=(0,p.useSelector)(function(e){return e.project.globalObjectList}),o=m.a().formatMessage,s=(0,v.useRef)(null),f=_.d(),g=(0,v.useState)(!1),y=d.a(g,2),b=y[0],h=y[1],k=(0,v.useState)(0),C=d.a(k,2),w=C[0],S=C[1],D=(0,v.useState)(0),j=d.a(D,2),R=j[0],P=j[1],V=(0,v.useState)([]),W=d.a(V,2),M=W[0],z=W[1],G=(0,v.useRef)(!1),F=(0,v.useRef)(0),U=(0,v.useRef)(null);(0,v.useEffect)(function(){if(f&&t){var e=f.objectVariables.concat(c).find(function(e){return e.id===r});e&&L.isPlainObject(e.defaultValue)&&z(Object.entries(L.cloneDeep(e.defaultValue)))}},[f,c,r,t]);var H=function(e){var t=2*e+R;setTimeout(function(){var e,n=null==(e=s.current)?void 0:e.querySelectorAll("input")[t];n&&(G.current?n.select():n.focus(),G.current=!1)})};(0,v.useEffect)(function(){t&&(h(!1),S(0),P(0),F.current=0)},[t]),(0,v.useEffect)(function(){if(U.current)return(0,I.tT)(U.current.button,function(e,t){var n,a,r;(null==(n=U.current)||null==(a=n.button)?void 0:a.contains(t.target))||"INPUT"===(null==(r=t.target)?void 0:r.tagName)||(F.current=0)},!0)},[U.current]);var Y=(0,p.useDispatch)();(0,v.useEffect)(function(){t&&T.z.unselectCurrentBlock()},[t]);var J=function(){for(var e=M.map(function(e){return e[0]}),t=1;e.includes("key".concat(t));)t++;var n="key".concat(t);F.current?(M.splice(w+1,0,[n,""]),z(A.a(M)),S(w+1),H(w+1),w===M.length-1&&setTimeout(function(){s.current&&(s.current.scrollTop=s.current.scrollHeight)},0)):(M.push([n,""]),z(A.a(M)),S(M.length),F.current=1,H(M.length),setTimeout(function(){s.current&&(s.current.scrollTop=s.current.scrollHeight)},0))},K=(0,v.useCallback)(function(){Y(i.ph())},[Y]),q=(0,v.useCallback)(function(){if(a&&r&&f){var e={};M.forEach(function(t){var n=d.a(t,2),a=n[0],r=n[1];e[a]=r}),Y(i.Gg({scopeType:a,id:r,key:"defaultValue",value:e,screenId:f.id})),K()}},[f,Y,M,K,r,a]),Z=function(e,t){"Enter"===e.key&&(t===M.length-1?(J(),0===R&&(G.current=!0)):(S(t+1),H(t+1)))};return n?E().createElement(l.f,{className:u()(N().editDialog,B().container),visible:t,withPortal:!0,onClose:K},E().createElement("p",{className:N().dialogTitle},o({id:"object.editObjectList"})),E().createElement("div",{className:N().summary},E().createElement("span",null,n.name),E().createElement("div",{className:N().count},E().createElement(l.d,{onClick:J,type:"primary",ref:U},E().createElement(l.j,{type:"icon-add"})))),E().createElement("div",{className:u()(N().list,B().list),ref:s},M.length>0?E().createElement("ul",null,M.map(function(e,t){var n=d.a(e,2),a=n[0],r=n[1];return E().createElement("li",{className:u()(B().row,O.a({},B().focus,t===w)),key:a},E().createElement("div",{className:B().keyItem},E().createElement("input",{type:"text",defaultValue:a,className:u()(B().input,O.a({},B().error,b&&w===t)),onClick:function(){F.current=1,S(t),P(0)},onBlur:function(e){var n=[e.target.value,M[t][1]];if(b){var a=M[t][0];e.target.value=a}else M.splice(t,1,n),z(A.a(M));h(!1)},onChange:function(e){var n,a;n=e.target.value,(a=M.some(function(e,a){return t!==a&&e[0]===n}))!==b&&h(a)},onKeyPress:function(e){Z(e,t)}})),E().createElement("div",{className:B().valueItem},E().createElement("input",{type:"text",value:r,className:u()(B().input),onBlur:function(e){var n=e.target.value;if(""!==n){var a=Number(n);isNaN(a)||(n=a)}var r=[M[t][0],n];M.splice(t,1,r),z(A.a(M))},onClick:function(){F.current=1,S(t),P(1)},onKeyPress:function(e){Z(e,t)},onChange:function(e){M[t][1]=e.target.value,z(A.a(M))}})),E().createElement("span",{className:B().close,onClick:function(){M.splice(t,1),z(A.a(M))}},E().createElement(l.j,{type:"icon-close"})))})):E().createElement("div",{className:N().emptyContent},E().createElement("img",{className:N().image,src:x(),alt:""}),E().createElement("div",{className:N().label},o({id:"variableListEmptyContentLabel"})))),E().createElement("div",{className:B().footer},E().createElement("p",{className:B().tips},b?o({id:"object.keyRepeat"}):""),E().createElement(l.d,{className:B().save,type:"primary",onClick:q,disabled:b},o({id:"save"})))):null}),R=n(4327),P=n(38752),V=n(41804),W=n(10309),M=n(32919),z=n(97712),G=n(59435),F=n(85709),U=n(16699),H=n(45109),Y=n.n(H),J=(0,v.memo)(function(){var e=(0,v.useRef)(null),t=(0,p.useDispatch)(),n=(0,v.useState)(100),a=d.a(n,2),r=a[0],c=a[1],o=(0,p.useSelector)(function(e){return e.block.slider});return(0,v.useEffect)(function(){var e=parseInt(o.value);c(e=(e=e>o.max?o.max:e)<o.min?o.min:e)},[o]),(0,v.useEffect)(function(){function n(a){var r=a.target,c=e.current;"blocklyHtmlInput"===r.className||c&&c.contains(r)||(t(i.ih()),document.body.removeEventListener("mousedown",n,{capture:!0}))}return o.visible&&document.body.addEventListener("mousedown",n,{capture:!0}),function(){document.body.removeEventListener("mousedown",n,{capture:!0})}},[t,o]),E().createElement("div",{ref:e,className:Y().sliderWrapper,style:{position:"fixed",top:o.top+4,left:o.left-70,zIndex:2}},E().createElement("span",{className:Y().leftSliderText},o.minText),E().createElement(l.x,{value:r,min:o.min,max:o.max,onChange:function(e){c(e),setTimeout(function(){return o.setValue(e+"")},0)}}),E().createElement("span",{className:Y().rightSliderText},o.maxText))}),K=(0,v.memo)(function(e){var t=e.options,n=m.a().formatMessage,a=(0,p.useDispatch)(),r=(0,p.useSelector)(function(e){return e.block.dropdown}),c=(0,v.useMemo)(function(){return t.some(function(e){var t,n;return P.BU.base.is_old_dropdown_option(e)?"string"==typeof(null==(n=e[2])?void 0:n.src):"basic"===e.type&&"string"==typeof(null==(t=e.icon)?void 0:t.src)})},[t]);return E().createElement(l.w,{className:u()(N().dynamicDataList,c&&N().imageTextDataList),open:r.visible,value:r.value,onChange:function(e){e!==Z&&r.setValue(e),a(i.gh())}},t.map(function(e,t){var a,r,c;if(P.BU.base.is_old_dropdown_option(e))return e[1]===M.h&&e[0]===M.g?E().createElement("div",{className:N().nullItem,key:t},n({id:"closeHeadline"})):E().createElement(l.p,{value:e[1],key:t,className:N().dropdownOption},e[2]&&"string"==typeof(null==(a=e[2])?void 0:a.src)&&E().createElement("div",{className:N().dropdownImageBox},E().createElement("img",{src:e[2].src,className:N().image,alt:""})),E().createElement("span",null,e[0]));if("line"===e.type)return E().createElement("div",{className:N().line,key:t});if("basic"===e.type){if(e.value===M.h&&e.text===M.g)return;return"DROPDOWN_ADD_BUTTON"===e.value?E().createElement(l.p,{value:Z,key:t},E().createElement("div",{className:N().addOption,onClick:e.callback},E().createElement(l.j,{type:"icon-add"}),E().createElement("span",null,e.text))):E().createElement(l.p,{value:e.value,key:t,className:N().dropdownOption},"string"==typeof(null==(r=e.icon)?void 0:r.src)&&E().createElement("div",{className:N().dropdownImageBox},E().createElement("img",{src:e.icon.src,className:N().image,alt:""})),"object"==typeof(null==(c=e.icon)?void 0:c.src)&&E().createElement("div",{className:N().dropdownIconBox},E().createElement(l.j,{type:"icon-screen-variable"})),E().createElement("span",null,e.text))}}))}),q=(0,v.memo)(function(e){var t=e.group,n=t.name,a=t.options,r=(0,v.useRef)(null),c=(0,p.useSelector)(function(e){return e.block.dropdown}),o=(0,v.useState)("right"),i=d.a(o,2),s=i[0],m=i[1],f=(0,v.useState)(!1),g=d.a(f,2),y=g[0],b=g[1],h=a.some(function(e){return"value"in e&&e.value===c.value||Array.isArray(e)&&e[1]===c.value}),k=(0,v.useMemo)(function(){return L.debounce(b,100)},[]);return E().createElement("div",{ref:r,style:{position:"relative"},onMouseEnter:function(){k(function(){return!0});var e=r.current;if(e){var t=e.getClientRects()[0];t.x+t.width+t.width<window.innerWidth?m("right"):m("left")}},onMouseLeave:function(){k(function(){return!1})}},E().createElement(l.p,{value:Z,className:u()(h&&"selected",y&&"hovered")},E().createElement("span",null,n)),E().createElement("div",{style:{position:"absolute",top:7,right:2}},E().createElement(l.j,{type:"icon-fold-left",className:N().icon})),E().createElement("div",{style:{position:"absolute",top:0,left:"right"===s?"100%":void 0,right:"left"===s?"100%":void 0,visibility:y?"visible":"hidden"}},E().createElement("div",{style:{position:"fixed",boxShadow:"0px 0px 6px 0px rgb(177 163 191 / 30%)",transform:"left"===s?"translateX(-100%)":void 0}},E().createElement(K,{options:a}))))}),Z="__EMPTY_VALUE__",X=(0,v.memo)(function(){var e=m.a().formatMessage,t=(0,p.useDispatch)(),n=(0,p.useSelector)(function(e){return e.block.dropdown}),a=(0,p.useSelector)(function(e){return e.project.currentScreenIndex}),c=(0,v.useMemo)(function(){return n.options.some(function(e){var t,n;return P.BU.base.is_old_dropdown_option(e)?"string"==typeof(null==(n=e[2])?void 0:n.src):"basic"===e.type&&"string"==typeof(null==(t=e.icon)?void 0:t.src)})},[n]);return E().createElement(l.w,{className:u()(N().dynamicDataList,c&&N().imageTextDataList),open:n.visible,value:n.value,onChange:function(e){e!==Z&&n.setValue(e),t(i.gh())}},n.options.map(function(t,c){var o,i,s;if(P.BU.base.is_old_dropdown_option(t))return t[1]===M.h&&t[0]===M.g?E().createElement("div",{className:N().nullItem},e({id:"closeHeadline"})):E().createElement(l.p,{value:t[1],key:c,className:N().dropdownOption},t[2]&&"string"==typeof(null==(o=t[2])?void 0:o.src)&&E().createElement("div",{className:N().dropdownImageBox},E().createElement("img",{src:t[2].src,className:N().image,alt:""})),E().createElement("span",null,t[0]));if("line"===t.type)return E().createElement("div",{className:N().line,key:c});if("group"===t.type)return E().createElement(q,{key:c,group:t});if("basic"===t.type){if(t.value===M.h&&t.text===M.g)return;return"DROPDOWN_ADD_BUTTON"===t.value?E().createElement(l.p,{value:Z,key:c},E().createElement("div",{className:N().addOption,onClick:t.callback},E().createElement(l.j,{type:"icon-add"}),E().createElement("span",null,t.text))):t.value===r.Ag.NO_BIND_DATA_SOURCE?E().createElement("div",{className:N().optionTips,key:r.Ag.NO_BIND_DATA_SOURCE},E().createElement("span",null,t.text)):t.value===r.Ag.EMPTY_KEYS_DATA?E().createElement("div",{className:N().optionTips,key:r.Ag.EMPTY_KEYS_DATA},E().createElement("span",null,t.text)):t.value===r.Ag.FETCH_DATA_FAILED?E().createElement("div",{className:N().optionTips,key:r.Ag.FETCH_DATA_FAILED},E().createElement("span",null,t.text),E().createElement("div",{className:N().btn,onClick:t.callback},e({id:"retry"}))):E().createElement(l.p,{value:t.value,key:c,className:N().dropdownOption},"string"==typeof(null==(i=t.icon)?void 0:i.src)&&E().createElement("div",{className:N().dropdownImageBox},E().createElement("img",{src:t.icon.src,className:N().image,alt:""})),"object"==typeof(null==(s=t.icon)?void 0:s.src)&&E().createElement("div",{className:u()(N().dropdownIconBox,n.showCurrentScreenIndex&&N().showCurrentScreenBg)},E().createElement(l.j,{className:"coco-iconfont-screen-bg",type:a>8?"icon-screen-variable-plus":"icon-screen-variable"}),E().createElement("div",{className:N().screenIconBox},E().createElement("div",{className:N().screenIconText},n.showCurrentScreenIndex&&a+1))),E().createElement("span",null,t.text))}}))}),Q=(0,v.memo)(function(e){var t=e.type,n=(0,p.useSelector)(function(e){return e.block.dropdown}),a=m.a().formatMessage,r=(0,p.useDispatch)();return E().createElement("ul",{className:N().imageEntryList,style:{display:n.visible?"block":"none"}},E().createElement("li",{onClick:function(){r(i.wj(t===o.a.IMAGE_DROPDOWN?V.c.ImageLibrary:V.c.IconLibrary,function(e){var t=e[0];n.setValue(t.id),r(i.sh())}))}},a({id:t===o.a.IMAGE_DROPDOWN?"selectByLibrary":"selectByIconLibrary"})),E().createElement("li",null,E().createElement(l.B,{onChange:function(e){e&&r((t===o.a.IMAGE_DROPDOWN?i.Zf:i.rf)(e,function(e){var t=e[0];n.setValue(t.id),r(i.gh())}))},accept:t===o.a.IMAGE_DROPDOWN?W.f:W.c},a({id:"uploadFileByLocal"}))),n.blockInfo.emptyImageVisible&&E().createElement("li",{onClick:function(){n.setValue(M.f),r(i.gh())}},a({id:"emptyImage"})))}),$=(0,v.memo)(function(){var e=(0,p.useSelector)(function(e){return e.block.dropdown}),t=m.a().formatMessage,n=(0,p.useDispatch)();return E().createElement("ul",{className:N().imageEntryList,style:{display:e.visible?"block":"none"}},E().createElement("li",{onClick:function(){n(i.wj(V.c.SoundLibrary,function(t){var a=t[0];e.setValue(a.id),n(i.sh())}))}},t({id:"selectByLibrary"})),E().createElement("li",null,E().createElement(l.B,{onChange:function(t){t&&n(i.wf(t,function(t){var a=t[0];e.setValue(a.id),n(i.gh())}))},accept:R.h},t({id:"uploadFileByLocal"}))))}),ee=n(73400),et=n(9958),en=n(24715),ea=n.n(en),er=(0,v.memo)(function(){var e,t=(0,p.useSelector)(function(e){return e.block.dropdown}),n=t.blockInfo,a=n.sourceBlockId,r=n.fieldName,c=t.options,o=P.Z.mainWorkspace.get_block_by_id(a),s=(null==o?void 0:o.get_field_value("WIDGET_ID"))||(null==o||null==(e=o.get_parent())?void 0:e.get_field_value("WIDGET_ID")),u=m.a().formatMessage,d=(0,p.useDispatch)();if(!s)return console.error("actorId is null"),null;function f(){s?d(i.Dh(s,function(e,t){var n=null==o?void 0:o.type,a=null==o?void 0:o.get_parent();switch(n){case"actor_style_input":case"actor_action_input":a&&setTimeout(function(){var n=ee.getActorActionInputField(a),r=ee.getActorStyleInputField(a);n&&null!=n&&n.set_value(e),r&&(t?null!=r&&r.set_value(t):null!=r&&r.set_value(M.h))},0);break;default:null!=o&&o.set_field_value(e,"ACTOR_ACTION_ID"),t&&(null==o?void 0:o.get_field_value("ACTOR_STYLE_ID"))&&null!=o&&o.set_field_value(t,"ACTOR_STYLE_ID")}})):console.error("actorId is null")}return E().createElement(l.w,{className:ea().container,open:t.visible,value:t.value,onChange:function(e){"__EMPTY_VALUE__"!==e&&t.setValue(e),d(i.gh())}},function(){var e=[];switch(r){case"ACTOR_STYLE_ID":e=c.map(function(e,t){if(!P.BU.base.is_old_dropdown_option(e)&&"basic"===e.type){var n=e.value,a=e.text;if(n!==M.h){if("DROPDOWN_ADD_BUTTON"===n)return E().createElement(l.p,{value:"__EMPTY_VALUE__",key:n},E().createElement("div",{className:ea().addOption,onClick:f},E().createElement(l.j,{type:"icon-add"}),u({id:"actorAddStyle"})));var r=function(e,t){var n=M.Bb(e);if(n){var a=n.attributes.actionList,r=[];a.forEach(function(e){var t=e.styleList;r.push.apply(r,A.a(t))});var c=r.find(function(e){return e.id===t});if(c){var o=c.source;return M.mb(o)}}}(s,n);return E().createElement(l.p,{value:n,key:n},E().createElement("span",{className:ea().itemIndex},t+1,"."),E().createElement("div",{className:ea().styleItem},E().createElement("div",{className:ea().imgContainer},r?E().createElement("img",{className:ea().styleImg,src:r,alt:a}):E().createElement("span",{className:ea().styleEmptyImg})),E().createElement("span",{className:ea().styleName},a)))}}});break;case"ACTOR_ACTION_ID":e=c.map(function(e){if(!P.BU.base.is_old_dropdown_option(e)&&"basic"===e.type){var t=e.text,n=e.value,a=function(e,t){var n=M.Bb(e);if(n){var a=n.attributes.actionList.find(function(e){return e.id===t});if(a){var r=a.styleList[0];if(r){var c=r.source;return M.mb(c)}}}}(s,n);return"DROPDOWN_ADD_BUTTON"===n?E().createElement(l.p,{value:"__EMPTY_VALUE__",key:n},E().createElement("div",{className:ea().addOption,onClick:f},E().createElement(l.j,{type:"icon-add"}),u({id:"ActorStyleDialog.addAction"}))):E().createElement(l.p,{value:n,key:n},E().createElement("div",{className:ea().actionItem},E().createElement("div",{className:ea().imgContainer},a?E().createElement("img",{className:ea().actionImg,src:a,alt:t}):E().createElement("span",{className:ea().actionEmptyImg,style:{backgroundImage:"url(".concat(et.a,")")}})),E().createElement("span",{className:ea().actionName},t)))}})}return e}())}),ec=n(77487),eo=n.n(ec),ei=(0,v.memo)(function(){var e=m.a().formatMessage,t=(0,p.useDispatch)(),n=(0,p.useSelector)(function(e){return e.block.dropdown}),a=(0,v.useMemo)(function(){return n.options.some(function(e){var t,n;return P.BU.base.is_old_dropdown_option(e)?"string"==typeof(null==(n=e[2])?void 0:n.src):"basic"===e.type&&"string"==typeof(null==(t=e.icon)?void 0:t.src)})},[n]);return E().createElement(l.w,{className:u()(N().dynamicDataList,a&&N().imageTextDataList),open:n.visible,value:n.value,onChange:function(e){"__EMPTY_VALUE__"!==e&&n.setValue(e),t(i.gh())}},n.options.map(function(t,n){var a,r,c;if(P.BU.base.is_old_dropdown_option(t))return t[1]===M.h&&t[0]===M.g?E().createElement("div",{className:N().nullItem},e({id:"closeHeadline"})):E().createElement(l.p,{value:t[1],key:n,className:N().dropdownOption},t[2]&&"string"==typeof(null==(a=t[2])?void 0:a.src)&&E().createElement("div",{className:N().dropdownImageBox},E().createElement("img",{src:t[2].src,className:N().image,alt:""})),E().createElement("span",null,t[0]));if("line"===t.type)return E().createElement("div",{className:N().line,key:n});if("basic"===t.type){if(t.value===M.h&&t.text===M.g)return;return E().createElement(l.p,{value:t.value,key:n,className:N().dropdownOption},"nextScreen"!==t.value&&"prevScreen"!==t.value&&E().createElement("div",{className:eo().screenIndex},n+1,"."),("nextScreen"===t.value||"prevScreen"===t.value)&&E().createElement("div",{className:eo().screenIndex},""),"string"==typeof(null==(r=t.icon)?void 0:r.src)&&E().createElement("div",{className:N().dropdownImageBox},"nextScreen"===t.value&&E().createElement(l.j,{className:eo().dropdownImageScreen,type:"icon-prev-screen"}),"prevScreen"===t.value&&E().createElement(l.j,{className:eo().dropdownImageScreen,type:"icon-next-screen"}),E().createElement("img",{src:t.icon.src,className:N().image,alt:""})),"object"==typeof(null==(c=t.icon)?void 0:c.src)&&E().createElement("div",{className:N().dropdownIconBox},E().createElement(l.j,{type:"icon-screen-variable"})),E().createElement("span",null,t.text))}}))}),el=(0,v.memo)(function(){var e=(0,v.useRef)(null),t=(0,p.useDispatch)(),n=(0,p.useSelector)(function(e){return e.block.dropdown}),a=n.position,r=n.blockInfo,c=(0,v.useState)(0),l=d.a(c,2),s=l[0],u=l[1],m=(0,v.useState)(-1e3),f=d.a(m,2),g=f[0],y=f[1];return(0,v.useEffect)(function(){if(n.visible){if(a.top>window.innerHeight/2&&e.current){var t=e.current.clientHeight;u(a.top-t*r.scale-r.blockHeight)}else u(a.top);e.current&&a.left+e.current.clientWidth>window.innerWidth?y(a.left-e.current.clientWidth+r.fieldWidth):y(a.left),e.current&&e.current.focus()}}),(0,v.useEffect)(function(){function a(n){var r=n.target,c=e.current;c&&c.contains(r)||(t(i.gh()),document.body.removeEventListener("mousedown",a,{capture:!0}))}return n.visible&&document.body.addEventListener("mousedown",a,{capture:!0}),function(){document.body.removeEventListener("mousedown",a,{capture:!0})}},[t,n]),E().createElement("div",{ref:e,className:N().blockDropdown,style:{position:"fixed",top:s,left:g,transformOrigin:"left top",transform:"scale(".concat(n.blockInfo.scale,")"),zIndex:2}},[o.a.IMAGE_DROPDOWN,o.a.ICON_DROPDOWN].includes(n.type)&&E().createElement(Q,{type:n.type}),n.type===o.a.SOUND_DROPDOWN&&E().createElement($,null),n.type===o.a.DYNAMIC_DROPDOWN&&E().createElement(X,null),n.type===o.a.ACTOR_STYLE_DROPDOWN&&E().createElement(er,null),n.type===o.a.SCREEN_DROPDOWN&&E().createElement(ei,null))}),es=n(99432),eu=n(35685),em=n(33383),ed=n(22827),ef=n(5762),ep=n(32029),ev=n.n(ep),eE=n(18491),eg=n.n(eE),ey=(0,v.memo)(function(e){var t=e.variableType,n=m.a().formatMessage,a=(0,v.useState)(!0),c=d.a(a,2),s=c[0],f=c[1],g=(0,v.useState)(""),y=d.a(g,2),b=y[0],h=y[1],N=(0,v.useState)(""),k=d.a(N,2),C=k[0],w=k[1],I=(0,v.useState)(""),S=d.a(I,2),x=S[0],L=S[1],O=(0,v.useState)(!1),D=d.a(O,2),B=D[0],j=D[1],R=(0,v.useState)([]),V=d.a(R,2),W=V[0],M=V[1],z=(0,v.useState)([]),G=d.a(z,2),F=G[0],U=G[1],H=(0,v.useState)([]),Y=d.a(H,2),J=Y[0],K=Y[1],q=(0,p.useDispatch)(),Z=_.d(),X=(0,p.useSelector)(function(e){return e.common.language}),Q=(0,p.useSelector)(function(e){return e.project.globalVariableList}),$=(0,p.useSelector)(function(e){return e.project.globalArrayList}),ee=(0,p.useSelector)(function(e){return e.project.globalObjectList}),et=(0,p.useSelector)(function(e){return e.project.screens});(0,v.useEffect)(function(){Z&&(M(Z.primitiveVariables),U(Z.arrayVariables),K(Z.objectVariables),t===o.b.PRIMITIVE&&0===Z.primitiveVariables.length&&0===Q.length||t===o.b.ARRAY&&0===Z.arrayVariables.length&&0===$.length||t===o.b.OBJECT&&0===Z.objectVariables.length&&0===ee.length?f(!1):f(!0))},[Z,t,Q,$,ee]),(0,v.useEffect)(function(){var e=P.Z.mainWorkspace&&T.g.getToolbox();if(e){var t,n,a=null==(t=e.get_selected())?void 0:t.get_name();("toolbox-primitive"===a||"toolbox-array"===a||"toolbox-object"===a)&&null!=(n=T.g.getToolbox())&&n.refresh_selection()}},[s,F,W,J,B,x,Q,$,ee,b]);var en=function(){if(Z){if(t===o.b.PRIMITIVE){var e=es.a("VARIABLE");q(i.nj({title:"addPrimitiveVariableName",placeholder:n({id:"addPrimitiveVariableNamePlaceholder"}),onConfirm:function(t,n){q(i.uf(n,e,t,0,Z.id,0))},validators:[{validator:function(e,t){var n=Z.primitiveVariables.concat(Q);return t===o.i.GLOBAL&&et.forEach(function(e){n=n.concat(e.primitiveVariables)}),!n.some(function(t){return t.name===e})},message:n({id:"primitiveVariableNameRepeat"})}].concat(A.a((0,r.Sg)(n)))}))}else if(t===o.b.ARRAY){var a=es.a("ARRAY");q(i.nj({title:"addArrayVariableName",placeholder:n({id:"addArrayVariableNamePlaceholder"}),onConfirm:function(e,t){q(i.of(t,a,e,[],Z.id,0))},validators:[{validator:function(e,t){var n=Z.arrayVariables.concat($);return t===o.i.GLOBAL&&et.forEach(function(e){n=n.concat(e.arrayVariables)}),!n.some(function(t){return t.name===e})},message:n({id:"arrayVariableNameRepeat"})}].concat(A.a((0,r.Sg)(n)))}))}else if(t===o.b.OBJECT){var c=es.a("OBJECT");q(i.nj({title:"object.createNewObject",placeholder:n({id:"object.createNewObjectNamePlaceholder"}),onConfirm:function(e,t){q(i.tf({scopeType:t,id:c,name:e,defaultValue:{},screenId:Z.id,index:0}))},validators:[{validator:function(e,t){var n=Z.objectVariables.concat(ee);return t===o.i.GLOBAL&&et.forEach(function(e){n=n.concat(e.objectVariables)}),!n.some(function(t){return t.name===e})},message:n({id:"object.nameRepeat"})}].concat(A.a((0,r.Sg)(n)))}))}}},ea=function(e,n){var a,r;t===o.b.PRIMITIVE&&h(b!==e?e:""),t===o.b.ARRAY&&(Z||$.length>0)&&(a=n===o.i.GLOBAL?$.find(function(t){return t.id===e}):F.find(function(t){return t.id===e}))&&q(i.qj({array:a,arrayType:n})),t===o.b.OBJECT&&(r=n===o.i.GLOBAL?ee.find(function(t){return t.id===e}):J.find(function(t){return t.id===e}))&&q(i.rj({variable:r,scopeType:n}))},er=function(e,n,a,r){if(Z){var c,l=e.name;if(w(""),a!==l){if(!em.j(a))return""!==a&&a[0].match(/[0-9_]/)&&q(i.mj({message:ef.c(X,"invalidVariableFirstChar")})),void q(i.mj({message:ef.c(X,"invalidVariableName")}));if(function(e,n){if(t===o.b.PRIMITIVE){var a=W.concat(Q);return n===o.i.GLOBAL&&et.forEach(function(e){a=a.concat(e.primitiveVariables)}),a.some(function(t){return t.name===e})}if(t===o.b.ARRAY){var r=F.concat($);return n===o.i.GLOBAL&&et.forEach(function(e){r=r.concat(e.arrayVariables)}),r.some(function(t){return t.name===e})}if(t===o.b.OBJECT){var c=J.concat(ee);return n===o.i.GLOBAL&&et.forEach(function(e){c=c.concat(e.objectVariables)}),c.some(function(t){return t.name===e})}return!1}(a,n)){switch(t){case o.b.PRIMITIVE:c="primitiveVariableNameRepeat";break;case o.b.ARRAY:c="arrayVariableNameRepeat";break;case o.b.OBJECT:c="object.nameRepeat";break;default:throw Error("Unreachable branch")}return q(i.mj({message:ef.c(X,c)})),void r.target.focus()}t===o.b.PRIMITIVE?i.Nf(q,i.Hg(n,e.id,"name",a,Z.id)):t===o.b.ARRAY?i.Nf(q,i.yg(n,e.id,"name",a,Z.id)):t===o.b.OBJECT&&q(i.Gg({scopeType:n,id:e.id,key:"name",value:a,screenId:Z.id}))}}},ec=function(e){13===e.keyCode&&e.currentTarget.blur()},eo=function(e){w(e)};(0,v.useEffect)(function(){if(C){var e=document.querySelector(".".concat("VARIABLE_ID_"+C," input"));e&&e instanceof HTMLInputElement&&e.focus()}},[C]);var ei=function(e,n){Z&&(t===o.b.PRIMITIVE?i.Nf(q,i.Lf(n,e.id,Z.id)):t===o.b.ARRAY?i.Nf(q,i.If(n,e.id,Z.id)):t===o.b.OBJECT&&q(i.Kf(n,e.id,Z.id)))},el=function(e){var a=e.item,r=e.type;return Z?E().createElement("div",{className:u()(eg().itemWrap,x===a.id&&eg().select),id:a.id,key:a.id,onClick:function(){var e,t;L(a.id),null!=(e=eu.E.customEvent)&&null!=(t=e.emit)&&t.focusItem("dynamicData",a.id)}},E().createElement("div",{className:eg().item},E().createElement("div",{className:u()(eg().name)},C===a.id?E().createElement(l.k,{type:"text",className:u()(eg().nameInput,"".concat("VARIABLE_ID_"+a.id)),maxLength:20,defaultValue:a.name,onBlur:er.bind(null,a,r),onKeyDown:ec}):E().createElement("div",{className:u()(eg().nameInputWrapper)},E().createElement("div",{onClick:eo.bind(null,a.id),className:u()(eg().noEditing)},a.name),E().createElement("div",{className:u()(eg().itemBtn,eg().delete),onClick:ei.bind(null,a,r)},E().createElement(l.j,{type:"icon-close"})),E().createElement(ed.a,{placement:"bottom",trigger:["hover","click"],title:n({id:t===o.b.PRIMITIVE?"editDefaultValue":"edit"})},E().createElement("div",{className:eg().itemBtn,onClick:ea.bind(null,a.id,r)},t===o.b.PRIMITIVE&&E().createElement(l.j,{type:"icon-fold-left",className:u()(eg().itemExpand,b===a.id&&eg().active)}),t===o.b.ARRAY&&E().createElement(l.j,{type:"icon-list"}),t===o.b.OBJECT&&E().createElement(l.j,{type:"icon-list"})))))),t===o.b.PRIMITIVE&&x===a.id&&b===a.id&&E().createElement("div",{className:eg().detail},n({id:"initValue"}),E().createElement(l.k,{type:"text",className:eg().valueInput,maxLength:20,defaultValue:a.defaultValue,onFocus:function(e){return e.target.select()},onBlur:function(e){if(Z){var t=e;t&&(t=em.mb(t)),q(i.Hg(r,a.id,"defaultValue",t,Z.id))}},onKeyDown:ec}))):E().createElement("div",null)};return E().createElement("div",{id:e.labelType,className:eg().wrapper},function(){var e;switch(t){case o.b.PRIMITIVE:e="variable";break;case o.b.OBJECT:e="object";break;case o.b.ARRAY:e="list"}return E().createElement("div",{className:eg().addBtn,onClick:en},E().createElement(l.j,{type:"icon-add",className:eg().addIcon}),n({id:e}))}(),!s&&E().createElement("div",{className:eg().line}),!B&&(t===o.b.PRIMITIVE?E().createElement("div",{className:eg().content},Q.length?E().createElement("div",{className:eg().variableTitle},n({id:"globalVariable"})):null,Q.map(function(e){return E().createElement(el,{item:e,key:e.id,type:o.i.GLOBAL})}),W.length>0?E().createElement("div",{className:eg().variableTitle},n({id:"screenVariable"})):null,W.map(function(e){return E().createElement(el,{item:e,key:e.id,type:o.i.SCREEN})})):t===o.b.ARRAY?E().createElement("div",{className:eg().content},$.length>0?E().createElement("div",{className:eg().variableTitle},n({id:"globalArray"})):null,$.map(function(e){return E().createElement(el,{item:e,key:e.id,type:o.i.GLOBAL})}),F.length>0?E().createElement("div",{className:eg().variableTitle},n({id:"screenArray"})):null,F.map(function(e){return E().createElement(el,{item:e,key:e.id,type:o.i.SCREEN})})):t===o.b.OBJECT?E().createElement("div",{className:eg().content},ee.length>0?E().createElement("div",{className:eg().variableTitle},n({id:"object.globalObject"})):null,ee.map(function(e){return E().createElement(el,{item:e,key:e.id,type:o.i.GLOBAL})}),J.length>0?E().createElement("div",{className:eg().variableTitle},n({id:"object.screenObject"})):null,J.map(function(e){return E().createElement(el,{item:e,key:e.id,type:o.i.SCREEN})})):void 0),s&&E().createElement("div",{className:eg().footer},B&&E().createElement("div",{className:eg().ellipse},"..."),E().createElement("div",{className:eg().expand},E().createElement("div",{className:eg().foldBtn,onClick:function(){return j(!B)}},E().createElement(l.j,{type:"icon-fold",className:B?eg().expandIcon:eg().foldIcon})))))}),eb=(0,v.memo)(function(){return E().createElement("div",{className:ev().wrapper},E().createElement(ey,{variableType:o.b.PRIMITIVE,labelType:T.b.PRIMITIVE}),E().createElement(ey,{variableType:o.b.ARRAY,labelType:T.b.ARRAY}),E().createElement(ey,{variableType:o.b.OBJECT,labelType:T.b.OBJECT}))}),eh=n(59994),eN=(0,v.memo)(function(){var e=(0,p.useStore)(),t=(0,p.useDispatch)(),n=(0,p.useSelector)(function(e){return e.project.selectedWidgetId}),c=(0,p.useSelector)(function(e){return e.project.globalWidgetIds}),s=(0,v.useRef)(),m=(0,v.useRef)(null),f=(0,p.useSelector)(function(e){return e.common.blockyToolboxPinned}),h=(0,p.useSelector)(function(e){return e.block.palette}),C=(0,p.useSelector)(function(e){return e.uiConfig.workspace})===o.j.ReadOnly,S=(0,v.useState)(!1),x=d.a(S,2),A=x[0],O=x[1],D=_.d();(0,v.useLayoutEffect)(function(){a=e.getState,k.e({getWidgetListByType:r.jg,getButtonTypeById:M.T,getPrimitiveVariableList:r.Dg,getArrayVariableList:r.Mg,getObjectVariableList:r.Bg,getBroadcastList:r.zg,getScreenList:r.Yg,getImageFiles:r.Ng,getIconFiles:r.Rg,getLocalDocumentFieldList:r.Ug,getCloudDocumentFieldList:r.Vg,getActorActionList:r.kg,getLocalDocumentList:r.Fg,getCloudDocumentList:r.Hg,getCloudDBList:r.Gg,getCloudDBColumnList:r.Wg,getCloudDictKeyList:r.Jg,getActorStyleList:r.xg,dispatchAction:function(e){t(e)},getSoundFiles:r.Kg,getSliderVisible:r.qg,getListViewerChildWidgetList:r.Xg,getGlobalGridList:r.Qg,getTableDataColumnList:r.Zg,getCloudTableColumnList:r.$g}),T.j(k.b()),c=P.Z,b.DEFAULT_THEME_CONFIG.block_color.PARAM_BLOCK_COLOR={fill:"#3ca9ff",border:"rgba(0, 0, 0, 0.15)"},c.theme.register("cocoBlinkTheme",b.DEFAULT_THEME_CONFIG),c.theme.apply("cocoBlinkTheme"),g.init_extensions(P.Z),g.init_basic_blocks(P.Z),k.d(),T.u();var n=document.getElementById("coco_workspace");if(n){var c,o,l=T.k(n,{toolbox:T.g.getConfig()});m.current=l,T.i();var u=null==(o=l.get_toolbox())?void 0:o.flyout;if(u){var d=u.get_svg_root();if(!d)return;var f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("class","pinButton"),f.setAttribute("id","flyoutPinButton"),f.setAttribute("fill","#B1A3BF"),f.setAttribute("transform","translate(".concat(d.width.baseVal.value-22,", 17) translate(-14, -12.727922)")),f.addEventListener("mousedown",function(){t(i.ci(u.is_auto_close()))}),s.current=function(e){u.set_auto_close(!e);var t=l.get_toolbox();!e||(null==t?void 0:t.get_selected())||null==t||t.set_selected_item(null==t?void 0:t.get_children()[0])};var v=document.createElementNS("http://www.w3.org/2000/svg","title");v.setAttribute("id","flyoutPinTitle"),f.appendChild(v),d.appendChild(f)}n.addEventListener("click",function(){(0,p.batch)(function(){t(i.fj(!1))})}),document.addEventListener("mousedown",function(e){var t=T.z.getDebuggingBlock();if(t){var n=document.querySelectorAll(".".concat("DevToolCloseButton")),a=e.target,r=!0;n.forEach(function(e){e.contains(a)&&(r=!1)}),r&&t.set_glow_stack(!1)}}),l.add_change_listener(function(e){P.I.AllUIEvents.includes(e.type)||t(i.Fi(!0))});var E=function(){var e=l.get_toolbox();if(u&&e&&!u.is_auto_close()){var t=e.get_selected();t&&"toolbox-function"===t.get_name()&&e.refresh_selection()}},h=function(e){E();var t,n=e.procName,a=e.callDisabled,r=e.callReturnDisabled,c=U.a();if(c){var o=T.z.getWorkspaceDataByScreenId(c),i=L.cloneDeep(null==(t=eh.a.getDoc())?void 0:t.blockly[c].workspaceJson);if((null==o?void 0:o.getProcedureManager())&&i){var l=y.effect_of_update_disabled(n,a,r,i);null!=l&&l.unshift("workspaceJson"),null!=l&&l.unshift(c),null!=l&&l.unshift("blockly"),l&&eh.a.applyClient(l)}}},N=function(e){var t,n=e.type,a=e.procName,r=e.changeValue;E();var c=U.a();if(c){var o=T.z.getWorkspaceDataByScreenId(c),i=L.cloneDeep(null==(t=eh.a.getDoc())?void 0:t.blockly[c].workspaceJson);if((null==o?void 0:o.getProcedureManager())&&i){var l=y.effect_of_update_param(n,a,r,i);null!=l&&l.unshift("workspaceJson"),null!=l&&l.unshift(c),null!=l&&l.unshift("blockly"),l&&eh.a.applyClient(l)}}},C=function(e){var t,n=e.oldName,a=e.newName;E();var r=U.a();if(r){var c=T.z.getWorkspaceDataByScreenId(r),o=L.cloneDeep(null==(t=eh.a.getDoc())?void 0:t.blockly[r].workspaceJson);if((null==c?void 0:c.getProcedureManager())&&o){var i=y.effect_of_rename_proc(n,a,o);null!=i&&i.unshift("workspaceJson"),null!=i&&i.unshift(r),null!=i&&i.unshift("blockly"),i&&eh.a.applyClient(i)}}};return T.z.eventBus.addEventListener(G.a.PROCEDURE_UPDATE_DISABLED,h),T.z.eventBus.addEventListener(G.a.PROCEDURE_UPDATE_PARAM,N),T.z.eventBus.addEventListener(G.a.PROCEDURE_UPDATE_NAME,C),function(){T.z.eventBus.addEventListener(G.a.PROCEDURE_UPDATE_DISABLED,h),T.z.eventBus.addEventListener(G.a.PROCEDURE_UPDATE_PARAM,N),T.z.eventBus.addEventListener(G.a.PROCEDURE_UPDATE_NAME,C)}}},[t,e.getState]),(0,v.useEffect)(function(){var e=document.getElementById("flyoutPinTitle");e&&(e.textContent=f?"取消固定":"固定积木盒");var t=document.getElementById("flyoutPinButton");t&&t.setAttribute("d",f?"M9.15577592,17.2392524 L5.06297721,20.4147076 C4.70227021,20.6945177 4.19785796,20.6945258 3.83714196,20.4147273 C3.43192131,20.1004077 3.33455068,19.5363182 3.59372852,19.1079382 L3.65989022,19.0116658 L6.83434436,14.9178209 L9.15577592,17.2392524 Z M20.3646197,9.65036959 C20.9113538,10.1971036 20.9113538,11.0835346 20.3646197,11.6302686 C20.1218167,11.8730716 19.7995995,12.0169534 19.4601513,12.0377089 L19.3137999,12.0389952 L16.6753335,11.9234077 L15.1656605,13.4344949 L15.1929541,13.519627 C15.8378006,15.6025933 15.7355553,17.9090334 14.8538223,19.3047339 L14.7343905,19.4815237 L14.6114034,19.6410045 C14.3705913,19.9334098 13.9468452,19.977261 13.6528215,19.7574674 L13.5760844,19.6909757 L4.38369629,10.4985875 C4.09149216,10.2063834 4.1146799,9.72597265 4.43366749,9.46326859 C5.71969782,8.40415094 8.1029879,8.19707328 10.2941761,8.80516618 L10.5561141,8.88204778 L10.6401771,8.90901148 L12.1498501,7.3993385 L12.0356743,4.76081383 C12.0062869,4.08490357 12.46121,3.50012765 13.0928937,3.34199504 L13.230848,3.314762 L13.3735408,3.3013231 C13.716592,3.28640783 14.0513403,3.39807488 14.3155633,3.61212075 L14.4243024,3.71005223 L20.3646197,9.65036959 Z":"M20.3646197,9.65036959 C20.9113538,10.1971036 20.9113538,11.0835346 20.3646197,11.6302686 C20.1218167,11.8730716 19.7995995,12.0169534 19.4601513,12.0377089 L19.3137999,12.0389952 L16.6753335,11.9234077 L15.1656605,13.4344949 L15.1929541,13.519627 C15.8365817,15.5986557 15.7359392,17.9003142 14.8588143,19.296809 L14.7343905,19.4815237 L14.6114034,19.6410045 C14.3725815,19.9309932 13.9538368,19.9765192 13.6601378,19.7628628 L13.5760844,19.6909757 L10.264499,16.3793902 L5.06297721,20.4147076 C4.73232912,20.6712002 4.28092872,20.6925814 3.93014831,20.4788477 L3.83714196,20.4147273 C3.43431906,20.1022676 3.33571377,19.542985 3.58916517,19.1155567 L3.65989022,19.0116658 L7.69416581,13.809057 L4.38369629,10.4985875 C4.11584251,10.2307337 4.11300549,9.80473412 4.36009442,9.53324526 L4.43366749,9.46326859 C5.71764017,8.40584553 8.09536418,8.19773811 10.2836569,8.80225359 L10.5561141,8.88204778 L10.6401771,8.90901148 L12.1498501,7.3993385 L12.0356743,4.76081383 C12.0061557,4.08188611 12.4652814,3.49490825 13.1013643,3.33990273 L13.230848,3.314762 L13.3735408,3.3013231 C13.716592,3.28640783 14.0513403,3.39807488 14.3155633,3.61212075 L14.4243024,3.71005223 L20.3646197,9.65036959 Z M19.3746703,10.6403191 L13.4343529,4.70000172 L13.5619581,7.64623485 C13.5687488,7.80302336 13.5226581,7.95633577 13.4329307,8.08241141 L13.3575976,8.17148997 L11.3201204,10.2090424 C11.1255942,10.4035758 10.8351564,10.4661295 10.5777959,10.3689223 C9.1099716,9.81451301 7.44730234,9.72992079 6.28856036,10.0674657 L6.06373804,10.140589 L6.0213556,10.1563478 L13.917617,18.0526093 L13.9340267,18.011087 C14.3079367,16.9772883 14.3038769,15.446777 13.8809465,14.0183469 L13.7907634,13.7341994 L13.7061027,13.4978109 C13.6211157,13.2727094 13.6583376,13.0223134 13.7991897,12.8329274 L13.8658454,12.7557489 L15.9037176,10.7165389 C16.0147335,10.60545 16.1589865,10.5357397 16.312665,10.5166735 L16.4293191,10.5120144 L19.3746703,10.6403191 Z"),s.current&&s.current(f)},[f]);var B=_.a();(0,v.useEffect)(function(){var e=em.p(function(){T.z.resizeWorkspace()},500);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[]),(0,v.useEffect)(function(){T.g.update(D)},[D]),(0,v.useEffect)(function(){T.g.updateGlobalWidget(c)},[c]),(0,v.useEffect)(function(){T.g.updateAnyWidget(B)},[B]),(0,v.useEffect)(function(){T.g.changeSelectWidgetCategoryStyle(n||(null==D?void 0:D.id))},[n,D]),(0,v.useEffect)(function(){function e(e){O(e),t(i.ji(e))}function n(){t(i.gh())}return T.z.eventBus.addEventListener(G.a.FLYOUT_CHANGE,e),T.z.eventBus.addEventListener(G.a.DELETE_BLOCK,n),function(){T.z.eventBus.removeEventListener(G.a.FLYOUT_CHANGE,e),T.z.eventBus.removeEventListener(G.a.DELETE_BLOCK,n)}},[t]);var R=(0,v.useRef)(null);return(0,v.useEffect)(function(){var e=R.current;if(e){var n=function(){setTimeout(function(){var e=new Event("mousedown",{bubbles:!0,cancelable:!0});document.body.dispatchEvent(e)},0),t(i.ki("blockly"))};return e.addEventListener("mousedown",n,!0),function(){return e.removeEventListener("mousedown",n,!0)}}},[R,t]),E().createElement("div",{className:N().wrapper},E().createElement("div",{className:u()(!A&&N().upper)}),E().createElement("div",{id:"coco_workspace",className:u()(N().blocklyWorkspace,C&&N().readonly),onWheel:function(){e.getState().block.dropdown.visible&&t(i.gh()),e.getState().block.slider.visible&&t(i.ih())},ref:R}),h.visible&&E().createElement(l.q,{value:h.value,onClose:h.setValue,onChange:h.selectValue,style:{position:"fixed",zIndex:100,top:h.top,left:h.left,boxShadow:"0 3px 6px -4px rgb(0 0 0 / 12%), 0 6px 16px 0 rgb(0 0 0 / 8%), 0 9px 28px 8px rgb(0 0 0 / 5%)"}}),E().createElement(eb,null),E().createElement(el,null),E().createElement(w,null),E().createElement(I.nT,null),E().createElement(j,null),E().createElement(z.a,null),E().createElement(F.a,null),E().createElement(J,null))})},76972(e,t,n){n.d(t,{KT:()=>I});var a=n(76043),r=n(72541),c=n(26564),o=n(46942),i=n.n(o),l=n(41594),s=n.n(l);n(68533);var u={className:"",percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,style:{},trailColor:"#D9D9D9",trailWidth:1},m=function(e){var t=e.map(function(){return(0,l.useRef)()}),n=(0,l.useRef)(null);return(0,l.useEffect)(function(){var e=Date.now(),a=!1;Object.keys(t).forEach(function(r){var c=t[r].current;if(c){a=!0;var o=c.style;o.transitionDuration=".3s, .3s, .3s, .06s",n.current&&e-n.current<100&&(o.transitionDuration="0s, 0s")}}),a&&(n.current=Date.now())}),[t]},d=function(e){var t=e.className,n=e.percent,o=e.prefixCls,s=e.strokeColor,u=e.strokeLinecap,d=e.strokeWidth,f=e.style,p=e.trailColor,v=e.trailWidth,E=e.transition,g=a.a(e,["className","percent","prefixCls","strokeColor","strokeLinecap","strokeWidth","style","trailColor","trailWidth","transition"]);delete g.gapPosition;var y=Array.isArray(n)?n:[n],b=Array.isArray(s)?s:[s],h=m(y),N=r.a(h,1)[0],k=d/2,C=100-d/2,w="M ".concat("round"===u?k:0,",").concat(k,"\n         L ").concat("round"===u?C:100,",").concat(k),I="0 0 100 ".concat(d),S=0;return(0,l.createElement)("svg",c.a({className:i()("".concat(o,"-line"),t),viewBox:I,preserveAspectRatio:"none",style:f},g),(0,l.createElement)("path",{className:"".concat(o,"-line-trail"),d:w,strokeLinecap:u,stroke:p,strokeWidth:v||d,fillOpacity:"0"}),y.map(function(e,t){var n=1;switch(u){case"round":n=1-d/100;break;case"square":n=1-d/2/100;break;default:n=1}var a={strokeDasharray:"".concat(e*n,"px, 100px"),strokeDashoffset:"-".concat(S,"px"),transition:E||"stroke-dashoffset 0.3s ease 0s, stroke-dasharray .3s ease 0s, stroke 0.3s linear"},r=b[t]||b[b.length-1];return S+=e,(0,l.createElement)("path",{key:t,className:"".concat(o,"-line-path"),d:w,strokeLinecap:u,stroke:r,strokeWidth:d,fillOpacity:"0",ref:N[t],style:a})}))};d.defaultProps=u,d.displayName="Line";var f=0;function p(e){return+e.replace("%","")}function v(e){return Array.isArray(e)?e:[e]}function E(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5?arguments[5]:void 0,o=50-a/2,i=0,l=-o,s=0,u=-2*o;switch(c){case"left":i=-o,l=0,s=2*o,u=0;break;case"right":i=o,l=0,s=-2*o,u=0;break;case"bottom":l=o,u=2*o}var m="M 50,50 m ".concat(i,",").concat(l,"\n   a ").concat(o,",").concat(o," 0 1 1 ").concat(s,",").concat(-u,"\n   a ").concat(o,",").concat(o," 0 1 1 ").concat(-s,",").concat(u),d=2*Math.PI*o;return{pathString:m,pathStyle:{stroke:"string"==typeof n?n:void 0,strokeDasharray:"".concat(t/100*(d-r),"px ").concat(d,"px"),strokeDashoffset:"-".concat(r/2+e/100*(d-r),"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s"}}}var g=function(e){var t,n=e.prefixCls,o=e.strokeWidth,s=e.trailWidth,u=e.gapDegree,d=e.gapPosition,g=e.trailColor,y=e.strokeLinecap,b=e.style,h=e.className,N=e.strokeColor,k=e.percent,C=a.a(e,["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"]),w=(0,l.useMemo)(function(){return f+=1},[]),I=E(0,100,g,o,u,d),S=I.pathString,x=I.pathStyle,L=v(k),_=v(N),T=_.find(function(e){return"[object Object]"===Object.prototype.toString.call(e)}),A=m(L),O=r.a(A,1)[0];return(0,l.createElement)("svg",c.a({className:i()("".concat(n,"-circle"),h),viewBox:"0 0 100 100",style:b},C),T&&(0,l.createElement)("defs",null,(0,l.createElement)("linearGradient",{id:"".concat(n,"-gradient-").concat(w),x1:"100%",y1:"0%",x2:"0%",y2:"0%"},Object.keys(T).sort(function(e,t){return p(e)-p(t)}).map(function(e,t){return(0,l.createElement)("stop",{key:t,offset:e,stopColor:T[e]})}))),(0,l.createElement)("path",{className:"".concat(n,"-circle-trail"),d:S,stroke:g,strokeLinecap:y,strokeWidth:s||o,fillOpacity:"0",style:x}),(t=0,L.map(function(e,a){var r=_[a]||_[_.length-1],c="[object Object]"===Object.prototype.toString.call(r)?"url(#".concat(n,"-gradient-").concat(w,")"):"",i=E(t,e,r,o,u,d);return t+=e,(0,l.createElement)("path",{key:a,className:"".concat(n,"-circle-path"),d:i.pathString,stroke:c,strokeLinecap:y,strokeWidth:o,opacity:+(0!==e),fillOpacity:"0",style:i.pathStyle,ref:O[a]})})).reverse())};g.defaultProps=u,g.displayName="Circle";var y=n(51877),b=n(33007),h=n(95644),N=n(451),k=n(19040),C=n(68950),w=n.n(C),I=(0,l.memo)(function(){var e=(0,k.useDispatch)(),t=(0,k.useSelector)(function(e){return e.project}),n=t.packageProgress,a=t.isPackaging,r=(0,l.useState)(!1),c=N.a(r,2),o=c[0],u=c[1],m=h.a().formatMessage,d=(0,l.useRef)(!1),f=function(){e(y.xf())},p=(0,l.useCallback)(function(){e(y.Vg()),100===n&&e(y.Hi(!1))},[]);return(0,l.useEffect)(function(){if(100===n){var e=setTimeout(function(){u(!0)},1e3);return function(){return clearTimeout(e)}}u(!1)},[n]),(0,l.useEffect)(function(){var t=s().createElement("div",{className:i()(w().completePackage),onClick:function(t){d.current||(e(y.Mi(!0)),t.stopPropagation())}},s().createElement(b.j,{type:"icon-apk"}),s().createElement("p",{className:w().close,onClick:function(t){e(y.zh({onConfirm:function(){e(y.Li(!1)),e(y.Gh("PACKAGE_APK_ICON"))},onClose:p,allowText:m({id:"package.cancel"}),title:"",isDangerous:!0,content:m({id:"package.deletePackage"})})),t.stopPropagation()}},s().createElement(b.j,{type:"icon-close"})));return o&&e(y.Qh("PACKAGE_APK_ICON",{name:"PACKAGE_APK_ICON",content:t,visible:!0})),function(){y.Gh("PACKAGE_APK_ICON")}},[e,m,p,o]),s().createElement(s().Fragment,null,s().createElement("div",null,!o&&a&&s().createElement("div",{className:w().packageProgress},s().createElement("div",{className:w().circle},s().createElement(g,{percent:n,strokeWidth:4,strokeColor:"#6E4FF4"}),s().createElement("p",{className:w().percentText},n,s().createElement("span",{className:w().symbol},"%")),s().createElement("p",{className:w().progressType},0===n&&m({id:"package.packagePendingText"}),m(100===n?{id:"package.packageComplete"}:{id:"package.isPackaging"}))),s().createElement("p",{className:w().close,onClick:function(){100!==n?e(y.zh({onConfirm:f,onClose:p,allowText:m({id:"package.cancel"}),title:"",isDangerous:!0,content:m({id:"package.cancelPackage"})})):(e(y.Ii(!0)),e(y.Li(!1)))}},s().createElement(b.j,{type:"icon-close"})))))})},56825(e,t,n){n.d(t,{QT:()=>b});var a=n(59435),r=n(38752),c=n(50862),o=n(33383),i=n(88963),l=n(33007),s=n(46942),u=n.n(s),m=n(95644),d=n(22827),f=n(451),p=n(19040),v=n(41594),E=n.n(v),g=n(11371),y=n.n(g),b=E().memo(function(){var e=m.a().formatMessage,t=(0,v.useState)(c.f),n=f.a(t,2),s=n[0],g=n[1],b=(0,p.useSelector)(function(e){return e.uiConfig.workspace})===i.j.ReadOnly,h=(0,p.useSelector)(function(e){return e.common.consoleHeight}),N=(0,v.useState)({undo:!0,redo:!0,zoomOut:!1,zoomIn:!1,cleanUp:!1}),k=f.a(N,2),C=k[0],w=k[1];(0,v.useEffect)(function(){function e(e){g(e),w({undo:C.undo,redo:C.redo,zoomIn:e>=c.d,zoomOut:e<=c.e,cleanUp:b})}function t(e){var t=e.canUndo,n=e.canRedo;w({zoomIn:C.zoomIn,zoomOut:C.zoomOut,undo:!t,redo:!n,cleanUp:b}),c.z.stopWarningAnimation()}return c.z.eventBus.addEventListener(a.a.WORKSPACE_SCALE_CHANGE,e),c.z.eventBus.addEventListener(a.a.COMMON_BLOCKS,t),function(){c.z.eventBus.removeEventListener(a.a.COMMON_BLOCKS,t),c.z.eventBus.removeEventListener(a.a.WORKSPACE_SCALE_CHANGE,e)}},[C.redo,C.undo,C.zoomIn,C.zoomOut,b]),(0,v.useEffect)(function(){w({undo:b,redo:b,cleanUp:b,zoomIn:C.zoomIn,zoomOut:C.zoomOut}),r.Z.context_menu.set_disabled(b)},[b,C.zoomIn,C.zoomOut]),(0,v.useEffect)(function(){var e=r.Z.mainWorkspace.clean_up;r.Z.mainWorkspace.clean_up=function(){e.call(this,r.q.fromValues(100,50))}},[]);var I=function(e){"undo"!==e||C.undo||r.Z.mainWorkspace.undo(),"redo"!==e||C.redo||r.Z.mainWorkspace.undo(!0)},S=[.5,.75,1,1.25,1.5,1.75,2],x=function(e){var t=Math.round(r.Z.mainWorkspace.get_scale()/c.f*100)/100,n="inc"===e?S.filter(function(e){return e>t}):S.filter(function(e){return e<t}),a=o.z(t,n);null!=a&&(a*=c.f,r.Z.mainWorkspace.set_scale(a))};return E().createElement("div",{className:y().wrapper,style:{bottom:h+18}},E().createElement("div",{className:y().undoRedoWrapper},E().createElement(d.a,{placement:"top",title:e({id:"BlockEditor.undo"}),trigger:["hover","click"]},E().createElement("span",{className:y().iconWrapper,onClick:function(){I("undo")}},E().createElement(l.j,{type:"icon-undo",className:u()(y().icon,y().undo,C.undo&&y().disable)}))),E().createElement(d.a,{placement:"top",title:e({id:"BlockEditor.redo"}),trigger:["hover","click"]},E().createElement("span",{className:y().iconWrapper,onClick:function(){C.redo||I("redo")}},E().createElement(l.j,{type:"icon-undo",className:u()(y().icon,y().redo,C.redo&&y().disable)})))),E().createElement("div",{className:y().zoomWrapper},E().createElement(d.a,{placement:"top",title:e({id:"BlockEditor.dec"}),trigger:["hover","click"]},E().createElement("span",{className:y().iconWrapper,onClick:function(){C.zoomOut||x("dec")}},E().createElement(l.j,{type:"icon-zoom-out",className:u()(y().icon,C.zoomOut&&y().disable)}))),E().createElement(d.a,{placement:"top",title:e({id:"BlockEditor.percent"}),trigger:["hover","click"]},E().createElement("span",{className:y().percent,onClick:function(){r.Z.mainWorkspace.get_scale()!==c.f&&r.Z.mainWorkspace.set_scale(c.f)}},"".concat(o.eb(s,c.f,0),"%"))),E().createElement(d.a,{placement:"top",title:e({id:"BlockEditor.inc"}),trigger:["hover","click"]},E().createElement("span",{className:y().iconWrapper,onClick:function(){C.zoomIn||x("inc")}},E().createElement(l.j,{type:"icon-zoom-in",className:u()(y().icon,C.zoomIn&&y().disable)})))),E().createElement("div",{className:y().cleanUpWrapper,onClick:function(){C.cleanUp||r.Z.mainWorkspace.clean_up(r.q.fromValues(100,50))}},E().createElement(d.a,{placement:"top",title:e({id:"BlockEditor.cleanup"}),trigger:["hover","click"]},E().createElement("span",{className:y().iconWrapper},E().createElement(l.j,{type:"icon-clean-up",className:u()(y().icon,C.cleanUp&&y().disable)})))))})},15028(e,t,n){n.d(t,{$T:()=>N,ES:()=>z,SS:()=>U,hS:()=>j});var a,r=n(92379),c=n(98936),o=n(72239),i=n(80538),l=n(61117),s=n(36454),u=n(72541),m=n(26564),d=n(33007),f=n(46942),p=n.n(f),v=n(95644),E=n(19040),g=n(41594),y=n.n(g),b=n(95327),h=n.n(b),N=y().memo(function(e){var t=e.onToggle,n=v.a().formatMessage,a=(0,E.useSelector)(function(e){return e.common.consoleMessages}),r=(0,E.useSelector)(function(e){return e.common.consoleHeight}),c=(0,g.useMemo)(function(){return{errorCount:a.filter(function(e){return"error"===e.get("type")||"lintError"===e.get("type")||"customError"===e.get("type")}).size,warningCount:a.filter(function(e){return"warning"===e.get("type")||"customWarning"===e.get("type")}).size}},[a]),o=c.errorCount,i=c.warningCount;return y().createElement("div",{onClick:t,className:p()(h().wrapper,(o>0||i>0)&&h().errorWarning),style:{bottom:r+18}},o>0||i>0?y().createElement(y().Fragment,null,y().createElement("div",{className:h().errorBox},y().createElement(d.j,{type:"icon-console-error"}),o),y().createElement("div",{className:h().warningBox},y().createElement(d.j,{type:"icon-warning"}),i)):y().createElement(y().Fragment,null,y().createElement(d.j,{type:"icon-console",className:h().iconConsole}),n({id:"consolePanel"})))}),k=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},C=(0,g.createContext)({siderHook:{addSider:function(){return null},removeSider:function(){return null}}});function w(e){var t=e.suffixCls,n=e.tagName,a=e.displayName;return function(e){var r=function(a){var r=(0,(0,g.useContext)(c.b).getPrefixCls)(t,a.prefixCls);return(0,g.createElement)(e,m.a({prefixCls:r,tagName:n},a))};return r.displayName=a,r}}var I=function(e){var t=e.prefixCls,n=e.className,a=e.children,r=e.tagName,c=k(e,["prefixCls","className","children","tagName"]),o=p()(t,n);return(0,g.createElement)(r,m.a({className:o},c),a)},S=w({suffixCls:"layout",tagName:"section",displayName:"Layout"})(function(e){var t,n=(0,g.useContext)(c.b).direction,a=(0,g.useState)([]),r=u.a(a,2),o=r[0],i=r[1],d=e.prefixCls,f=e.className,v=e.children,E=e.hasSider,y=e.tagName,b=k(e,["prefixCls","className","children","hasSider","tagName"]),h=p()(d,(t={},s.a(t,"".concat(d,"-has-sider"),"boolean"==typeof E?E:o.length>0),s.a(t,"".concat(d,"-rtl"),"rtl"===n),t),f),N=(0,g.useMemo)(function(){return{siderHook:{addSider:function(e){i(function(t){return[].concat(l.a(t),[e])})},removeSider:function(e){i(function(t){return t.filter(function(t){return t!==e})})}}}},[]);return(0,g.createElement)(C.Provider,{value:N},(0,g.createElement)(y,m.a({className:h},b),v))}),x=w({suffixCls:"layout-header",tagName:"header",displayName:"Header"})(I),L=w({suffixCls:"layout-footer",tagName:"footer",displayName:"Footer"})(I),_=w({suffixCls:"layout-content",tagName:"main",displayName:"Content"})(I),T={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"bars",theme:"outlined"},A=function(e,t){return(0,g.createElement)(r.a,o.a(o.a({},e),{},{ref:t,icon:T}))};A.displayName="BarsOutlined";var O=(0,g.forwardRef)(A),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},B=function(e,t){return(0,g.createElement)(r.a,o.a(o.a({},e),{},{ref:t,icon:D}))};B.displayName="RightOutlined";var j=(0,g.forwardRef)(B),R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},P=function(e,t){return(0,g.createElement)(r.a,o.a(o.a({},e),{},{ref:t,icon:R}))};P.displayName="LeftOutlined";var V=(0,g.forwardRef)(P),W=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},M={xs:"479.98px",sm:"575.98px",md:"767.98px",lg:"991.98px",xl:"1199.98px",xxl:"1599.98px"},z=(0,g.createContext)({}),G=(a=0,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a+=1,"".concat(e).concat(a)}),F=(0,g.forwardRef)(function(e,t){var n,a,r,o,l,d,f,v,E,y,b,h=e.prefixCls,N=e.className,k=e.trigger,w=e.children,I=e.defaultCollapsed,S=e.theme,x=e.style,L=e.collapsible,_=void 0!==L&&L,T=e.reverseArrow,A=void 0!==T&&T,D=e.width,B=e.collapsedWidth,R=void 0===B?80:B,P=e.zeroWidthTriggerStyle,F=e.breakpoint,U=e.onCollapse,H=e.onBreakpoint,Y=W(e,["prefixCls","className","trigger","children","defaultCollapsed","theme","style","collapsible","reverseArrow","width","collapsedWidth","zeroWidthTriggerStyle","breakpoint","onCollapse","onBreakpoint"]),J=(0,g.useContext)(C).siderHook,K=(0,g.useState)("collapsed"in Y?Y.collapsed:void 0!==I&&I),q=u.a(K,2),Z=q[0],X=q[1],Q=(0,g.useState)(!1),$=u.a(Q,2),ee=$[0],et=$[1];(0,g.useEffect)(function(){"collapsed"in Y&&X(Y.collapsed)},[Y.collapsed]);var en=function(e,t){"collapsed"in Y||X(e),null!=U&&U(e,t)},ea=(0,g.useRef)();ea.current=function(e){et(e.matches),null!=H&&H(e.matches),Z!==e.matches&&en(e.matches,"responsive")},(0,g.useEffect)(function(){function e(e){return ea.current(e)}if("undefined"!=typeof window){var t,n=window.matchMedia;if(n&&F&&F in M){t=n("(max-width: ".concat(M[F],")"));try{t.addEventListener("change",e)}catch(n){t.addListener(e)}e(t)}}return function(){try{null!=t&&t.removeEventListener("change",e)}catch(n){null!=t&&t.removeListener(e)}}},[]),(0,g.useEffect)(function(){var e=G("ant-sider-");return J.addSider(e),function(){return J.removeSider(e)}},[]);var er=function(){en(!Z,"clickTrigger")},ec=(0,g.useContext)(c.b).getPrefixCls,eo=(0,g.useMemo)(function(){return{siderCollapsed:Z}},[Z]);return(0,g.createElement)(z.Provider,{value:eo},(a=ec("layout-sider",h),r=i.a(Y,["collapsed"]),d=!isNaN(parseFloat(l=o=Z?R:void 0===D?200:D))&&isFinite(l)?"".concat(o,"px"):String(o),f=0===parseFloat(String(R||0))?(0,g.createElement)("span",{onClick:er,className:p()("".concat(a,"-zero-width-trigger"),"".concat(a,"-zero-width-trigger-").concat(A?"right":"left")),style:P},k||(0,g.createElement)(O,null)):null,v=({expanded:A?(0,g.createElement)(j,null):(0,g.createElement)(V,null),collapsed:A?(0,g.createElement)(V,null):(0,g.createElement)(j,null)})[Z?"collapsed":"expanded"],E=null!==k?f||(0,g.createElement)("div",{className:"".concat(a,"-trigger"),onClick:er,style:{width:d}},k||v):null,y=m.a(m.a({},void 0===x?{}:x),{flex:"0 0 ".concat(d),maxWidth:d,minWidth:d,width:d}),b=p()(a,"".concat(a,"-").concat(void 0===S?"dark":S),(n={},s.a(n,"".concat(a,"-collapsed"),!!Z),s.a(n,"".concat(a,"-has-trigger"),_&&null!==k&&!f),s.a(n,"".concat(a,"-below"),!!ee),s.a(n,"".concat(a,"-zero-width"),0===parseFloat(d)),n),N),(0,g.createElement)("aside",m.a({className:b},r,{style:y,ref:t}),(0,g.createElement)("div",{className:"".concat(a,"-children")},w),_||ee&&f?E:null)))});F.displayName="Sider",S.Header=x,S.Footer=L,S.Content=_,S.Sider=F;var U=S},61361(e,t,n){n.d(t,{DS:()=>S});var a=n(15028),r=n(28950),c=n(46942),o=n.n(c),i=n(451),l=n(41594),s=n.n(l),u=n(1418),m=n.n(u),d=function(e){return e>0?1:-1},f=function(e,t,n){return[t||0,e,n||e].sort(function(e,t){return e-t})[1]},p=(0,l.memo)(function(e){var t=e.children,n=e.resizable,c=e.placements,u=e.onResize,p=e.width&&f(e.width,e.minWidth,e.maxWidth),v=e.height&&f(e.height,e.minHeight,e.maxHeight),E=(0,l.useState)(p),g=i.a(E,2),y=g[0],b=g[1],h=(0,l.useState)(v),N=i.a(h,2),k=N[0],C=N[1],w=(0,l.useState)(!1),I=i.a(w,2),S=I[0],x=I[1],L=(0,l.useState)(),_=i.a(L,2),T=_[0],A=_[1],O=!!T,D=function(){A(void 0)},B=function(e){if(e.target instanceof HTMLElement&&e.target.parentElement){var t=e.clientX,n=e.clientY,a=e.target,r=a.offsetTop,c=a.offsetLeft,o=e.target.parentElement.getBoundingClientRect();return{clientX:t,clientY:n,offsetTop:r,offsetLeft:c,height:o.height,width:o.width}}},j=function(t,n){var a=d(n.offsetTop),r=t.clientY-n.clientY,c=f(n.height+a*r,e.minHeight,e.maxHeight);C(c),u&&u(c)},R=function(t,n){var a=d(n.offsetLeft),r=t.clientX-n.clientX,c=f(n.width+a*r,e.minWidth,e.maxWidth);b(c),u&&u(c)};return s().createElement(a.SS,{className:o()(e.className,m().layout,n?m().resizable:void 0,O?m().resizing:void 0),style:r.a(r.a({},e.style),{},{width:y,height:k})},t,n&&c&&c.length?s().createElement("div",{className:o()(m().resizer,S?m().row:m().col),onMouseDown:function(e){var t=B(e);t&&(x(0===t.offsetLeft),A(function(){return function(e){0===t.offsetLeft?j(e,t):R(e,t)}}))},onMouseMove:T,onMouseUp:D,onMouseLeave:D},c.map(function(e){return s().createElement("div",{key:e,className:m()[e.toLowerCase()]})})):null)}),v=n(50862),E=n(19042),g=n(52301),y=n(51877),b=n(33007),h=n(28413),N=n(95644),k=n(22827),C=n(19040),w=n(77045),I=n.n(w),S=(0,l.memo)(function(e){var t=e.consoleVisible,n=e.onClose,a=(0,C.useSelector)(function(e){return e.common.consoleMessages}),r=(0,l.useState)(["error","lintError","warning","print","log","customError","customWarning"]),c=i.a(r,2),u=c[0],m=c[1],d=(0,l.useState)(-1),f=i.a(d,2),w=f[0],S=f[1],x=(0,l.useRef)(null),L=(0,l.useRef)(.18*document.body.clientHeight),_=(0,C.useSelector)(function(e){return e.project.playing}),T=N.a().formatMessage,A=(0,C.useDispatch)(),O=(0,l.useMemo)(function(){return{errorCount:a.filter(function(e){return"error"===e.get("type")||"lintError"===e.get("type")||"customError"===e.get("type")}).size,warningCount:a.filter(function(e){return"warning"===e.get("type")||"customWarning"===e.get("type")}).size}},[a]),D=O.errorCount,B=O.warningCount;function j(e,t){var n=window.getSelection();if(!(null==n?void 0:n.toString().length)&&e.screenId&&e.blockId){S(t),A(y.ig(e.blockId,e.screenId));var a=e.type;("error"===a||"customError"===a||"warning"===a)&&P(!1,!1,e.type,e.message)}}function R(e){var t=u.indexOf(e);"error"===e?t>-1?(u.splice(t,1),u.splice(u.indexOf("lintError"),1),u.splice(u.indexOf("customError"),1)):u.push("error","lintError","customError"):"warning"===e?t>-1?(u.splice(t,1),u.splice(u.indexOf("customWarning"),1)):u.push("warning","customWarning"):t>-1?u.splice(t,1):u.push(e),m(h.a(u))}function P(e,t,n,a){E.a("EditConsole",{errorMessage:("error"===n||"customError"===n)&&a?a:"",warningMessage:"warning"===n&&a?a:"",isFilter:e,isClear:t})}return(0,l.useEffect)(function(){S(-1)},[_]),(0,l.useEffect)(function(){A(y.ei(t?L.current:0))},[A,t]),(0,l.useEffect)(function(){var e=x.current;e&&(e.scrollTop=e.scrollHeight)},[a]),s().createElement(p,{onResize:function(e){A(y.ei(e)),L.current=e},className:o()(I().container,!t&&I().hide),resizable:!0,placements:["top"],height:.18*document.body.clientHeight,minHeight:110,maxHeight:(document.body.clientHeight-52)/2},s().createElement("div",{className:I().header},s().createElement("div",{className:I().title},s().createElement("span",{className:I().errorCount},s().createElement(b.j,{type:"icon-console-error"}),D),s().createElement("span",null,s().createElement(b.j,{type:"icon-warning"}),B)),s().createElement("div",{className:I().right},s().createElement(g.a,{trigger:"click",placement:"bottom",overlayClassName:"consoleFilterPopover",content:s().createElement("div",{className:I().filterCategory},s().createElement("div",{className:I().filterItem,onClick:R.bind(null,"error")},s().createElement("div",{className:I().iconBox},u.includes("error")&&s().createElement(b.j,{type:"icon-selected"})),T({id:"show"}),T({id:"consoleError"})),s().createElement("div",{className:I().filterItem,onClick:R.bind(null,"warning")},s().createElement("div",{className:I().iconBox},u.includes("warning")&&s().createElement(b.j,{type:"icon-selected"})),T({id:"show"}),T({id:"consoleWarning"})),s().createElement("div",{className:I().filterItem,onClick:R.bind(null,"print")},s().createElement("div",{className:I().iconBox},u.includes("print")&&s().createElement(b.j,{type:"icon-selected"})),T({id:"show"}),T({id:"consolePrint"})),s().createElement("div",{className:I().filterItem,onClick:R.bind(null,"log")},s().createElement("div",{className:I().iconBox},u.includes("log")&&s().createElement(b.j,{type:"icon-selected"})),T({id:"show"}),T({id:"consoleLog"})))},s().createElement(k.a,{placement:"top",title:T({id:"consoleFilter"}),trigger:"hover"},s().createElement("span",{className:I().filterIcon,onClick:function(){P(!0,!1)}},s().createElement(b.j,{type:"icon-filter"})))),s().createElement(k.a,{placement:"top",title:T({id:"consolClear"}),trigger:"hover"},s().createElement("div",{className:I().clearIcon,onClick:function(){v.z.stopWarningAnimation(),A(y.Sg()),P(!1,!0)}},s().createElement(b.j,{type:"icon-clear"}))),s().createElement("div",{className:I().closeIcon,onClick:n},s().createElement(b.j,{type:"icon-close-bold"})))),s().createElement("div",{className:I().main,ref:x},s().createElement("ul",null,a.map(function(e,t){var n,a;return u.includes(e.get("type"))?s().createElement("li",{key:t,className:o()(w===t&&I().active),onClick:j.bind(null,e.toJSON(),t),"data-console-type":e.get("type")},s().createElement("p",null,(n=e.get("message"),("print"===(a=e.get("type"))||"customError"===a||"customWarning"===a?"<".concat(T({id:a}),">"):"")+n))):null}))))})},8789(e,t,n){n.d(t,{PS:()=>f});var a=n(33383),r=n(88963),c=n(51877),o=n(33007),i=n(22827),l=n(19040),s=n(41594),u=n.n(s),m=n(8144),d=n.n(m),f=(0,s.memo)(function(){var e=void 0!==a.N(window.location.href).archiveId,t=(0,l.useSelector)(function(e){return e.common.floatMiniIcons}),n=t.fixedIcons,m=t.temporaryIcons,f=(0,l.useDispatch)();if((0,s.useEffect)(function(){f(c.cf({name:"debugIcon",icon:"icon-data",tooltip:"数据面板",visible:!0,onClick:function(){f(c.Vi(r.h.DevTools))}})),f(c.cf({name:"resourceIcon",icon:"icon-box",tooltip:"项目资源",visible:!0,onClick:function(){f(c.Vi(r.h.ResourceLayout))}}))},[f]),e)return null;var p=function(e){if(e.visible){var t=u().createElement("div",null,e.icon?u().createElement(o.j,{type:e.icon}):"",e.withClose?u().createElement("div",{className:d().close,onClick:e.onClose},u().createElement(o.j,{type:"icon-close"})):""),n=e.content?e.content:t;return e.tooltip&&(n=u().createElement(i.a,{placement:"left",title:e.tooltip},n)),u().createElement("div",{className:d().floatIcon,onClick:e.onClick,key:e.name},n)}};return u().createElement("div",{className:d().floatPanel},u().createElement("div",{className:d().fixedBox},n.map(function(e){return p(e)})),u().createElement("div",{className:d().temporaryBox},m.map(function(e){return p(e)})))})},84576(e,t,n){n.d(t,{GS:()=>f,WS:()=>p});var a=n(13250),r=n(33007),c=n(46942),o=n.n(c),i=n(95644),l=n(22827),s=n(41594),u=n.n(s),m=n(77775),d=n.n(m),f=function(e,t){var n=u().createElement("div",{className:d().screenIcon},u().createElement(r.j,{className:"coco-iconfont-screen-bg",type:e>=9?"icon-screen-variable-plus":"icon-screen-variable"}),u().createElement("span",{className:o()(d().iconNumber,e>=9?d().iconFat:d().iconThin,e>0&&e<9?d().iconMiddle:"")},e+1)),a=u().createElement("div",{className:d().tips},null==t?void 0:t.title);return t?u().createElement(l.a,{placement:"bottom",trigger:["hover"],title:a},n):n},p=u().memo(function(){var e=i.a().formatMessage,t=(0,s.useRef)(null),n=u().useContext(a.nI).setBulkSelectVisible;return u().createElement("div",{className:o()(d().wrapper)},u().createElement("div",{className:o()(d().header)},u().createElement("div",{className:o()(d().addButton),ref:t},u().createElement("div",{className:o()(d().AddIcon),onClick:function(){n(!0)}},u().createElement("div",{className:d().icon},u().createElement(r.j,{type:"icon-add"})),u().createElement("div",{className:o()(d().addText)},e({id:"DataWatch.addData"}))))))})},26479(e,t,n){n.d(t,{JS:()=>j});var a=n(14816),r=n(84576),c=n(71691),o=n(73400),i=n(22224),l=n.n(i),s=n(94220),u=n(92136),m=n(52846),d=n(51877),f=n(33007),p=n(28413),v=n(46942),E=n.n(v),g=n(95644),y=n(22827),b=n(34221),h=n(7452),N=n.n(h),k=n(19040),C=n(41594),w=n.n(C),I=n(48861),S=n.n(I),x=n(43222),L=n(92380),_=n(64815),T=n.n(_),A=n(94021),O=n.n(A),D=function(e){var t,n=g.a().formatMessage,a=e.watchItem,i=(0,k.useSelector)(function(e){return e.project.playing}),l=(0,k.useSelector)(function(e){return e.project.screens}),p=l.findIndex(function(e){return e.id===a.screenId}),v=void 0;p>=0&&(v=l.get(p));var h=(L=b.a(N().mark(function e(){return N().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.type!==s.B&&a.type!==s.y||o.resetLocalStorage(a.id),a.type!==s.G){e.next=4;break}return e.next=4,o.resetTableDataIndexedDB(a.id);case 4:c.a(d.pj("".concat(a.name),!0));case 5:case"end":return e.stop()}},e)})),function(){return L.apply(this,arguments)});if(a.isFold)return null;var C=[],I=a[i?"value":"defaultValue"];if("LIST"===a.type)for(var S=0;S<I.length;S++)C.push({key:(S+1).toString(),value:m.e(I[S])});if("DICT"===a.type)for(var x in I)C.push({key:x,value:m.e(I[x],!1)});if(a.type===s.B||a.type===s.y){if(Array.isArray(a.value)){var L,_,T=u.a(a.value);try{for(T.s();!(_=T.n()).done;){var A=_.value;C.push({key:A.key,value:m.e(A.value)})}}catch(e){T.e(e)}finally{T.f()}}else if("object"==typeof a.value)for(var D in a.value)C.push({key:D,value:m.e(a.value[D])})}return a.type===s.G&&C.push({key:"cache",value:JSON.stringify(a.value)}),w().createElement("div",{className:O().container},(t=null,(a.type===s.B||a.type===s.y)&&(t=w().createElement(y.a,{placement:"bottom",trigger:["hover"],title:n({id:"resetData"})},w().createElement("div",{className:O().resetAction,onClick:h},w().createElement(f.j,{type:"icon-resetData"})))),w().createElement("div",{className:E()(O().flexSc,O().header)},w().createElement("div",{className:O().name},w().createElement("div",{className:O().screenIcon},v?(0,r.GS)(p,v):""),w().createElement("div",{className:O().title},a.name)),w().createElement("div",{className:O().action},i?"":t,w().createElement("div",{className:O().closeAction,onClick:function(){c.a(d.Pj(a.id,"isWatching",!1)),c.a(d.Pj(a.id,"selected",!1))}},w().createElement(f.j,{type:"icon-close-datawatch"})),w().createElement("div",{className:O().unFoldAction,onClick:function(){c.a(d.Pj(a.id,"isFold",!0))}},w().createElement(f.j,{type:"icon-open"}))))),w().createElement("div",{className:O().content},C.map(function(e){return w().createElement("div",{className:O().line,key:e.key},w().createElement("div",{className:O().lineKey},w().createElement(y.a,{placement:"bottom",trigger:["hover"],title:e.key},w().createElement("div",{className:O().lineKeyText},e.key))),w().createElement("div",{className:O().lineValue},w().createElement(y.a,{placement:"bottom",trigger:["hover"],title:e.value},w().createElement("div",{className:O().text},m.e(e.value)))))})))},B=function(e){var t,n=e.watchItem,a=(0,k.useDispatch)(),c=g.a().formatMessage,i=(0,k.useSelector)(function(e){return e.project.screens}),p=(0,k.useSelector)(function(e){return e.project.playing}),v=i.findIndex(function(e){return e.id===n.screenId}),E=void 0;v>=0&&(E=i.get(v));var h=x.b(n.type),I=h.foldIcon&&n.isFold,S=function(){n.type!==s.G?a(d.Pj(n.id,"isFold",!1)):a(d.aj(!0,n.id))},_=function(){a(d.Pj(n.id,"isWatching",!1)),a(d.Pj(n.id,"selected",!1))};(0,C.useEffect)(function(){n.type===s.G&&L.a.get(n.id).then(function(e){e&&a(d.Pj(n.id,"value",e))})},[a,n.id,n.type]);var A=(t=b.a(N().mark(function e(){return N().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.type!==s.B&&n.type!==s.y||o.resetLocalStorage(n.id),n.type!==s.G){e.next=4;break}return e.next=4,o.resetTableDataIndexedDB(n.id);case 4:a(d.pj("".concat(n.name),!0));case 5:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),O=null;(n.type===s.B||n.type===s.y)&&(O=w().createElement(y.a,{placement:"bottom",trigger:["hover"],title:c({id:"resetData"})},w().createElement("div",{className:T().resetAction,onClick:A},w().createElement(f.j,{type:"icon-resetData"}))));var B=function(){var e=function(e,t){var n=t?"value":"defaultValue";(e.type===s.B||e.type===s.G||e.type===s.y)&&(n="value");var a=l().cloneDeep(e[n]),r=[];if("TABLE_DATA_WIDGET"===e.type)for(var c in a.header)r.push(a.header[c].field);var o={},i="",d=new Set,f=function(e,t){if("object"==typeof t&&null!==t){if(d.has(t))try{return JSON.parse(JSON.stringify(t))}catch(e){return Array.isArray(t)?"[...]":"{...}"}d.add(t)}return t};switch(e.type){case"PRIMITIVE":case"LIST":case"DICT":i=JSON.stringify(a,f).replaceAll('"[...]"',"[...]").replaceAll('"{...}"',"{...}");break;case s.B:case s.y:if(Array.isArray(a)){var p,v=u.a(a);try{for(v.s();!(p=v.n()).done;){var E=p.value;o[E.key]=m.e(E.value)}}catch(e){v.e(e)}finally{v.f()}}else"object"==typeof a&&(o=a);i=JSON.stringify(o,f);break;case s.G:i="Column names: "+r.join(",")}return i}(n,p);return w().createElement("div",{className:T().itemBox},w().createElement("div",{className:T().name},w().createElement("div",{className:T().screenIcon},E?(0,r.GS)(v,E):""),w().createElement(y.a,{placement:"bottom",trigger:["hover"],title:n.name},w().createElement("div",{className:T().nameText},n.name))),w().createElement("div",{className:T().value},w().createElement("div",{className:T().valueText},w().createElement(y.a,{placement:"bottom",trigger:["hover"],title:e},e))),w().createElement("div",{className:T().action},p?"":O,w().createElement("div",{className:T().closeAction,onClick:_},w().createElement(f.j,{type:"icon-close-datawatch"})),I?w().createElement("div",{className:T().foldAction,onClick:S},w().createElement(f.j,{type:h.foldIcon})):""))};return w().createElement("div",{className:T().container},n.isFold?B():"",n.type!==s.G||n.isFold?"":B(),w().createElement(D,{watchItem:n}))},j=function(){var e,t=g.a().formatMessage,n=(0,k.useSelector)(function(e){return e.dataWatch.variableList}),r={PRIMITIVE:(e=n.filter(function(e){return e.isWatching})).filter(function(e){return"PRIMITIVE"===e.type}),LIST:e.filter(function(e){return"LIST"===e.type}),DICT:e.filter(function(e){return"DICT"===e.type}),TABLE_DATA_WIDGET:e.filter(function(e){return"TABLE_DATA_WIDGET"===e.type}),LOCAL_STORAGE:e.filter(function(e){return e.type===s.y||e.type===s.B})},c=r.PRIMITIVE,o=r.LIST,i=r.DICT,l=r.TABLE_DATA_WIDGET,u=r.LOCAL_STORAGE,m=function(e,n){if(0===n.size)return"";var a=n.filter(function(e){return"GLOBAL"===e.screenId}),r=n.filter(function(e){return"GLOBAL"!==e.screenId}),c=[].concat(p.a(a),p.a(r)),o=x.b(e);return w().createElement("div",{className:S().watchBox},w().createElement("div",{className:S().category},w().createElement("div",{className:S().categoryIcon,style:{color:o.color,fontSize:o.fontSize}},w().createElement(f.j,{type:o.class})),w().createElement("div",{className:S().categoryText},t({id:o.text}))),c.map(function(e){return w().createElement(B,{watchItem:e,key:e.id})}))};return 0===n.size?w().createElement("div",{className:E()(S().noData),style:{visibility:"hidden"}},w().createElement(a.we,null),w().createElement("span",{className:S().emptyText},t({id:"DataWatch.unable"}))):0===n.filter(function(e){return e.isWatching}).size?w().createElement("div",{className:E()(S().noData),style:{visibility:"hidden"}},w().createElement(a.we,null),w().createElement("span",{className:S().emptyText},t({id:"DataWatch.empty"}))):w().createElement("div",{className:E()(S().list)},m("PRIMITIVE",c),m("LIST",o),m("DICT",i),m("LOCAL_STORAGE_WIDGET",u),m("TABLE_DATA_WIDGET",l))}}}]);
//# sourceMappingURL=editor~5.0cdd85527598e258.js.map